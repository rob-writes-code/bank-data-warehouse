[0m14:31:12.211470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a27290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3da50>]}


============================== 14:31:12.213869 | 405dd172-e361-42c1-a06d-e31973a8e835 ==============================
[0m14:31:12.213869 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:31:12.214212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:31:12.214611 [info ] [MainThread]: dbt version: 1.5.3
[0m14:31:12.214829 [info ] [MainThread]: python version: 3.11.3
[0m14:31:12.215067 [info ] [MainThread]: python path: /Users/robertphillips/Documents/data-warehousing/data-whse-venv/bin/python3.11
[0m14:31:12.215278 [info ] [MainThread]: os info: macOS-13.4.1-arm64-arm-64bit
[0m14:31:12.215457 [info ] [MainThread]: Using profiles.yml file at /Users/robertphillips/Documents/data-warehousing/bank_warehouse/profiles.yml
[0m14:31:12.215640 [info ] [MainThread]: Using dbt_project.yml file at /Users/robertphillips/Documents/data-warehousing/bank_warehouse/dbt_project.yml
[0m14:31:12.215817 [info ] [MainThread]: Configuration:
[0m14:31:12.246798 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:31:12.247154 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:31:12.247468 [info ] [MainThread]: Required dependencies:
[0m14:31:12.247731 [debug] [MainThread]: Executing "git --help"
[0m14:31:12.253372 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:31:12.253850 [debug] [MainThread]: STDERR: "b''"
[0m14:31:12.253988 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:31:12.254156 [info ] [MainThread]: Connection:
[0m14:31:12.254347 [info ] [MainThread]:   host: localhost
[0m14:31:12.254491 [info ] [MainThread]:   port: 5433
[0m14:31:12.254626 [info ] [MainThread]:   user: postgres
[0m14:31:12.254757 [info ] [MainThread]:   database: mydb
[0m14:31:12.254887 [info ] [MainThread]:   schema: bank_warehouse
[0m14:31:12.255016 [info ] [MainThread]:   search_path: None
[0m14:31:12.255143 [info ] [MainThread]:   keepalives_idle: 0
[0m14:31:12.255271 [info ] [MainThread]:   sslmode: None
[0m14:31:12.255740 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:31:12.259689 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:31:12.260196 [debug] [MainThread]: Using postgres connection "debug"
[0m14:31:12.260347 [debug] [MainThread]: On debug: select 1 as id
[0m14:31:12.260487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:12.329790 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:31:12.330635 [debug] [MainThread]: On debug: Close
[0m14:31:12.330826 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:31:12.331025 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:31:12.331189 [info ] [MainThread]: Could not load dbt_project.yml

[0m14:31:12.331537 [debug] [MainThread]: Command `dbt debug` failed at 14:31:12.331476 after 0.13 seconds
[0m14:31:12.331727 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:31:12.331903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ad7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ad7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c8690>]}
[0m14:31:12.332144 [debug] [MainThread]: Flushing usage events
[0m14:32:04.692185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efe0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efe910>]}


============================== 14:32:04.694578 | 3753119c-aca1-4474-af62-f0e733a6da7c ==============================
[0m14:32:04.694578 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:04.694937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:04.695266 [info ] [MainThread]: dbt version: 1.5.3
[0m14:32:04.695497 [info ] [MainThread]: python version: 3.11.3
[0m14:32:04.695798 [info ] [MainThread]: python path: /Users/robertphillips/Documents/data-warehousing/data-whse-venv/bin/python3.11
[0m14:32:04.696031 [info ] [MainThread]: os info: macOS-13.4.1-arm64-arm-64bit
[0m14:32:04.696227 [info ] [MainThread]: Using profiles.yml file at /Users/robertphillips/Documents/data-warehousing/bank_warehouse/profiles.yml
[0m14:32:04.696408 [info ] [MainThread]: Using dbt_project.yml file at /Users/robertphillips/Documents/data-warehousing/bank_warehouse/dbt_project.yml
[0m14:32:04.696576 [info ] [MainThread]: Configuration:
[0m14:32:04.727820 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:32:04.736583 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:32:04.736853 [info ] [MainThread]: Required dependencies:
[0m14:32:04.737063 [debug] [MainThread]: Executing "git --help"
[0m14:32:04.744509 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:32:04.745033 [debug] [MainThread]: STDERR: "b''"
[0m14:32:04.745181 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:32:04.745353 [info ] [MainThread]: Connection:
[0m14:32:04.745637 [info ] [MainThread]:   host: localhost
[0m14:32:04.745813 [info ] [MainThread]:   port: 5433
[0m14:32:04.745965 [info ] [MainThread]:   user: postgres
[0m14:32:04.746102 [info ] [MainThread]:   database: mydb
[0m14:32:04.746273 [info ] [MainThread]:   schema: bank_warehouse
[0m14:32:04.746454 [info ] [MainThread]:   search_path: None
[0m14:32:04.746600 [info ] [MainThread]:   keepalives_idle: 0
[0m14:32:04.746753 [info ] [MainThread]:   sslmode: None
[0m14:32:04.747368 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:32:04.752753 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:32:04.753280 [debug] [MainThread]: Using postgres connection "debug"
[0m14:32:04.753429 [debug] [MainThread]: On debug: select 1 as id
[0m14:32:04.753550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:04.807018 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:32:04.807793 [debug] [MainThread]: On debug: Close
[0m14:32:04.807973 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:32:04.808146 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:32:04.808511 [debug] [MainThread]: Command `dbt debug` succeeded at 14:32:04.808447 after 0.13 seconds
[0m14:32:04.808673 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:32:04.808840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025ae250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f824d0>]}
[0m14:32:04.809056 [debug] [MainThread]: Flushing usage events
[0m14:32:26.075698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841f090>]}


============================== 14:32:26.078168 | 2f59672b-56d3-4d8b-beee-598e0a3f0cd5 ==============================
[0m14:32:26.078168 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:26.078485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:26.116854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841f590>]}
[0m14:32:26.123309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b4590>]}
[0m14:32:26.123705 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:32:26.138998 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:32:26.139735 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:32:26.140015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841ed90>]}
[0m14:32:26.397344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab74d0>]}
[0m14:32:26.399995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adfa90>]}
[0m14:32:26.400208 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:32:26.400389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f59672b-56d3-4d8b-beee-598e0a3f0cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c59d0>]}
[0m14:32:26.400942 [info ] [MainThread]: 
[0m14:32:26.401151 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:32:26.401397 [debug] [MainThread]: Command end result
[0m14:32:26.403984 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:26.403902 after 0.34 seconds
[0m14:32:26.404257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b88d50>]}
[0m14:32:26.404499 [debug] [MainThread]: Flushing usage events
[0m15:05:32.244012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105331bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105337390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105337b90>]}


============================== 15:05:32.246463 | 9df87eec-a549-488b-b3e7-15e87005ead7 ==============================
[0m15:05:32.246463 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:32.246787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'version_check': 'True', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:32.285897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531a390>]}
[0m15:05:32.292412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105337790>]}
[0m15:05:32.292821 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:05:32.312716 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:32.329319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m15:05:32.329639 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/facts/accounts.sql
[0m15:05:32.329823 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/sources/sources.yml
[0m15:05:32.329964 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/dimensions/customers.sql
[0m15:05:32.341292 [debug] [MainThread]: 1699: static parser successfully parsed facts/accounts.sql
[0m15:05:32.348626 [debug] [MainThread]: 1699: static parser successfully parsed dimensions/customers.sql
[0m15:05:32.381662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105326410>]}
[0m15:05:32.384407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16150>]}
[0m15:05:32.384609 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:05:32.384792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f859d0>]}
[0m15:05:32.385496 [info ] [MainThread]: 
[0m15:05:32.385873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:32.386414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:05:32.391768 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:05:32.392048 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:05:32.392187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:32.454224 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:05:32.455131 [debug] [ThreadPool]: On list_mydb: Close
[0m15:05:32.455805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now create_mydb_bank_warehouse)
[0m15:05:32.456218 [debug] [ThreadPool]: Creating schema "database: "mydb"
schema: "bank_warehouse"
"
[0m15:05:32.459394 [debug] [ThreadPool]: Using postgres connection "create_mydb_bank_warehouse"
[0m15:05:32.459578 [debug] [ThreadPool]: On create_mydb_bank_warehouse: BEGIN
[0m15:05:32.459730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:32.470266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.470549 [debug] [ThreadPool]: Using postgres connection "create_mydb_bank_warehouse"
[0m15:05:32.470731 [debug] [ThreadPool]: On create_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "create_mydb_bank_warehouse"} */
create schema if not exists "bank_warehouse"
[0m15:05:32.473520 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m15:05:32.474133 [debug] [ThreadPool]: On create_mydb_bank_warehouse: COMMIT
[0m15:05:32.474304 [debug] [ThreadPool]: Using postgres connection "create_mydb_bank_warehouse"
[0m15:05:32.474447 [debug] [ThreadPool]: On create_mydb_bank_warehouse: COMMIT
[0m15:05:32.475302 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m15:05:32.475459 [debug] [ThreadPool]: On create_mydb_bank_warehouse: Close
[0m15:05:32.476466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydb_bank_warehouse, now list_mydb_bank_warehouse)
[0m15:05:32.479864 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:05:32.480050 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:05:32.480194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:32.488465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.488720 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:05:32.488906 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:05:32.499535 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:32.500272 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:05:32.500933 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:05:32.503651 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.503857 [debug] [MainThread]: On master: BEGIN
[0m15:05:32.504006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:32.512398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.512636 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.512875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:32.534622 [debug] [MainThread]: SQL status: SELECT 22 in 0.0 seconds
[0m15:05:32.536316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c47710>]}
[0m15:05:32.536631 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:32.537358 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.537586 [debug] [MainThread]: On master: BEGIN
[0m15:05:32.538921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.539134 [debug] [MainThread]: On master: COMMIT
[0m15:05:32.539316 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.539481 [debug] [MainThread]: On master: COMMIT
[0m15:05:32.540137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:32.540400 [debug] [MainThread]: On master: Close
[0m15:05:32.540885 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:32.541158 [info ] [MainThread]: 
[0m15:05:32.544673 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:05:32.544980 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:05:32.545342 [info ] [Thread-1 (]: 1 of 2 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:05:32.545769 [info ] [Thread-2 (]: 2 of 2 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:05:32.546380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:05:32.546860 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:05:32.547134 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:05:32.547370 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:05:32.549551 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:05:32.551384 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:05:32.552120 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:05:32.549745 => 15:05:32.551997
[0m15:05:32.552361 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:05:32.547543 => 15:05:32.552246
[0m15:05:32.552564 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:05:32.552756 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:05:32.575763 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:05:32.578012 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:05:32.578677 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:05:32.578853 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:05:32.579003 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:05:32.579143 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:05:32.579277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:32.579408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:32.588483 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.588745 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:05:32.588917 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:05:32.590216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.590529 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:05:32.590735 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned
FROM mydb.public.raw_banking
  );
  
[0m15:05:32.608699 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:05:32.612769 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:05:32.612988 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:05:32.613216 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:05:32.614776 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:05:32.615027 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:05:32.615788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:32.622280 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:32.625864 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:05:32.626866 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:05:32.627068 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:05:32.627308 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:05:32.627485 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:05:32.627709 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:05:32.635630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:32.638627 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:05:32.638810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:32.639010 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:05:32.640289 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:05:32.640515 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:05:32.641051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:32.641212 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:05:32.641975 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:05:32.575966 => 15:05:32.641880
[0m15:05:32.642624 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:05:32.552890 => 15:05:32.642542
[0m15:05:32.642803 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:05:32.642982 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:05:32.643387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb6090>]}
[0m15:05:32.643697 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df87eec-a549-488b-b3e7-15e87005ead7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baa0d0>]}
[0m15:05:32.644023 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.10s]
[0m15:05:32.644324 [info ] [Thread-2 (]: 2 of 2 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.10s]
[0m15:05:32.644752 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:05:32.645000 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:05:32.646070 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.646218 [debug] [MainThread]: On master: BEGIN
[0m15:05:32.646336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:32.654729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:32.654938 [debug] [MainThread]: On master: COMMIT
[0m15:05:32.655082 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:32.655211 [debug] [MainThread]: On master: COMMIT
[0m15:05:32.655745 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:32.655902 [debug] [MainThread]: On master: Close
[0m15:05:32.656238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:32.656367 [debug] [MainThread]: Connection 'model.maker_warehouse.accounts' was properly closed.
[0m15:05:32.656483 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m15:05:32.656638 [info ] [MainThread]: 
[0m15:05:32.656828 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m15:05:32.657287 [debug] [MainThread]: Command end result
[0m15:05:32.660566 [info ] [MainThread]: 
[0m15:05:32.660858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:32.661041 [info ] [MainThread]: 
[0m15:05:32.661245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:05:32.661584 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:32.661530 after 0.43 seconds
[0m15:05:32.661782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009f1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100892250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ed990>]}
[0m15:05:32.661958 [debug] [MainThread]: Flushing usage events
[0m15:06:48.448382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849ff90>]}


============================== 15:06:48.450918 | 548bfa11-9216-4d21-b21f-b96a76bf0a8f ==============================
[0m15:06:48.450918 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:06:48.451290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:06:48.489626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4fd0>]}
[0m15:06:48.496113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ab950>]}
[0m15:06:48.496520 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:06:48.507405 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:06:48.525063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:48.525453 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/facts/accounts.sql
[0m15:06:48.536587 [debug] [MainThread]: 1699: static parser successfully parsed facts/accounts.sql
[0m15:06:48.547837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b09610>]}
[0m15:06:48.572749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c06d10>]}
[0m15:06:48.573010 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:06:48.573195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249c50>]}
[0m15:06:48.573980 [info ] [MainThread]: 
[0m15:06:48.574395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:48.574907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:06:48.579462 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:06:48.579621 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:06:48.579742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:48.646073 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:06:48.646997 [debug] [ThreadPool]: On list_mydb: Close
[0m15:06:48.647910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:06:48.651186 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:06:48.651358 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:06:48.651498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:48.667923 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.668095 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:06:48.668259 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:06:48.676876 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:06:48.677721 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:06:48.678532 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:06:48.681526 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.681732 [debug] [MainThread]: On master: BEGIN
[0m15:06:48.681880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:48.695810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.696175 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.696444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:48.717942 [debug] [MainThread]: SQL status: SELECT 22 in 0.0 seconds
[0m15:06:48.719487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d794d0>]}
[0m15:06:48.719823 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:48.720813 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.721058 [debug] [MainThread]: On master: BEGIN
[0m15:06:48.722614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.722820 [debug] [MainThread]: On master: COMMIT
[0m15:06:48.723004 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.723173 [debug] [MainThread]: On master: COMMIT
[0m15:06:48.724006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:48.724198 [debug] [MainThread]: On master: Close
[0m15:06:48.724672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:48.724931 [info ] [MainThread]: 
[0m15:06:48.728338 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:06:48.728631 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:06:48.728966 [info ] [Thread-1 (]: 1 of 2 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:06:48.729333 [info ] [Thread-2 (]: 2 of 2 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:06:48.729840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:06:48.730269 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:06:48.730532 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:06:48.730766 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:06:48.733201 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:06:48.734967 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:06:48.735704 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:06:48.733403 => 15:06:48.735564
[0m15:06:48.735961 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:06:48.730915 => 15:06:48.735842
[0m15:06:48.736178 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:06:48.736379 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:06:48.758434 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:06:48.760711 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:06:48.761193 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.761376 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.761555 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:06:48.761713 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:06:48.761861 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:06:48.762004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:48.771240 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.771588 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.771785 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:06:48.773200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.773501 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.773726 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:06:48.791994 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:06:48.796742 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.796974 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:06:48.797221 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:06:48.798724 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.798993 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:06:48.800063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:48.800268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:48.801957 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.803518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.803712 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:06:48.803899 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:06:48.804782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:48.804940 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:48.815679 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:06:48.816801 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:06:48.816979 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.817135 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.817283 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:06:48.817426 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:06:48.826272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:06:48.826473 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:06:48.829457 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:06:48.830758 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:06:48.830944 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:06:48.831136 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:06:48.835498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:48.836360 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:06:48.758607 => 15:06:48.836260
[0m15:06:48.836533 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:48.836753 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:06:48.837436 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:06:48.736514 => 15:06:48.837350
[0m15:06:48.837853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855d250>]}
[0m15:06:48.838030 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:06:48.838354 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m15:06:48.838859 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:06:48.839387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548bfa11-9216-4d21-b21f-b96a76bf0a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c05f90>]}
[0m15:06:48.839860 [info ] [Thread-2 (]: 2 of 2 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m15:06:48.840240 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:06:48.841433 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.841633 [debug] [MainThread]: On master: BEGIN
[0m15:06:48.841770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:48.850807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:48.851079 [debug] [MainThread]: On master: COMMIT
[0m15:06:48.851230 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:48.851363 [debug] [MainThread]: On master: COMMIT
[0m15:06:48.851908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:48.852056 [debug] [MainThread]: On master: Close
[0m15:06:48.852399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:48.852524 [debug] [MainThread]: Connection 'model.maker_warehouse.accounts' was properly closed.
[0m15:06:48.852638 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m15:06:48.852803 [info ] [MainThread]: 
[0m15:06:48.852995 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:06:48.853452 [debug] [MainThread]: Command end result
[0m15:06:48.856631 [info ] [MainThread]: 
[0m15:06:48.856926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:48.857183 [info ] [MainThread]: 
[0m15:06:48.857388 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:06:48.857877 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:48.857811 after 0.42 seconds
[0m15:06:48.858138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b56250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb5250>]}
[0m15:06:48.858346 [debug] [MainThread]: Flushing usage events
[0m15:39:56.597136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f07950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1aed0>]}


============================== 15:39:56.599611 | b967e153-8f47-4f91-9496-55ed98ddbbbd ==============================
[0m15:39:56.599611 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:39:56.599980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:56.638422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f27110>]}
[0m15:39:56.644910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f27290>]}
[0m15:39:56.645279 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:39:56.656645 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:39:56.674386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:39:56.674690 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/total_balance.sql
[0m15:39:56.685940 [debug] [MainThread]: 1699: static parser successfully parsed summaries/total_balance.sql
[0m15:39:56.697238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f38410>]}
[0m15:39:56.723589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104586590>]}
[0m15:39:56.723873 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:39:56.724073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cc1c50>]}
[0m15:39:56.724864 [info ] [MainThread]: 
[0m15:39:56.725260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:56.725779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:39:56.730537 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:39:56.730699 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:39:56.730825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:56.784494 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:39:56.785423 [debug] [ThreadPool]: On list_mydb: Close
[0m15:39:56.786333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:39:56.789570 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:39:56.789737 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:39:56.789872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:56.805020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.805212 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:39:56.805374 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:39:56.815111 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:39:56.816013 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:39:56.816805 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:39:56.819810 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:56.820026 [debug] [MainThread]: On master: BEGIN
[0m15:39:56.820175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:56.828914 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.829134 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:56.829371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:56.848795 [debug] [MainThread]: SQL status: SELECT 22 in 0.0 seconds
[0m15:39:56.850047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103599450>]}
[0m15:39:56.850324 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:56.851118 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:56.851330 [debug] [MainThread]: On master: BEGIN
[0m15:39:56.852798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.852982 [debug] [MainThread]: On master: COMMIT
[0m15:39:56.853135 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:56.853278 [debug] [MainThread]: On master: COMMIT
[0m15:39:56.853859 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:39:56.854051 [debug] [MainThread]: On master: Close
[0m15:39:56.854467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:56.854702 [info ] [MainThread]: 
[0m15:39:56.858202 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:39:56.858466 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:39:56.858802 [info ] [Thread-1 (]: 1 of 3 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:39:56.859144 [info ] [Thread-2 (]: 2 of 3 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:39:56.859967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:39:56.860481 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:39:56.860739 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:39:56.860951 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:39:56.863179 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:39:56.864805 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:39:56.865480 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:39:56.861104 => 15:39:56.865364
[0m15:39:56.865724 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:39:56.863376 => 15:39:56.865598
[0m15:39:56.865953 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:39:56.866143 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:39:56.887914 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:39:56.890065 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:39:56.890460 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.890613 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:39:56.890779 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.890929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:56.891082 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:39:56.891288 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:39:56.901061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.901392 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.901581 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.901786 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.901989 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:39:56.902196 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:39:56.922599 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:39:56.927275 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.927502 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:39:56.927746 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:39:56.929258 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.929498 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:39:56.930443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:39:56.930611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:39:56.932197 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.933658 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.933849 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:39:56.934034 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:39:56.934901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:39:56.935062 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:39:56.945779 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:39:56.946860 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:39:56.947040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.947195 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.947340 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:39:56.947481 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:39:56.954677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:39:56.954888 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:39:56.957815 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:39:56.959080 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:39:56.959276 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:39:56.959469 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:39:56.965929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:39:56.966829 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:39:56.866273 => 15:39:56.966734
[0m15:39:56.966994 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:39:56.967188 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:39:56.967892 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:39:56.888083 => 15:39:56.967802
[0m15:39:56.968314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104587410>]}
[0m15:39:56.968499 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:39:56.968849 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m15:39:56.969264 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:39:56.969777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103550710>]}
[0m15:39:56.970306 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_balance
[0m15:39:56.970639 [info ] [Thread-2 (]: 2 of 3 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m15:39:56.970980 [info ] [Thread-4 (]: 3 of 3 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:39:56.971334 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:39:56.971748 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m15:39:56.972015 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:39:56.973517 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:39:56.974157 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:39:56.972131 => 15:39:56.974057
[0m15:39:56.974329 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_balance
[0m15:39:56.984585 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:39:56.985145 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:39:56.985332 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:39:56.985474 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:39:56.993779 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:39:56.994053 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:39:56.994254 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:39:56.998129 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:39:56.999959 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:39:57.000202 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:39:57.001313 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:39:57.002416 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:39:57.002602 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:39:57.002766 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:39:57.004112 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:39:57.005296 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:39:57.005476 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:39:57.006106 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:39:57.006796 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:39:56.974428 => 15:39:57.006703
[0m15:39:57.006972 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: Close
[0m15:39:57.007345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b967e153-8f47-4f91-9496-55ed98ddbbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa3fd0>]}
[0m15:39:57.007628 [info ] [Thread-4 (]: 3 of 3 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.04s]
[0m15:39:57.007962 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_balance
[0m15:39:57.008803 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:57.008977 [debug] [MainThread]: On master: BEGIN
[0m15:39:57.009106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:57.018224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:39:57.018499 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.018702 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:57.018868 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.019521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:39:57.019675 [debug] [MainThread]: On master: Close
[0m15:39:57.020071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:57.020199 [debug] [MainThread]: Connection 'model.maker_warehouse.accounts' was properly closed.
[0m15:39:57.020308 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m15:39:57.020410 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:39:57.020558 [info ] [MainThread]: 
[0m15:39:57.020739 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:39:57.021181 [debug] [MainThread]: Command end result
[0m15:39:57.024213 [info ] [MainThread]: 
[0m15:39:57.024430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:57.024598 [info ] [MainThread]: 
[0m15:39:57.024812 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:39:57.025209 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:57.025155 after 0.44 seconds
[0m15:39:57.025397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f07f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f27810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005ce250>]}
[0m15:39:57.025578 [debug] [MainThread]: Flushing usage events
[0m15:45:52.532079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9fd10>]}


============================== 15:45:52.534561 | 0fb643c8-791e-47d1-8d95-9f1547b286f5 ==============================
[0m15:45:52.534561 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:45:52.534918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:52.573576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9f8d0>]}
[0m15:45:52.580095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460dcd0>]}
[0m15:45:52.580475 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:45:52.590546 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:45:52.608839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:45:52.609247 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/total_salaries.sql
[0m15:45:52.624655 [debug] [MainThread]: 1699: static parser successfully parsed summaries/total_salaries.sql
[0m15:45:52.656149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842bd10>]}
[0m15:45:52.659259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329f90>]}
[0m15:45:52.659486 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:45:52.659677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a49a10>]}
[0m15:45:52.660485 [info ] [MainThread]: 
[0m15:45:52.660891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:52.661482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:45:52.666840 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:45:52.667071 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:45:52.667201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:52.721561 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:45:52.722497 [debug] [ThreadPool]: On list_mydb: Close
[0m15:45:52.723426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:45:52.726540 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:45:52.726709 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:45:52.726844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:52.741602 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.741774 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:45:52.741940 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:45:52.753002 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:45:52.753857 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:45:52.754617 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:45:52.757584 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.757810 [debug] [MainThread]: On master: BEGIN
[0m15:45:52.758112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:52.767299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.767541 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.767774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:52.789974 [debug] [MainThread]: SQL status: SELECT 23 in 0.0 seconds
[0m15:45:52.791610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58290>]}
[0m15:45:52.791913 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:52.792854 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.793081 [debug] [MainThread]: On master: BEGIN
[0m15:45:52.794268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.794445 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.794602 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.794748 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.795349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.795518 [debug] [MainThread]: On master: Close
[0m15:45:52.795930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:52.796162 [info ] [MainThread]: 
[0m15:45:52.799782 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:45:52.800062 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:45:52.800401 [info ] [Thread-1 (]: 1 of 4 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:45:52.800740 [info ] [Thread-2 (]: 2 of 4 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:45:52.801509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:45:52.801967 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:45:52.802236 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:45:52.802507 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:45:52.804644 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:45:52.806334 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:45:52.806870 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:45:52.802695 => 15:45:52.806746
[0m15:45:52.807093 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:45:52.804828 => 15:45:52.806985
[0m15:45:52.807291 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:45:52.807480 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:45:52.828861 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:45:52.831603 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:45:52.832037 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.832206 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:45:52.832367 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.832512 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:52.832658 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:45:52.832872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:52.841759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.842061 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.842230 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:45:52.842499 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.842647 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.842804 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:45:52.864448 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:45:52.868372 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.868590 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:45:52.868827 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:45:52.870314 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.870568 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:45:52.871551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.871723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.873296 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.874768 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.874964 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:45:52.875142 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:45:52.875989 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.876151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.886987 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:45:52.888134 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:45:52.888330 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.888493 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.888642 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:45:52.888789 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:45:52.895452 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.895691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.898640 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:45:52.899956 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:45:52.900149 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:45:52.900331 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:45:52.910889 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:45:52.911878 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:45:52.807608 => 15:45:52.911772
[0m15:45:52.912064 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:45:52.912286 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:45:52.913067 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:45:52.829064 => 15:45:52.912971
[0m15:45:52.913524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9e890>]}
[0m15:45:52.913710 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:45:52.914078 [info ] [Thread-1 (]: 1 of 4 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m15:45:52.914572 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf2590>]}
[0m15:45:52.914876 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:45:52.915237 [info ] [Thread-2 (]: 2 of 4 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m15:45:52.915903 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_balance
[0m15:45:52.916191 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:45:52.916431 [info ] [Thread-4 (]: 3 of 4 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:45:52.917125 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m15:45:52.917437 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_salaries
[0m15:45:52.917619 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:45:52.917885 [info ] [Thread-1 (]: 4 of 4 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m15:45:52.919663 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:45:52.920196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_salaries)
[0m15:45:52.920589 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_salaries
[0m15:45:52.922644 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m15:45:52.923115 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:45:52.918076 => 15:45:52.923001
[0m15:45:52.923317 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_balance
[0m15:45:52.929122 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (compile): 15:45:52.920780 => 15:45:52.928882
[0m15:45:52.933457 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:45:52.933701 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_salaries
[0m15:45:52.935790 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m15:45:52.936109 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:45:52.936289 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:45:52.936447 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:45:52.936593 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m15:45:52.936728 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:52.936861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:52.946454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.946751 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:45:52.946938 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m15:45:52.947522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.947708 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:45:52.947895 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:45:52.950869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:45:52.952574 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:45:52.952752 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:45:52.952951 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m15:45:52.954337 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:45:52.954559 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:45:52.955212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.956107 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:45:52.957618 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:52.957847 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:45:52.958750 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:45:52.958921 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:45:52.959078 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:45:52.959277 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:45:52.960599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.960767 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.961916 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:45:52.963032 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:45:52.963193 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m15:45:52.963368 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:45:52.964041 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:45:52.964180 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:45:52.964844 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (execute): 15:45:52.933893 => 15:45:52.964759
[0m15:45:52.965498 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:45:52.923435 => 15:45:52.965411
[0m15:45:52.965672 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: Close
[0m15:45:52.965837 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: Close
[0m15:45:52.966202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e43d0>]}
[0m15:45:52.966832 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb643c8-791e-47d1-8d95-9f1547b286f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca20d0>]}
[0m15:45:52.966528 [info ] [Thread-1 (]: 4 of 4 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.05s]
[0m15:45:52.967237 [info ] [Thread-4 (]: 3 of 4 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.05s]
[0m15:45:52.967560 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_salaries
[0m15:45:52.967798 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_balance
[0m15:45:52.968795 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.968939 [debug] [MainThread]: On master: BEGIN
[0m15:45:52.969058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:52.977275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:52.977594 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.977738 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.977863 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.978439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:45:52.978625 [debug] [MainThread]: On master: Close
[0m15:45:52.978986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:52.979118 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m15:45:52.979237 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m15:45:52.979360 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:45:52.979551 [info ] [MainThread]: 
[0m15:45:52.979752 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:45:52.980267 [debug] [MainThread]: Command end result
[0m15:45:52.983230 [info ] [MainThread]: 
[0m15:45:52.983435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:52.983606 [info ] [MainThread]: 
[0m15:45:52.983830 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:45:52.984150 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:52.984104 after 0.47 seconds
[0m15:45:52.984321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104356250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b7cd0>]}
[0m15:45:52.984484 [debug] [MainThread]: Flushing usage events
[0m15:50:53.390005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061db610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbe50>]}


============================== 15:50:53.392500 | e24ecad6-16fb-4daa-be29-26d812ecd657 ==============================
[0m15:50:53.392500 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:50:53.392869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:50:53.431631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ebfd0>]}
[0m15:50:53.438187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be990>]}
[0m15:50:53.438583 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:50:53.449541 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:50:53.471123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:50:53.471508 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/most_popular_card.sql
[0m15:50:53.483191 [debug] [MainThread]: 1699: static parser successfully parsed summaries/most_popular_card.sql
[0m15:50:53.513389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275410>]}
[0m15:50:53.516615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106866950>]}
[0m15:50:53.516832 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:50:53.517016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f859d0>]}
[0m15:50:53.517791 [info ] [MainThread]: 
[0m15:50:53.518158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:53.518702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:50:53.523456 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:50:53.523720 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:53.523861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:53.578660 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:50:53.579598 [debug] [ThreadPool]: On list_mydb: Close
[0m15:50:53.580549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:50:53.583801 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:50:53.583973 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:50:53.584110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:53.599115 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.599284 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:50:53.599448 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:50:53.610685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:50:53.611516 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:50:53.613539 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:50:53.616749 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.616950 [debug] [MainThread]: On master: BEGIN
[0m15:50:53.617096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:53.626320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.626610 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.626854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:53.646874 [debug] [MainThread]: SQL status: SELECT 24 in 0.0 seconds
[0m15:50:53.648652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062069d0>]}
[0m15:50:53.648960 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:53.649748 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.649968 [debug] [MainThread]: On master: BEGIN
[0m15:50:53.651060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.651242 [debug] [MainThread]: On master: COMMIT
[0m15:50:53.651405 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.651552 [debug] [MainThread]: On master: COMMIT
[0m15:50:53.652174 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.652410 [debug] [MainThread]: On master: Close
[0m15:50:53.652849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:53.653093 [info ] [MainThread]: 
[0m15:50:53.656049 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:50:53.656299 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:50:53.656629 [info ] [Thread-1 (]: 1 of 5 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:50:53.656970 [info ] [Thread-2 (]: 2 of 5 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:50:53.657563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:50:53.658057 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:50:53.658303 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:50:53.658515 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:50:53.660699 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:50:53.662369 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:50:53.662946 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:50:53.660898 => 15:50:53.662830
[0m15:50:53.663162 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:50:53.658663 => 15:50:53.663057
[0m15:50:53.663354 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:50:53.663541 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:50:53.684776 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:50:53.687540 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:50:53.687967 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.688140 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.688298 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:50:53.688444 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:50:53.688582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:53.688718 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:53.697222 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.697517 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.697699 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:50:53.698006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.698199 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.698369 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:50:53.718884 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:50:53.722900 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.723118 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:50:53.723347 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:50:53.724818 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.725057 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:50:53.726216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.726381 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.728018 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.729655 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.729855 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:50:53.730035 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:50:53.730874 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.731034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.742001 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:50:53.743126 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:50:53.743321 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.743487 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.743644 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:50:53.743788 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:50:53.752530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.752746 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.755755 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:50:53.756981 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:50:53.757236 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:50:53.757413 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:50:53.764184 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:53.764389 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:53.765241 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:50:53.684937 => 15:50:53.765143
[0m15:50:53.765921 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:50:53.663664 => 15:50:53.765835
[0m15:50:53.766135 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:50:53.766334 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:50:53.766745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875fd0>]}
[0m15:50:53.767084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106866210>]}
[0m15:50:53.767443 [info ] [Thread-1 (]: 1 of 5 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m15:50:53.767818 [info ] [Thread-2 (]: 2 of 5 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m15:50:53.768205 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:50:53.768469 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:50:53.768986 [debug] [Thread-2 (]: Began running node model.maker_warehouse.most_popular_card
[0m15:50:53.769225 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_balance
[0m15:50:53.769445 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_salaries
[0m15:50:53.769667 [info ] [Thread-2 (]: 3 of 5 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m15:50:53.769964 [info ] [Thread-4 (]: 4 of 5 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:50:53.770254 [info ] [Thread-1 (]: 5 of 5 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m15:50:53.770687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.most_popular_card)
[0m15:50:53.771060 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m15:50:53.771368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_salaries)
[0m15:50:53.771554 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m15:50:53.771734 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:50:53.771909 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_salaries
[0m15:50:53.773739 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m15:50:53.775460 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:50:53.776717 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m15:50:53.777500 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:50:53.773992 => 15:50:53.777397
[0m15:50:53.777706 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 15:50:53.772056 => 15:50:53.777603
[0m15:50:53.777886 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_balance
[0m15:50:53.778096 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (compile): 15:50:53.775622 => 15:50:53.778002
[0m15:50:53.778245 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.most_popular_card
[0m15:50:53.787529 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:50:53.787751 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_salaries
[0m15:50:53.789787 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m15:50:53.793237 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m15:50:53.793744 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:50:53.793936 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:50:53.794100 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m15:50:53.794247 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:50:53.794393 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:50:53.794531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:53.794663 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m15:50:53.794790 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:50:53.795014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:53.803888 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.804129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.804369 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:50:53.804633 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:50:53.804861 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m15:50:53.805082 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:50:53.806784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.807064 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:50:53.807230 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m15:50:53.809419 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:53.811081 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:50:53.811373 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:53.811538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:53.811706 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:50:53.812993 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:50:53.814300 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:50:53.814509 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m15:50:53.814676 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m15:50:53.815066 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.815881 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:50:53.816037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.816167 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:50:53.816282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:53.817010 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:50:53.817150 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:50:53.817855 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:50:53.817998 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:50:53.818168 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:50:53.818317 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:50:53.818494 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:50:53.818979 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.820124 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:50:53.820274 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.820403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.820544 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:50:53.821564 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:50:53.822817 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:50:53.823121 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m15:50:53.823310 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m15:50:53.823760 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:53.824518 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:50:53.778354 => 15:50:53.824428
[0m15:50:53.824664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:53.824814 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:53.824971 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: Close
[0m15:50:53.825590 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (execute): 15:50:53.790077 => 15:50:53.825514
[0m15:50:53.826186 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 15:50:53.787866 => 15:50:53.826111
[0m15:50:53.826363 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: Close
[0m15:50:53.826662 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106978910>]}
[0m15:50:53.826822 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: Close
[0m15:50:53.827130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297710>]}
[0m15:50:53.827396 [info ] [Thread-4 (]: 4 of 5 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:50:53.827839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e24ecad6-16fb-4daa-be29-26d812ecd657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105877890>]}
[0m15:50:53.828158 [info ] [Thread-1 (]: 5 of 5 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:50:53.828559 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_balance
[0m15:50:53.828825 [info ] [Thread-2 (]: 3 of 5 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m15:50:53.829108 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_salaries
[0m15:50:53.829530 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.most_popular_card
[0m15:50:53.830445 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.830586 [debug] [MainThread]: On master: BEGIN
[0m15:50:53.830698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:53.838302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:53.838623 [debug] [MainThread]: On master: COMMIT
[0m15:50:53.838764 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:53.838890 [debug] [MainThread]: On master: COMMIT
[0m15:50:53.839538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:53.839672 [debug] [MainThread]: On master: Close
[0m15:50:53.839984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:53.840100 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m15:50:53.840203 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m15:50:53.840299 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:50:53.840460 [info ] [MainThread]: 
[0m15:50:53.840644 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:50:53.841233 [debug] [MainThread]: Command end result
[0m15:50:53.844230 [info ] [MainThread]: 
[0m15:50:53.844454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:53.844655 [info ] [MainThread]: 
[0m15:50:53.844822 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:50:53.845135 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:53.845093 after 0.47 seconds
[0m15:50:53.845300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102892250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029f3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029f1250>]}
[0m15:50:53.845456 [debug] [MainThread]: Flushing usage events
[0m15:58:28.974274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105237e90>]}


============================== 15:58:28.976800 | 9d1c629a-30f4-4f06-bea3-e779700d7ca5 ==============================
[0m15:58:28.976800 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:58:28.977145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:29.015604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f11d0>]}
[0m15:58:29.022579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f11d0>]}
[0m15:58:29.023225 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:58:29.033971 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:58:29.053100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:58:29.053447 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/salary_vs_cardtype.sql
[0m15:58:29.065112 [debug] [MainThread]: 1699: static parser successfully parsed summaries/salary_vs_cardtype.sql
[0m15:58:29.096665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578f210>]}
[0m15:58:29.099705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f2510>]}
[0m15:58:29.099899 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:58:29.100082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271e310>]}
[0m15:58:29.100863 [info ] [MainThread]: 
[0m15:58:29.101326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:29.102058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:58:29.107392 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:58:29.107725 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:58:29.107863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:29.163314 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:58:29.164258 [debug] [ThreadPool]: On list_mydb: Close
[0m15:58:29.165228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:58:29.168518 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:58:29.168687 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:58:29.168825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:29.181322 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.181494 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:58:29.181661 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:58:29.190596 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:58:29.191553 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:58:29.192299 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:58:29.195548 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.195780 [debug] [MainThread]: On master: BEGIN
[0m15:58:29.195937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:29.204910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.205132 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.205373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:29.227122 [debug] [MainThread]: SQL status: SELECT 25 in 0.0 seconds
[0m15:58:29.228806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f0610>]}
[0m15:58:29.229086 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:29.229867 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.230037 [debug] [MainThread]: On master: BEGIN
[0m15:58:29.231129 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.231293 [debug] [MainThread]: On master: COMMIT
[0m15:58:29.231450 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.231593 [debug] [MainThread]: On master: COMMIT
[0m15:58:29.232210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.232379 [debug] [MainThread]: On master: Close
[0m15:58:29.232789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:29.233015 [info ] [MainThread]: 
[0m15:58:29.236592 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:58:29.236887 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:58:29.237275 [info ] [Thread-1 (]: 1 of 6 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:58:29.237793 [info ] [Thread-2 (]: 2 of 6 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:58:29.238370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:58:29.238847 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:58:29.239132 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:58:29.239362 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:58:29.241396 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:58:29.243002 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:58:29.243730 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:58:29.239515 => 15:58:29.243588
[0m15:58:29.243972 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:58:29.241579 => 15:58:29.243865
[0m15:58:29.244166 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:58:29.244344 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:58:29.265236 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:58:29.267901 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:58:29.268342 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.268529 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.268700 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:58:29.268859 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:58:29.269009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:29.269149 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:29.278240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.278506 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.278738 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.278904 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.279070 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:58:29.279242 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:58:29.299955 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:58:29.304033 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.304271 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:58:29.304534 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:58:29.306287 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.306605 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:58:29.308310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.308521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.310293 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.311937 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.312132 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:58:29.312304 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:58:29.313630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.313825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.324866 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:58:29.326104 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:58:29.326284 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.326456 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.326612 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:58:29.326758 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:58:29.335256 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.335463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.338458 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:29.339709 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:29.339882 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:58:29.340045 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:58:29.346921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:29.347129 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:29.347977 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:58:29.244466 => 15:58:29.347880
[0m15:58:29.348655 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:58:29.265428 => 15:58:29.348570
[0m15:58:29.348848 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:58:29.349031 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:58:29.349445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105924350>]}
[0m15:58:29.349869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bead0>]}
[0m15:58:29.350239 [info ] [Thread-1 (]: 1 of 6 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m15:58:29.350604 [info ] [Thread-2 (]: 2 of 6 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m15:58:29.350960 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:58:29.351225 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:58:29.352037 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m15:58:29.352228 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m15:58:29.352424 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_balance
[0m15:58:29.352580 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m15:58:29.352818 [info ] [Thread-4 (]: 3 of 6 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m15:58:29.353108 [info ] [Thread-3 (]: 4 of 6 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m15:58:29.353416 [info ] [Thread-1 (]: 5 of 6 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:58:29.353746 [info ] [Thread-2 (]: 6 of 6 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m15:58:29.354223 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m15:58:29.354608 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.salary_vs_cardtype'
[0m15:58:29.354955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_balance)
[0m15:58:29.355305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.total_salaries)
[0m15:58:29.355506 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m15:58:29.355669 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m15:58:29.355825 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:58:29.355982 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_salaries
[0m15:58:29.357781 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m15:58:29.359462 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:29.360621 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:58:29.361823 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m15:58:29.362761 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 15:58:29.358026 => 15:58:29.362651
[0m15:58:29.362953 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 15:58:29.356092 => 15:58:29.362864
[0m15:58:29.363145 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m15:58:29.363314 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (compile): 15:58:29.360747 => 15:58:29.363239
[0m15:58:29.363483 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:58:29.359619 => 15:58:29.363398
[0m15:58:29.363637 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m15:58:29.372306 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:29.372550 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_salaries
[0m15:58:29.372746 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_balance
[0m15:58:29.375999 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m15:58:29.378088 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m15:58:29.379888 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:58:29.380096 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:29.380467 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:29.380612 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m15:58:29.380779 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:29.380968 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:29.381122 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m15:58:29.381274 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:29.381414 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:58:29.381546 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m15:58:29.381671 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:29.381880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:29.382019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:29.392166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.392465 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:29.392635 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:58:29.393722 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.393937 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:29.394115 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype
    AVG(customers.estimated_salary)
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m15:58:29.394308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.394514 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:29.394665 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m15:58:29.394943 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.395130 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:29.395294 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m15:58:29.395963 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 9:     AVG(customers.estimated_salary)
               ^

[0m15:58:29.396137 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: ROLLBACK
[0m15:58:29.397123 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:29.398718 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:29.398984 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 15:58:29.363745 => 15:58:29.398885
[0m15:58:29.399122 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:29.399258 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:29.399412 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:58:29.399569 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m15:58:29.400839 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:29.402000 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:29.402885 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m15:58:29.403082 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m15:58:29.403340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.404287 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:58:29.404516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.404662 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:29.404787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:29.405617 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:58:29.405820 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:58:29.406762 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:58:29.407008 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:29.407266 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:29.407499 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:58:29.407705 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:58:29.408375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.409717 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:29.409895 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.410039 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.410245 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:58:29.411330 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:29.412361 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:29.412590 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m15:58:29.412782 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m15:58:29.413213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:29.413958 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:58:29.378240 => 15:58:29.413876
[0m15:58:29.414129 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:29.414258 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:29.414427 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: Close
[0m15:58:29.415035 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 15:58:29.372887 => 15:58:29.414960
[0m15:58:29.415726 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (execute): 15:58:29.376257 => 15:58:29.415650
[0m15:58:29.416409 [debug] [Thread-3 (]: Database Error in model salary_vs_cardtype (models/summaries/salary_vs_cardtype.sql)
  syntax error at or near "("
  LINE 9:     AVG(customers.estimated_salary)
                 ^
  compiled Code at target/run/maker_warehouse/models/summaries/salary_vs_cardtype.sql
[0m15:58:29.416766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c33050>]}
[0m15:58:29.416916 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m15:58:29.417078 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: Close
[0m15:58:29.417252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f2610>]}
[0m15:58:29.417517 [info ] [Thread-1 (]: 5 of 6 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:29.417892 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ee1d0>]}
[0m15:58:29.418226 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1c629a-30f4-4f06-bea3-e779700d7ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c32b10>]}
[0m15:58:29.418501 [error] [Thread-3 (]: 4 of 6 ERROR creating sql view model bank_warehouse.salary_vs_cardtype ......... [[31mERROR[0m in 0.06s]
[0m15:58:29.418801 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_balance
[0m15:58:29.419058 [info ] [Thread-4 (]: 3 of 6 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:29.419535 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m15:58:29.419285 [info ] [Thread-2 (]: 6 of 6 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:29.419949 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m15:58:29.420249 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m15:58:29.420990 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.421116 [debug] [MainThread]: On master: BEGIN
[0m15:58:29.421223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:29.429110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:29.429397 [debug] [MainThread]: On master: COMMIT
[0m15:58:29.429526 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:29.429643 [debug] [MainThread]: On master: COMMIT
[0m15:58:29.430079 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:29.430240 [debug] [MainThread]: On master: Close
[0m15:58:29.430561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:29.430684 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:58:29.430791 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m15:58:29.430892 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m15:58:29.430987 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m15:58:29.431131 [info ] [MainThread]: 
[0m15:58:29.431301 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:58:29.431889 [debug] [MainThread]: Command end result
[0m15:58:29.434830 [info ] [MainThread]: 
[0m15:58:29.435028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:58:29.435212 [info ] [MainThread]: 
[0m15:58:29.435410 [error] [MainThread]: [33mDatabase Error in model salary_vs_cardtype (models/summaries/salary_vs_cardtype.sql)[0m
[0m15:58:29.435563 [error] [MainThread]:   syntax error at or near "("
[0m15:58:29.435702 [error] [MainThread]:   LINE 9:     AVG(customers.estimated_salary)
[0m15:58:29.435838 [error] [MainThread]:                  ^
[0m15:58:29.436050 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/summaries/salary_vs_cardtype.sql
[0m15:58:29.436230 [info ] [MainThread]: 
[0m15:58:29.436417 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:58:29.436753 [debug] [MainThread]: Command `dbt run` failed at 15:58:29.436704 after 0.48 seconds
[0m15:58:29.436945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10110bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10110b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fcd90>]}
[0m15:58:29.437106 [debug] [MainThread]: Flushing usage events
[0m15:58:44.571304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ab6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abf10>]}


============================== 15:58:44.574178 | 8bcbe4d0-5127-4e14-a9e4-8c64fd848980 ==============================
[0m15:58:44.574178 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:58:44.574565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:44.613438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bbed0>]}
[0m15:58:44.620057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bbed0>]}
[0m15:58:44.620601 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:58:44.632200 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:58:44.649263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:44.649680 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/salary_vs_cardtype.sql
[0m15:58:44.660811 [debug] [MainThread]: 1699: static parser successfully parsed summaries/salary_vs_cardtype.sql
[0m15:58:44.689463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104945310>]}
[0m15:58:44.692813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f19fd0>]}
[0m15:58:44.693019 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:58:44.693201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102655a10>]}
[0m15:58:44.693993 [info ] [MainThread]: 
[0m15:58:44.694400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:44.694988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:58:44.699598 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:58:44.699794 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:58:44.699920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:44.747427 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:58:44.748259 [debug] [ThreadPool]: On list_mydb: Close
[0m15:58:44.749121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:58:44.752072 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:58:44.752236 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:58:44.752366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:44.766136 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.766301 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:58:44.766456 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:58:44.773436 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:58:44.774284 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:58:44.774998 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:58:44.778329 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.778594 [debug] [MainThread]: On master: BEGIN
[0m15:58:44.778750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:44.787614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.787843 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.788072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:44.809379 [debug] [MainThread]: SQL status: SELECT 25 in 0.0 seconds
[0m15:58:44.811060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb12d0>]}
[0m15:58:44.811333 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:44.812108 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.812333 [debug] [MainThread]: On master: BEGIN
[0m15:58:44.813506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.813718 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.813893 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.814047 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.814674 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.814841 [debug] [MainThread]: On master: Close
[0m15:58:44.815258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:44.815491 [info ] [MainThread]: 
[0m15:58:44.819346 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:58:44.819607 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:58:44.819935 [info ] [Thread-1 (]: 1 of 6 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:58:44.820321 [info ] [Thread-2 (]: 2 of 6 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:58:44.820852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:58:44.821249 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:58:44.821454 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:58:44.821632 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:58:44.823568 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:58:44.825312 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:58:44.825905 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:58:44.821753 => 15:58:44.825785
[0m15:58:44.826150 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:58:44.823747 => 15:58:44.826023
[0m15:58:44.826376 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:58:44.826575 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:58:44.847168 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:58:44.849836 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:58:44.850272 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.850455 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.850602 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:58:44.850748 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:58:44.850883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:44.851015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:44.859429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.859689 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.859927 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.860113 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.860309 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:58:44.860503 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:58:44.875907 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:58:44.879787 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.880009 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:58:44.880207 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:58:44.881801 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.881971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.882170 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:58:44.883719 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.883949 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:58:44.884625 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.884789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.886353 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.896777 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:58:44.896982 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:58:44.897152 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.897343 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:58:44.898112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.899269 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:58:44.899442 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.899594 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:58:44.903230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.903408 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.906158 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:58:44.907368 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:58:44.907545 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:58:44.907707 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:58:44.911784 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:44.911963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:44.912751 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:58:44.847367 => 15:58:44.912655
[0m15:58:44.913431 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:58:44.826711 => 15:58:44.913347
[0m15:58:44.913631 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:58:44.913816 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:58:44.914197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14610>]}
[0m15:58:44.914911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f27a50>]}
[0m15:58:44.914564 [info ] [Thread-2 (]: 2 of 6 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.09s]
[0m15:58:44.915271 [info ] [Thread-1 (]: 1 of 6 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.09s]
[0m15:58:44.915606 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:58:44.915870 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:58:44.916653 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m15:58:44.916837 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m15:58:44.916997 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_balance
[0m15:58:44.917148 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_salaries
[0m15:58:44.917372 [info ] [Thread-4 (]: 3 of 6 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m15:58:44.917669 [info ] [Thread-3 (]: 4 of 6 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m15:58:44.917924 [info ] [Thread-2 (]: 5 of 6 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:58:44.918137 [info ] [Thread-1 (]: 6 of 6 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m15:58:44.918813 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m15:58:44.919184 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.salary_vs_cardtype'
[0m15:58:44.919507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.total_balance)
[0m15:58:44.919782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_salaries)
[0m15:58:44.919959 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m15:58:44.920112 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m15:58:44.920254 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:58:44.920408 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_salaries
[0m15:58:44.922037 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m15:58:44.923383 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:44.924750 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:58:44.926137 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m15:58:44.926860 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 15:58:44.922192 => 15:58:44.926747
[0m15:58:44.927046 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 15:58:44.920510 => 15:58:44.926969
[0m15:58:44.927245 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (compile): 15:58:44.924967 => 15:58:44.927147
[0m15:58:44.927403 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:58:44.923523 => 15:58:44.927334
[0m15:58:44.927535 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m15:58:44.927685 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m15:58:44.927847 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_salaries
[0m15:58:44.927983 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_balance
[0m15:58:44.936753 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:44.939600 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m15:58:44.941666 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m15:58:44.943646 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:58:44.944102 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:44.944272 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:44.944429 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:44.944606 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m15:58:44.944760 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:44.944902 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m15:58:44.945032 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m15:58:44.945167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:44.945296 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:58:44.945418 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:44.945540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:44.945755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:44.954417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.954707 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:44.954873 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:58:44.955673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.955939 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:58:44.956140 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    AVG(customers.estimated_salary)
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m15:58:44.956892 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.957315 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:44.957084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.957491 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m15:58:44.957675 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:44.957891 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m15:58:44.958492 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column customers.estimated_salary does not exist
LINE 9:     AVG(customers.estimated_salary)
                ^
HINT:  Perhaps you meant to reference the column "customers.estimatedsalary".

[0m15:58:44.958687 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: ROLLBACK
[0m15:58:44.959742 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:44.961396 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:44.961672 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 15:58:44.928083 => 15:58:44.961581
[0m15:58:44.961836 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:58:44.961998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:44.962158 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m15:58:44.963435 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:44.963585 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:58:44.963790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.964651 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m15:58:44.965979 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:44.966976 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:58:44.967212 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m15:58:44.967387 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:44.967565 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:58:44.968008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.968835 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:58:44.968983 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:44.969132 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.969283 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:44.970023 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:58:44.971040 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:58:44.971225 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:58:44.971386 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:44.971664 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:58:44.971878 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:58:44.972513 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:44.973177 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:58:44.941873 => 15:58:44.973095
[0m15:58:44.973327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.973476 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.973694 [debug] [Thread-2 (]: On model.maker_warehouse.total_balance: Close
[0m15:58:44.974796 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:58:44.975970 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:58:44.976339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef5590>]}
[0m15:58:44.976492 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m15:58:44.976686 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m15:58:44.977023 [info ] [Thread-2 (]: 5 of 6 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:44.978015 [debug] [Thread-3 (]: Database Error in model salary_vs_cardtype (models/summaries/salary_vs_cardtype.sql)
  column customers.estimated_salary does not exist
  LINE 9:     AVG(customers.estimated_salary)
                  ^
  HINT:  Perhaps you meant to reference the column "customers.estimatedsalary".
  compiled Code at target/run/maker_warehouse/models/summaries/salary_vs_cardtype.sql
[0m15:58:44.978260 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:44.978538 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_balance
[0m15:58:44.978752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cc790>]}
[0m15:58:44.978909 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:58:44.979644 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (execute): 15:58:44.939771 => 15:58:44.979565
[0m15:58:44.979988 [error] [Thread-3 (]: 4 of 6 ERROR creating sql view model bank_warehouse.salary_vs_cardtype ......... [[31mERROR[0m in 0.06s]
[0m15:58:44.980717 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 15:58:44.936900 => 15:58:44.980636
[0m15:58:44.980909 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: Close
[0m15:58:44.981107 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m15:58:44.981260 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m15:58:44.981801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104972c50>]}
[0m15:58:44.982150 [info ] [Thread-1 (]: 6 of 6 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:44.982667 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbe4d0-5127-4e14-a9e4-8c64fd848980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489b050>]}
[0m15:58:44.982895 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_salaries
[0m15:58:44.983146 [info ] [Thread-4 (]: 3 of 6 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:44.983497 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m15:58:44.984393 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.984539 [debug] [MainThread]: On master: BEGIN
[0m15:58:44.984647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:44.991985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:44.992374 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.992506 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:44.992619 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.993123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:44.993243 [debug] [MainThread]: On master: Close
[0m15:58:44.993549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:44.993658 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m15:58:44.993756 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:58:44.993852 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m15:58:44.993946 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m15:58:44.994087 [info ] [MainThread]: 
[0m15:58:44.994255 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:58:44.994795 [debug] [MainThread]: Command end result
[0m15:58:44.997823 [info ] [MainThread]: 
[0m15:58:44.998055 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:58:44.998223 [info ] [MainThread]: 
[0m15:58:44.998383 [error] [MainThread]: [33mDatabase Error in model salary_vs_cardtype (models/summaries/salary_vs_cardtype.sql)[0m
[0m15:58:44.998534 [error] [MainThread]:   column customers.estimated_salary does not exist
[0m15:58:44.998719 [error] [MainThread]:   LINE 9:     AVG(customers.estimated_salary)
[0m15:58:44.998869 [error] [MainThread]:                   ^
[0m15:58:44.999011 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "customers.estimatedsalary".
[0m15:58:44.999150 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/summaries/salary_vs_cardtype.sql
[0m15:58:44.999304 [info ] [MainThread]: 
[0m15:58:44.999501 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:58:44.999868 [debug] [MainThread]: Command `dbt run` failed at 15:58:44.999813 after 0.44 seconds
[0m15:58:45.000068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010c3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010c3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501bc90>]}
[0m15:58:45.000245 [debug] [MainThread]: Flushing usage events
[0m15:59:01.298773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685fe50>]}


============================== 15:59:01.301252 | 4c0622d8-db12-43a6-ab2e-0c06d1428b59 ==============================
[0m15:59:01.301252 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:59:01.301611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:59:01.339231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068824d0>]}
[0m15:59:01.345936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106842990>]}
[0m15:59:01.346315 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:59:01.356619 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:59:01.372982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:01.373463 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/salary_vs_cardtype.sql
[0m15:59:01.384647 [debug] [MainThread]: 1699: static parser successfully parsed summaries/salary_vs_cardtype.sql
[0m15:59:01.414107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eb050>]}
[0m15:59:01.417201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecff90>]}
[0m15:59:01.417396 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:59:01.417582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104609a10>]}
[0m15:59:01.418359 [info ] [MainThread]: 
[0m15:59:01.418782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:01.419441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m15:59:01.424878 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m15:59:01.425190 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m15:59:01.425327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:01.482168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:59:01.483140 [debug] [ThreadPool]: On list_mydb: Close
[0m15:59:01.484143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m15:59:01.487361 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:59:01.487559 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m15:59:01.487699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:01.495699 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.495969 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m15:59:01.496136 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m15:59:01.501365 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:59:01.502291 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m15:59:01.502995 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m15:59:01.506320 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.506534 [debug] [MainThread]: On master: BEGIN
[0m15:59:01.506675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:01.514580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.514788 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.515002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:01.528551 [debug] [MainThread]: SQL status: SELECT 25 in 0.0 seconds
[0m15:59:01.530083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e80d0>]}
[0m15:59:01.530343 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:01.531037 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.531216 [debug] [MainThread]: On master: BEGIN
[0m15:59:01.532406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.532578 [debug] [MainThread]: On master: COMMIT
[0m15:59:01.532725 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.532856 [debug] [MainThread]: On master: COMMIT
[0m15:59:01.533412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.533568 [debug] [MainThread]: On master: Close
[0m15:59:01.533948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:01.534161 [info ] [MainThread]: 
[0m15:59:01.537037 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m15:59:01.537265 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m15:59:01.537604 [info ] [Thread-1 (]: 1 of 6 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m15:59:01.538256 [info ] [Thread-2 (]: 2 of 6 START sql table model bank_warehouse.customers .......................... [RUN]
[0m15:59:01.538859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m15:59:01.539312 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m15:59:01.539579 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m15:59:01.539842 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m15:59:01.541900 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m15:59:01.543400 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m15:59:01.543874 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 15:59:01.540037 => 15:59:01.543760
[0m15:59:01.544072 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 15:59:01.542062 => 15:59:01.543979
[0m15:59:01.544253 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m15:59:01.544428 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m15:59:01.564647 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m15:59:01.567313 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m15:59:01.567735 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.567914 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.568065 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m15:59:01.568217 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m15:59:01.568361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:01.568497 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:59:01.577112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.577366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.577577 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.577761 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.577944 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m15:59:01.578117 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m15:59:01.589864 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:59:01.593656 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.593871 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m15:59:01.594093 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m15:59:01.595651 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.595873 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m15:59:01.596634 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.596779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.598128 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.599494 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.599664 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m15:59:01.599824 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m15:59:01.600621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.600764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.611246 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:59:01.612337 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:59:01.612508 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.612656 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.612792 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m15:59:01.612923 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m15:59:01.617592 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.617791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.620518 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m15:59:01.621711 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m15:59:01.621885 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m15:59:01.622048 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m15:59:01.626594 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:59:01.626804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:59:01.627651 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 15:59:01.564832 => 15:59:01.627545
[0m15:59:01.628375 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 15:59:01.544546 => 15:59:01.628287
[0m15:59:01.628573 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m15:59:01.628751 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m15:59:01.629155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a010>]}
[0m15:59:01.629547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f8250>]}
[0m15:59:01.629888 [info ] [Thread-2 (]: 2 of 6 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.09s]
[0m15:59:01.630518 [info ] [Thread-1 (]: 1 of 6 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.09s]
[0m15:59:01.630922 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m15:59:01.631205 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m15:59:01.631558 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m15:59:01.631839 [debug] [Thread-2 (]: Began running node model.maker_warehouse.most_popular_card
[0m15:59:01.632000 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m15:59:01.632343 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_balance
[0m15:59:01.632188 [info ] [Thread-4 (]: 3 of 6 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m15:59:01.632609 [info ] [Thread-2 (]: 4 of 6 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m15:59:01.632881 [info ] [Thread-3 (]: 5 of 6 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m15:59:01.633139 [info ] [Thread-1 (]: 6 of 6 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m15:59:01.633566 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_salaries'
[0m15:59:01.633850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.most_popular_card)
[0m15:59:01.634153 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.salary_vs_cardtype'
[0m15:59:01.634417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_balance)
[0m15:59:01.634571 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m15:59:01.634719 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m15:59:01.634858 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m15:59:01.634993 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_balance
[0m15:59:01.636512 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m15:59:01.637753 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m15:59:01.639031 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.640233 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m15:59:01.640725 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 15:59:01.635097 => 15:59:01.640630
[0m15:59:01.640969 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 15:59:01.637880 => 15:59:01.640886
[0m15:59:01.641142 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m15:59:01.641332 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 15:59:01.636649 => 15:59:01.641251
[0m15:59:01.641506 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m15:59:01.641687 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (compile): 15:59:01.639178 => 15:59:01.641603
[0m15:59:01.650819 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m15:59:01.651001 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.most_popular_card
[0m15:59:01.653763 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.653955 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_balance
[0m15:59:01.656029 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m15:59:01.658129 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m15:59:01.658306 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:59:01.658523 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.658720 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m15:59:01.658864 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:59:01.659020 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m15:59:01.659151 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:59:01.659291 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:01.659436 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m15:59:01.659567 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:59:01.659698 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: BEGIN
[0m15:59:01.659892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:01.660096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:01.668323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.668713 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.668907 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:59:01.669113 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.669295 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m15:59:01.669494 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    AVG(customers.estimatedsalary)
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m15:59:01.669853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.670002 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:59:01.670214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.670365 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m15:59:01.670534 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:59:01.670727 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m15:59:01.673011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:01.674823 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:59:01.675065 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:01.675214 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m15:59:01.675345 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:01.676742 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.676891 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:59:01.678136 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:59:01.678280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.678436 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m15:59:01.679694 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:59:01.679845 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m15:59:01.680624 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:59:01.680816 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m15:59:01.681006 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:59:01.681209 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m15:59:01.681707 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.681861 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.682736 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m15:59:01.682896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:59:01.683023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.683767 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:59:01.683916 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.684628 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:59:01.685713 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m15:59:01.685856 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:59:01.685998 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m15:59:01.686136 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:59:01.686274 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m15:59:01.686410 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m15:59:01.686567 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m15:59:01.687134 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:01.687750 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (execute): 15:59:01.656326 => 15:59:01.687670
[0m15:59:01.687887 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.688016 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.688135 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.688275 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: Close
[0m15:59:01.689327 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m15:59:01.690301 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m15:59:01.691244 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m15:59:01.691601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4410>]}
[0m15:59:01.691759 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m15:59:01.691937 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m15:59:01.692103 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m15:59:01.692369 [info ] [Thread-1 (]: 6 of 6 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:59:01.692825 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_balance
[0m15:59:01.693483 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:01.693648 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:01.693791 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:59:01.694509 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 15:59:01.651124 => 15:59:01.694427
[0m15:59:01.695152 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 15:59:01.641798 => 15:59:01.695077
[0m15:59:01.695779 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 15:59:01.654122 => 15:59:01.695701
[0m15:59:01.695990 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m15:59:01.696178 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m15:59:01.696352 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: Close
[0m15:59:01.696785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f67710>]}
[0m15:59:01.697130 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a950>]}
[0m15:59:01.697463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0622d8-db12-43a6-ab2e-0c06d1428b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7d5d0>]}
[0m15:59:01.697727 [info ] [Thread-3 (]: 5 of 6 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.06s]
[0m15:59:01.698006 [info ] [Thread-4 (]: 3 of 6 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.06s]
[0m15:59:01.698263 [info ] [Thread-2 (]: 4 of 6 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m15:59:01.698605 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m15:59:01.698827 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m15:59:01.699059 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.most_popular_card
[0m15:59:01.699927 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.700067 [debug] [MainThread]: On master: BEGIN
[0m15:59:01.700175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:01.707281 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:01.707598 [debug] [MainThread]: On master: COMMIT
[0m15:59:01.707738 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:01.707858 [debug] [MainThread]: On master: COMMIT
[0m15:59:01.708577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:01.708772 [debug] [MainThread]: On master: Close
[0m15:59:01.709148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:01.709285 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m15:59:01.709390 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m15:59:01.709489 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m15:59:01.709584 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m15:59:01.709734 [info ] [MainThread]: 
[0m15:59:01.709904 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:59:01.710492 [debug] [MainThread]: Command end result
[0m15:59:01.714215 [info ] [MainThread]: 
[0m15:59:01.714429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:01.714610 [info ] [MainThread]: 
[0m15:59:01.714784 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:59:01.715082 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:01.715039 after 0.43 seconds
[0m15:59:01.715248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f16250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103077010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103077cd0>]}
[0m15:59:01.715397 [debug] [MainThread]: Flushing usage events
[0m16:00:29.199441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573ebd0>]}


============================== 16:00:29.201993 | c4607026-2b36-4f84-bc99-6f61e9d9a4ce ==============================
[0m16:00:29.201993 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:00:29.202323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:00:29.240712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057dafd0>]}
[0m16:00:29.247222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105759050>]}
[0m16:00:29.247591 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:00:29.258090 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:00:29.276267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:29.276692 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/salary_vs_cardtype.sql
[0m16:00:29.288077 [debug] [MainThread]: 1699: static parser successfully parsed summaries/salary_vs_cardtype.sql
[0m16:00:29.318822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0e3d0>]}
[0m16:00:29.321852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571b4d0>]}
[0m16:00:29.322067 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:00:29.322255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455c50>]}
[0m16:00:29.323058 [info ] [MainThread]: 
[0m16:00:29.323451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:29.324045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:00:29.328720 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:00:29.328901 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:00:29.329040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:29.396404 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:00:29.397357 [debug] [ThreadPool]: On list_mydb: Close
[0m16:00:29.398452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:00:29.402026 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:00:29.402251 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:00:29.402405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:29.415468 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.415745 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:00:29.415944 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:00:29.423754 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:00:29.424711 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:00:29.425489 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:00:29.429029 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.429259 [debug] [MainThread]: On master: BEGIN
[0m16:00:29.429416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:29.438256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.438488 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.438795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:29.456956 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m16:00:29.459080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575be50>]}
[0m16:00:29.459378 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:29.460112 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.460278 [debug] [MainThread]: On master: BEGIN
[0m16:00:29.461448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.461639 [debug] [MainThread]: On master: COMMIT
[0m16:00:29.461842 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.461999 [debug] [MainThread]: On master: COMMIT
[0m16:00:29.462628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.462804 [debug] [MainThread]: On master: Close
[0m16:00:29.463214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:29.463451 [info ] [MainThread]: 
[0m16:00:29.467038 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:00:29.467311 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:00:29.467675 [info ] [Thread-1 (]: 1 of 6 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m16:00:29.468046 [info ] [Thread-2 (]: 2 of 6 START sql table model bank_warehouse.customers .......................... [RUN]
[0m16:00:29.468635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:00:29.469114 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:00:29.469361 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:00:29.469594 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:00:29.471664 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:00:29.473376 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:00:29.473993 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:00:29.471865 => 16:00:29.473840
[0m16:00:29.474240 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:00:29.469752 => 16:00:29.474125
[0m16:00:29.474463 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:00:29.474672 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:00:29.496114 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:00:29.498813 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:00:29.499264 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.499453 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.499622 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:00:29.499773 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:00:29.499914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:00:29.500052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:29.510388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.510695 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.510877 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:00:29.511093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.511269 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.511437 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:00:29.531190 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:00:29.535230 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.535457 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:00:29.535691 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:00:29.537382 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.537656 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:00:29.538560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.538734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.540192 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.541684 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.541864 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:00:29.542041 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:00:29.542848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.543009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.553756 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:00:29.554856 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:00:29.555039 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.555197 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.555348 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:00:29.555493 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:00:29.563569 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.563787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.566872 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:00:29.568201 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:00:29.568384 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:00:29.568560 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:00:29.581585 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:29.582590 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:00:29.474809 => 16:00:29.582478
[0m16:00:29.582812 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:00:29.583274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d88750>]}
[0m16:00:29.583670 [info ] [Thread-2 (]: 2 of 6 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m16:00:29.584038 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:00:29.584338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:29.584634 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m16:00:29.585513 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:00:29.496313 => 16:00:29.585415
[0m16:00:29.585790 [info ] [Thread-4 (]: 3 of 6 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m16:00:29.586074 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:00:29.586523 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_salaries'
[0m16:00:29.586958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573ef10>]}
[0m16:00:29.587165 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:00:29.587494 [info ] [Thread-1 (]: 1 of 6 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.12s]
[0m16:00:29.589695 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:00:29.590162 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:00:29.590716 [debug] [Thread-2 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:00:29.590901 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:00:29.591069 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_balance
[0m16:00:29.591323 [info ] [Thread-2 (]: 4 of 6 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m16:00:29.591591 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:00:29.587690 => 16:00:29.591496
[0m16:00:29.591807 [info ] [Thread-3 (]: 5 of 6 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m16:00:29.592067 [info ] [Thread-1 (]: 6 of 6 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m16:00:29.592462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.most_popular_card)
[0m16:00:29.592688 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:00:29.593056 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.salary_vs_cardtype'
[0m16:00:29.593347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.total_balance)
[0m16:00:29.593522 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:00:29.603088 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:00:29.603301 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:00:29.603469 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:00:29.604684 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:00:29.606173 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.607313 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:00:29.607827 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:00:29.608116 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:00:29.608324 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:00:29.603579 => 16:00:29.608232
[0m16:00:29.608470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:29.608667 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:00:29.606314 => 16:00:29.608584
[0m16:00:29.608812 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:00:29.608992 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:00:29.604928 => 16:00:29.608901
[0m16:00:29.609228 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_balance
[0m16:00:29.612290 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:00:29.612512 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:00:29.614390 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:00:29.616284 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.616599 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:00:29.616795 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:00:29.616970 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:00:29.617166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:29.617344 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.617487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.617669 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:00:29.617931 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:00:29.618089 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:00:29.618246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:29.618400 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:00:29.618601 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:00:29.623788 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:29.625840 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:00:29.626082 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:00:29.627588 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.628536 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:00:29.628717 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.628899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.629075 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:00:29.629254 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:00:29.629419 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:00:29.629575 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:00:29.629731 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:00:29.629906 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:00:29.630068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.630362 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.630560 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:00:29.631322 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.632704 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:00:29.632896 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:00:29.633896 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:29.634047 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:29.634774 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:00:29.593643 => 16:00:29.634693
[0m16:00:29.634908 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:29.636253 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:00:29.636433 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m16:00:29.637748 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:00:29.637921 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:00:29.638380 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104677b50>]}
[0m16:00:29.638696 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:00:29.638890 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:00:29.639351 [info ] [Thread-4 (]: 3 of 6 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.05s]
[0m16:00:29.641521 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.641708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.642024 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:00:29.642205 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:00:29.643050 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:00:29.643206 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.643492 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:00:29.644292 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:00:29.644434 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:29.644586 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:00:29.644744 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:00:29.645451 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:00:29.645629 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:00:29.645776 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.645963 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:00:29.646687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.647835 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:00:29.647982 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:00:29.648119 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.648241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.649280 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:00:29.649414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:29.650394 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:00:29.650547 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:00:29.651216 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:00:29.612636 => 16:00:29.651143
[0m16:00:29.651365 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:00:29.651552 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: Close
[0m16:00:29.651954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106226050>]}
[0m16:00:29.652383 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:29.653097 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:00:29.614570 => 16:00:29.653014
[0m16:00:29.653271 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:00:29.652235 [info ] [Thread-1 (]: 6 of 6 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m16:00:29.653456 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:00:29.653747 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_balance
[0m16:00:29.654051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1f3d0>]}
[0m16:00:29.654694 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:00:29.609332 => 16:00:29.654613
[0m16:00:29.655077 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:00:29.655514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4607026-2b36-4f84-bc99-6f61e9d9a4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218190>]}
[0m16:00:29.655818 [info ] [Thread-2 (]: 4 of 6 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:00:29.656055 [info ] [Thread-3 (]: 5 of 6 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:00:29.656463 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:00:29.656693 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:00:29.657706 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.658990 [debug] [MainThread]: On master: BEGIN
[0m16:00:29.659140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:29.666572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:29.666829 [debug] [MainThread]: On master: COMMIT
[0m16:00:29.666969 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:29.667089 [debug] [MainThread]: On master: COMMIT
[0m16:00:29.667562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:29.667699 [debug] [MainThread]: On master: Close
[0m16:00:29.667999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:29.668110 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m16:00:29.668210 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m16:00:29.668306 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m16:00:29.668400 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:00:29.668546 [info ] [MainThread]: 
[0m16:00:29.668711 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:00:29.669279 [debug] [MainThread]: Command end result
[0m16:00:29.673278 [info ] [MainThread]: 
[0m16:00:29.673540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:29.673703 [info ] [MainThread]: 
[0m16:00:29.673875 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:00:29.674257 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:29.674190 after 0.49 seconds
[0m16:00:29.674473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d62250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ec3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ec3cd0>]}
[0m16:00:29.674659 [debug] [MainThread]: Flushing usage events
[0m16:09:54.439535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104229bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104236e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104237650>]}


============================== 16:09:54.442163 | faead096-17c6-4677-b581-9126db4cdea8 ==============================
[0m16:09:54.442163 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:09:54.442480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:09:54.480325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042364d0>]}
[0m16:09:54.486781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042474d0>]}
[0m16:09:54.487155 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:09:54.498303 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:09:54.518315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:09:54.518645 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/credit_score_balance_ctry.sql
[0m16:09:54.530443 [debug] [MainThread]: 1699: static parser successfully parsed summaries/credit_score_balance_ctry.sql
[0m16:09:54.560279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495a790>]}
[0m16:09:54.563274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104930390>]}
[0m16:09:54.563473 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:09:54.563654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101995a10>]}
[0m16:09:54.564441 [info ] [MainThread]: 
[0m16:09:54.564809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:54.565372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:09:54.569835 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:09:54.569993 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:09:54.570121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:54.635303 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:09:54.636239 [debug] [ThreadPool]: On list_mydb: Close
[0m16:09:54.637305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:09:54.640755 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:09:54.640943 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:09:54.641091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:54.656095 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.656253 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:09:54.656416 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:09:54.669158 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:09:54.670075 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:09:54.670927 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:09:54.674485 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.674701 [debug] [MainThread]: On master: BEGIN
[0m16:09:54.674862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:54.684263 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.684546 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.684816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:54.703599 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m16:09:54.705796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fe2d0>]}
[0m16:09:54.706104 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:54.707027 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.707266 [debug] [MainThread]: On master: BEGIN
[0m16:09:54.708621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.708836 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.709019 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.709187 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.709925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.710136 [debug] [MainThread]: On master: Close
[0m16:09:54.710612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:54.710869 [info ] [MainThread]: 
[0m16:09:54.714760 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:09:54.715072 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:09:54.715452 [info ] [Thread-1 (]: 1 of 7 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m16:09:54.715829 [info ] [Thread-2 (]: 2 of 7 START sql table model bank_warehouse.customers .......................... [RUN]
[0m16:09:54.716520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:09:54.717020 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:09:54.717233 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:09:54.717425 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:09:54.719495 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:09:54.721181 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:09:54.721948 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:09:54.717558 => 16:09:54.721804
[0m16:09:54.722206 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:09:54.719675 => 16:09:54.722088
[0m16:09:54.722423 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:09:54.722623 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:09:54.746014 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:09:54.748982 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:09:54.749469 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.749692 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.749863 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:09:54.750038 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:09:54.750200 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:54.750370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:54.761183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.761508 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.761706 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:09:54.762886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.763108 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.763288 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:09:54.780990 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:09:54.785078 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.785296 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:09:54.785531 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:09:54.787098 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.787343 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:09:54.788399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.788591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.790130 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.791646 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.791831 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:09:54.792011 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:09:54.792872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.793047 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.803812 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:09:54.804935 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:09:54.805124 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.805284 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.805434 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:09:54.805578 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:09:54.811865 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.812071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.815048 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:09:54.816347 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:09:54.816538 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:09:54.816714 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:09:54.824155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:54.825023 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:09:54.722756 => 16:09:54.824917
[0m16:09:54.825223 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:09:54.825635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab92d0>]}
[0m16:09:54.825977 [info ] [Thread-1 (]: 1 of 7 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m16:09:54.826311 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:09:54.826700 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:09:54.826955 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m16:09:54.827204 [info ] [Thread-4 (]: 3 of 7 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m16:09:54.827539 [info ] [Thread-3 (]: 4 of 7 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m16:09:54.828091 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m16:09:54.828300 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:54.828659 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m16:09:54.828870 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:09:54.829694 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:09:54.746224 => 16:09:54.829597
[0m16:09:54.829879 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:09:54.831704 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:09:54.832000 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:09:54.833422 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:09:54.833927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e0050>]}
[0m16:09:54.834462 [info ] [Thread-2 (]: 2 of 7 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.12s]
[0m16:09:54.834777 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:09:54.830025 => 16:09:54.834660
[0m16:09:54.835014 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:09:54.832162 => 16:09:54.834921
[0m16:09:54.835272 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:09:54.835456 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:09:54.835626 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m16:09:54.845618 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:09:54.845856 [debug] [Thread-1 (]: Began running node model.maker_warehouse.credit_score_balance_ctry
[0m16:09:54.846035 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:09:54.848037 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:09:54.848327 [info ] [Thread-1 (]: 5 of 7 START sql view model bank_warehouse.credit_score_balance_ctry ........... [RUN]
[0m16:09:54.848610 [info ] [Thread-2 (]: 6 of 7 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m16:09:54.848834 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:09:54.849199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.credit_score_balance_ctry)
[0m16:09:54.849607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.salary_vs_cardtype)
[0m16:09:54.849754 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:09:54.849899 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:09:54.850043 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.credit_score_balance_ctry
[0m16:09:54.850180 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:09:54.850313 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:09:54.850447 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:54.851862 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.853844 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.854018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:54.854560 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:09:54.851980 => 16:09:54.854466
[0m16:09:54.854756 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.credit_score_balance_ctry (compile): 16:09:54.850543 => 16:09:54.854666
[0m16:09:54.854906 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:09:54.855062 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.credit_score_balance_ctry
[0m16:09:54.857251 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.859608 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.860101 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.860281 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.860461 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:09:54.860654 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: BEGIN
[0m16:09:54.860834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:54.861074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:54.865458 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.865744 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:09:54.865924 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:09:54.866150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.866322 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:09:54.866475 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:09:54.871230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.871882 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.872105 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.credit_score_balance_ctry"} */

  create view "mydb"."bank_warehouse"."credit_score_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:09:54.872340 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:54.874307 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:09:54.874535 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:54.874755 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:09:54.876282 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:09:54.876586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.876768 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:09:54.876941 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.877162 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:09:54.877377 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.878237 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:09:54.878519 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.878659 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:54.878797 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:09:54.879553 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:09:54.880814 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.880968 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:09:54.881114 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:09:54.881259 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.credit_score_balance_ctry"} */
alter table "mydb"."bank_warehouse"."credit_score_balance_ctry__dbt_tmp" rename to "credit_score_balance_ctry"
[0m16:09:54.881461 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:09:54.882757 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.883945 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:09:54.884089 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.884234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.884386 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:09:54.885507 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:09:54.886304 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: COMMIT
[0m16:09:54.886436 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:54.886627 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:09:54.886807 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.888170 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.888318 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:54.888530 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: COMMIT
[0m16:09:54.888695 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:09:54.889418 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:09:54.835839 => 16:09:54.889325
[0m16:09:54.889570 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:54.889849 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:09:54.890646 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:09:54.846169 => 16:09:54.890562
[0m16:09:54.890796 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.890937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.891316 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af0210>]}
[0m16:09:54.891469 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m16:09:54.892269 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:09:54.893635 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.credit_score_balance_ctry"
[0m16:09:54.893941 [info ] [Thread-4 (]: 3 of 7 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:09:54.894359 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a57bd0>]}
[0m16:09:54.894520 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.894711 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.credit_score_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."credit_score_balance_ctry__dbt_backup" cascade
[0m16:09:54.894980 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:09:54.895384 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:09:54.895223 [info ] [Thread-3 (]: 4 of 7 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.07s]
[0m16:09:54.895697 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m16:09:54.896054 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m16:09:54.896425 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:54.896268 [info ] [Thread-4 (]: 7 of 7 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m16:09:54.896683 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.897451 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.credit_score_balance_ctry (execute): 16:09:54.857483 => 16:09:54.897369
[0m16:09:54.897753 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.total_salaries)
[0m16:09:54.898792 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:09:54.898957 [debug] [Thread-1 (]: On model.maker_warehouse.credit_score_balance_ctry: Close
[0m16:09:54.899120 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:09:54.899276 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:09:54.899601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac5c90>]}
[0m16:09:54.900924 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:09:54.901278 [info ] [Thread-1 (]: 5 of 7 OK created sql view model bank_warehouse.credit_score_balance_ctry ...... [[32mCREATE VIEW[0m in 0.05s]
[0m16:09:54.901643 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.credit_score_balance_ctry
[0m16:09:54.901800 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:54.902549 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:09:54.855196 => 16:09:54.902477
[0m16:09:54.902706 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:09:54.902870 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:09:54.899700 => 16:09:54.902787
[0m16:09:54.903209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aab2d0>]}
[0m16:09:54.903357 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:09:54.903591 [info ] [Thread-2 (]: 6 of 7 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.05s]
[0m16:09:54.905756 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:09:54.906088 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:09:54.906475 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:09:54.906632 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:09:54.906773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:54.915273 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.915568 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:09:54.915738 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:09:54.918666 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:54.920230 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:09:54.920404 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:09:54.921241 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:54.922143 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:09:54.922336 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:09:54.922483 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:09:54.923788 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.926060 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:09:54.926234 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:09:54.926875 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:54.927521 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:09:54.903741 => 16:09:54.927442
[0m16:09:54.927682 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m16:09:54.928027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faead096-17c6-4677-b581-9126db4cdea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d89950>]}
[0m16:09:54.928277 [info ] [Thread-4 (]: 7 of 7 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.03s]
[0m16:09:54.928545 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:09:54.929273 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.929406 [debug] [MainThread]: On master: BEGIN
[0m16:09:54.929515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:54.937346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:54.937595 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.937722 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.937837 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.938386 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:54.938525 [debug] [MainThread]: On master: Close
[0m16:09:54.938832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:54.938949 [debug] [MainThread]: Connection 'model.maker_warehouse.credit_score_balance_ctry' was properly closed.
[0m16:09:54.939050 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:09:54.939146 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m16:09:54.939240 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m16:09:54.939392 [info ] [MainThread]: 
[0m16:09:54.939561 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:09:54.940189 [debug] [MainThread]: Command end result
[0m16:09:54.943345 [info ] [MainThread]: 
[0m16:09:54.943611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:54.943831 [info ] [MainThread]: 
[0m16:09:54.944024 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:09:54.944336 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:54.944291 after 0.52 seconds
[0m16:09:54.944502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002a2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10035a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100358d50>]}
[0m16:09:54.944657 [debug] [MainThread]: Flushing usage events
[0m16:10:49.240446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106322610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106322e10>]}


============================== 16:10:49.243122 | 60e57575-f17e-4184-bf1d-8dce5c930c39 ==============================
[0m16:10:49.243122 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:10:49.243491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:10:49.282165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632b110>]}
[0m16:10:49.288653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632b110>]}
[0m16:10:49.289031 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:10:49.300470 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:10:49.319229 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:10:49.319543 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/creditscore_balance_ctry.sql
[0m16:10:49.319723 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/summaries/credit_score_balance_ctry.sql
[0m16:10:49.331776 [debug] [MainThread]: 1699: static parser successfully parsed summaries/creditscore_balance_ctry.sql
[0m16:10:49.365196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab4d10>]}
[0m16:10:49.368440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0350>]}
[0m16:10:49.368652 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:10:49.368835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c5a10>]}
[0m16:10:49.369623 [info ] [MainThread]: 
[0m16:10:49.369986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:49.370548 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:10:49.375735 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:10:49.375979 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:10:49.376108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:49.447026 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:10:49.447993 [debug] [ThreadPool]: On list_mydb: Close
[0m16:10:49.449041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:10:49.452533 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:10:49.452765 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:10:49.452913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:49.462075 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.462319 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:10:49.462492 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:10:49.470551 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:10:49.471521 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:10:49.472227 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:10:49.475657 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.475873 [debug] [MainThread]: On master: BEGIN
[0m16:10:49.476019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:49.485711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.485961 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.486196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:49.505360 [debug] [MainThread]: SQL status: SELECT 29 in 0.0 seconds
[0m16:10:49.507587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a3e50>]}
[0m16:10:49.507863 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:49.508654 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.508820 [debug] [MainThread]: On master: BEGIN
[0m16:10:49.509963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.510146 [debug] [MainThread]: On master: COMMIT
[0m16:10:49.510305 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.510449 [debug] [MainThread]: On master: COMMIT
[0m16:10:49.511076 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.511248 [debug] [MainThread]: On master: Close
[0m16:10:49.511653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:49.511883 [info ] [MainThread]: 
[0m16:10:49.515429 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:10:49.515674 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:10:49.515986 [info ] [Thread-1 (]: 1 of 7 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m16:10:49.516340 [info ] [Thread-2 (]: 2 of 7 START sql table model bank_warehouse.customers .......................... [RUN]
[0m16:10:49.516821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:10:49.517214 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:10:49.517406 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:10:49.517603 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:10:49.519493 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:10:49.521086 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:10:49.521903 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:10:49.517751 => 16:10:49.521791
[0m16:10:49.522124 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:10:49.519652 => 16:10:49.522020
[0m16:10:49.522329 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:10:49.522525 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:10:49.543025 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:10:49.545719 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:10:49.546128 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.546317 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.546467 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:10:49.546617 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:10:49.546752 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:49.546882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:49.556474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.556837 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.557049 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:10:49.557816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.558040 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.558223 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:10:49.575863 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:10:49.579824 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.580041 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:10:49.580262 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:10:49.581850 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.582087 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:10:49.583057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.583240 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.584710 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.586212 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.586391 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:10:49.586579 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:10:49.587414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.587577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.598336 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:10:49.599493 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:10:49.599676 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.599833 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.599984 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:10:49.600131 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:10:49.606599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.606809 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.609865 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:10:49.611097 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:10:49.611277 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:10:49.611443 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:10:49.620070 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:10:49.621020 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:10:49.543216 => 16:10:49.620917
[0m16:10:49.621223 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:10:49.621654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b0690>]}
[0m16:10:49.622007 [info ] [Thread-2 (]: 2 of 7 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.10s]
[0m16:10:49.622331 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:10:49.622552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:10:49.623340 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:10:49.522649 => 16:10:49.623251
[0m16:10:49.623663 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:10:49.623880 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m16:10:49.624333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4ed90>]}
[0m16:10:49.624668 [info ] [Thread-4 (]: 3 of 7 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m16:10:49.625175 [info ] [Thread-1 (]: 1 of 7 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.11s]
[0m16:10:49.625617 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.total_salaries'
[0m16:10:49.625941 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:10:49.626148 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:10:49.628486 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:10:49.628737 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m16:10:49.628903 [debug] [Thread-3 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:10:49.629050 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:10:49.629349 [info ] [Thread-2 (]: 4 of 7 START sql view model bank_warehouse.creditscore_balance_ctry ............ [RUN]
[0m16:10:49.629642 [info ] [Thread-3 (]: 5 of 7 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m16:10:49.629951 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:10:49.626782 => 16:10:49.629858
[0m16:10:49.630139 [info ] [Thread-1 (]: 6 of 7 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m16:10:49.630513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m16:10:49.630846 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m16:10:49.631007 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:10:49.631319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.salary_vs_cardtype)
[0m16:10:49.631498 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m16:10:49.631655 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:10:49.641375 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:10:49.641768 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:10:49.643296 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.644487 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:10:49.645728 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.646042 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:10:49.646344 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 16:10:49.641918 => 16:10:49.646251
[0m16:10:49.646497 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:10:49.646659 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:10:49.643447 => 16:10:49.646584
[0m16:10:49.646824 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m16:10:49.647008 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:10:49.644679 => 16:10:49.646932
[0m16:10:49.647124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:49.647270 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:10:49.650082 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.650246 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:10:49.652196 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:10:49.654175 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.654683 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.654923 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:10:49.655073 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m16:10:49.655249 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:10:49.655433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:49.655584 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.655753 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:10:49.656057 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:10:49.656354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:49.659794 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.660045 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:10:49.660206 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:10:49.664141 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:10:49.665984 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:10:49.666157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.666315 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.666460 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.666624 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:10:49.666788 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.666934 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:10:49.667077 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.667268 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:10:49.667464 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:10:49.667646 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:10:49.667787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.669154 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:10:49.669371 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:10:49.669522 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:10:49.670650 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.671826 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:10:49.671990 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:10:49.672325 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:10:49.673936 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:10:49.674130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:10:49.674285 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:49.674423 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:10:49.674587 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:10:49.675987 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.676605 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:10:49.631771 => 16:10:49.676523
[0m16:10:49.677944 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.678152 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:10:49.678348 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m16:10:49.678526 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m16:10:49.678933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b74750>]}
[0m16:10:49.679086 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.679516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.679371 [info ] [Thread-4 (]: 3 of 7 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.05s]
[0m16:10:49.680596 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:10:49.680749 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.681533 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:10:49.681779 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:10:49.681935 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:10:49.682693 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:10:49.682840 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.683033 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_balance
[0m16:10:49.683232 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:10:49.683371 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.683500 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:10:49.683675 [info ] [Thread-4 (]: 7 of 7 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m16:10:49.683899 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:10:49.684257 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_salaries, now model.maker_warehouse.total_balance)
[0m16:10:49.684760 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:10:49.686307 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:10:49.686497 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.686642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.686769 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.687834 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:10:49.688912 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:10:49.689906 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:10:49.690093 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:10:49.684872 => 16:10:49.690014
[0m16:10:49.690253 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:10:49.690417 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:10:49.690570 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m16:10:49.690728 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_balance
[0m16:10:49.692908 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:10:49.693089 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:49.693264 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:49.693396 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:49.694078 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 16:10:49.647379 => 16:10:49.694001
[0m16:10:49.694698 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:10:49.652392 => 16:10:49.694625
[0m16:10:49.695251 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:10:49.650423 => 16:10:49.695180
[0m16:10:49.695415 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m16:10:49.695560 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:10:49.695707 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:10:49.695855 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:10:49.696020 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:10:49.696322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03c90>]}
[0m16:10:49.696665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b0b10>]}
[0m16:10:49.696896 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:49.697164 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0590>]}
[0m16:10:49.697489 [info ] [Thread-2 (]: 4 of 7 OK created sql view model bank_warehouse.creditscore_balance_ctry ....... [[32mCREATE VIEW[0m in 0.07s]
[0m16:10:49.698109 [info ] [Thread-1 (]: 6 of 7 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.07s]
[0m16:10:49.698764 [info ] [Thread-3 (]: 5 of 7 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.07s]
[0m16:10:49.699268 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m16:10:49.699514 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:10:49.699721 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:10:49.707356 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.707667 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:10:49.707828 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:10:49.710819 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:10:49.712310 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:10:49.712472 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:10:49.713182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:49.713950 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:10:49.714090 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:10:49.714222 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:10:49.715192 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.717436 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:10:49.717627 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:10:49.718236 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:49.718883 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:10:49.690912 => 16:10:49.718804
[0m16:10:49.719035 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: Close
[0m16:10:49.719361 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e57575-f17e-4184-bf1d-8dce5c930c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdc250>]}
[0m16:10:49.719610 [info ] [Thread-4 (]: 7 of 7 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.04s]
[0m16:10:49.719872 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_balance
[0m16:10:49.720631 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.720770 [debug] [MainThread]: On master: BEGIN
[0m16:10:49.720876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:49.728586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:49.728852 [debug] [MainThread]: On master: COMMIT
[0m16:10:49.728980 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:49.729093 [debug] [MainThread]: On master: COMMIT
[0m16:10:49.729572 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:49.729728 [debug] [MainThread]: On master: Close
[0m16:10:49.730041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:49.730161 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:10:49.730262 [debug] [MainThread]: Connection 'model.maker_warehouse.creditscore_balance_ctry' was properly closed.
[0m16:10:49.730356 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m16:10:49.730450 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m16:10:49.730601 [info ] [MainThread]: 
[0m16:10:49.730770 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:10:49.731388 [debug] [MainThread]: Command end result
[0m16:10:49.734363 [info ] [MainThread]: 
[0m16:10:49.734568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:49.734824 [info ] [MainThread]: 
[0m16:10:49.734998 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:10:49.735285 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:49.735242 after 0.51 seconds
[0m16:10:49.735454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029d2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a8a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a88d50>]}
[0m16:10:49.735609 [debug] [MainThread]: Flushing usage events
[0m16:23:04.778491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdbdd0>]}


============================== 16:23:04.780948 | a0a71f2f-2340-440f-af77-ec858d5e4a62 ==============================
[0m16:23:04.780948 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:23:04.781268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:23:04.819451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bef810>]}
[0m16:23:04.826089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104847750>]}
[0m16:23:04.826484 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:23:04.837154 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:23:04.857863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:23:04.858270 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/satisfaction_vs_num_products.sql
[0m16:23:04.868739 [debug] [MainThread]: 1699: static parser successfully parsed summaries/satisfaction_vs_num_products.sql
[0m16:23:04.900089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105befd10>]}
[0m16:23:04.903401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256c50>]}
[0m16:23:04.903620 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:23:04.903807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103985c90>]}
[0m16:23:04.904686 [info ] [MainThread]: 
[0m16:23:04.905095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:04.905715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:23:04.910519 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:23:04.910719 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:23:04.910854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:04.974004 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:23:04.974908 [debug] [ThreadPool]: On list_mydb: Close
[0m16:23:04.975938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:23:04.979231 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:23:04.979406 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:23:04.979547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:04.993200 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:23:04.993407 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:23:04.993576 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:23:05.002829 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:23:05.003776 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:23:05.004467 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:23:05.007910 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.008148 [debug] [MainThread]: On master: BEGIN
[0m16:23:05.008304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:05.017182 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.017409 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.017631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:05.035373 [debug] [MainThread]: SQL status: SELECT 29 in 0.0 seconds
[0m16:23:05.037583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a91cd0>]}
[0m16:23:05.037869 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:05.038617 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.038829 [debug] [MainThread]: On master: BEGIN
[0m16:23:05.040009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.040189 [debug] [MainThread]: On master: COMMIT
[0m16:23:05.040353 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.040500 [debug] [MainThread]: On master: COMMIT
[0m16:23:05.041175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.041397 [debug] [MainThread]: On master: Close
[0m16:23:05.041829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:23:05.042070 [info ] [MainThread]: 
[0m16:23:05.045567 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:23:05.045806 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:23:05.046113 [info ] [Thread-1 (]: 1 of 8 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m16:23:05.046469 [info ] [Thread-2 (]: 2 of 8 START sql table model bank_warehouse.customers .......................... [RUN]
[0m16:23:05.046963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:23:05.047381 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:23:05.047584 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:23:05.047774 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:23:05.049673 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:23:05.051187 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:23:05.051841 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:23:05.047906 => 16:23:05.051721
[0m16:23:05.052100 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:23:05.049828 => 16:23:05.051972
[0m16:23:05.052284 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:23:05.052473 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:23:05.074531 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:23:05.076641 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:23:05.077057 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.077235 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.077398 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:23:05.077548 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:23:05.077689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:05.077822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:23:05.086172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.086480 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.086659 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:23:05.088006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.088303 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.088543 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:23:05.107559 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:23:05.111549 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.111784 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:23:05.111983 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:23:05.113646 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.113831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.114031 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:23:05.115583 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.115822 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:23:05.117244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.117426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.119109 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.129941 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:23:05.130159 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:23:05.130337 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.130533 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:23:05.131475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.131645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.132737 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:23:05.135411 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:23:05.135604 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.135785 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:23:05.135973 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:23:05.136903 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.138151 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:23:05.138322 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:23:05.144409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:23:05.145310 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:23:05.052603 => 16:23:05.145206
[0m16:23:05.145506 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:23:05.145931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca0410>]}
[0m16:23:05.146292 [info ] [Thread-1 (]: 1 of 8 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.10s]
[0m16:23:05.146654 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:23:05.147180 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:23:05.147404 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m16:23:05.147684 [info ] [Thread-4 (]: 3 of 8 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m16:23:05.148084 [info ] [Thread-3 (]: 4 of 8 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m16:23:05.148700 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m16:23:05.148888 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:23:05.149258 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m16:23:05.149441 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:23:05.150224 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:23:05.074682 => 16:23:05.150132
[0m16:23:05.150425 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:23:05.152390 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:23:05.152750 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:23:05.154497 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:23:05.155100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637e010>]}
[0m16:23:05.155946 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:23:05.150567 => 16:23:05.155817
[0m16:23:05.156176 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:23:05.152912 => 16:23:05.156079
[0m16:23:05.155701 [info ] [Thread-2 (]: 2 of 8 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m16:23:05.156434 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:23:05.156629 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m16:23:05.156878 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:23:05.166081 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:23:05.168013 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:23:05.168368 [debug] [Thread-1 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m16:23:05.168593 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:23:05.169353 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:23:05.169108 [info ] [Thread-1 (]: 5 of 8 START sql view model bank_warehouse.creditscore_balance_ctry ............ [RUN]
[0m16:23:05.169746 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:23:05.169544 [info ] [Thread-2 (]: 6 of 8 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m16:23:05.169951 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:23:05.170285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.creditscore_balance_ctry)
[0m16:23:05.170456 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:23:05.170744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.salary_vs_cardtype)
[0m16:23:05.170893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:23:05.171044 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m16:23:05.171180 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:23:05.171316 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:23:05.174183 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.176012 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.176611 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:23:05.174510 => 16:23:05.176483
[0m16:23:05.176781 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:23:05.178803 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.179002 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 16:23:05.171544 => 16:23:05.178907
[0m16:23:05.179248 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m16:23:05.181225 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.181405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.181658 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:23:05.181826 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.182013 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:23:05.182171 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.182373 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:23:05.182556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.182728 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m16:23:05.182879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:05.183029 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:23:05.183176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:05.183406 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:23:05.187439 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.187709 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.189404 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:23:05.190818 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:23:05.191066 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:23:05.191251 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:23:05.192469 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.192644 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.193730 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:23:05.194053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.194205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.194951 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:23:05.195107 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:23:05.195249 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.195384 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.195518 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:23:05.195644 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:23:05.195786 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:23:05.195940 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:23:05.196080 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:23:05.197204 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.197373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.198482 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:23:05.199570 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:23:05.199744 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:23:05.199911 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:23:05.200868 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.201580 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:23:05.166253 => 16:23:05.201496
[0m16:23:05.201723 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.201880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.202047 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.202249 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m16:23:05.203918 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.205351 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.205956 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:23:05.157002 => 16:23:05.205877
[0m16:23:05.206332 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106464d90>]}
[0m16:23:05.206523 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:23:05.206728 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m16:23:05.206888 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:23:05.207144 [info ] [Thread-3 (]: 4 of 8 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:05.207704 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca1410>]}
[0m16:23:05.207965 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m16:23:05.208219 [info ] [Thread-4 (]: 3 of 8 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:05.208543 [debug] [Thread-3 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:23:05.208976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.209232 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:23:05.209393 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.209603 [info ] [Thread-3 (]: 7 of 8 START sql view model bank_warehouse.satisfaction_vs_num_products ........ [RUN]
[0m16:23:05.210591 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:23:05.210806 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m16:23:05.211646 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:23:05.211944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.satisfaction_vs_num_products)
[0m16:23:05.212103 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.212290 [info ] [Thread-4 (]: 8 of 8 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m16:23:05.212489 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.212633 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m16:23:05.212771 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:23:05.213019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.total_salaries)
[0m16:23:05.213182 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:23:05.214698 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.214910 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:23:05.216185 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:23:05.216442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.217554 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:23:05.217725 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.217922 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m16:23:05.218099 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:23:05.215142 => 16:23:05.218022
[0m16:23:05.218265 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 16:23:05.213326 => 16:23:05.218182
[0m16:23:05.219380 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:23:05.219625 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:23:05.219791 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m16:23:05.219955 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:23:05.223141 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:23:05.223366 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.225354 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.226186 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 16:23:05.179355 => 16:23:05.226103
[0m16:23:05.226331 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.226572 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m16:23:05.226731 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:23:05.226944 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.227513 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:23:05.176917 => 16:23:05.227441
[0m16:23:05.227869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3850>]}
[0m16:23:05.228027 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:23:05.228198 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m16:23:05.228352 [debug] [Thread-2 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:23:05.228596 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bank_warehouse.creditscore_balance_ctry ....... [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:05.228788 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:05.228940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:23:05.229184 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m16:23:05.229497 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106497210>]}
[0m16:23:05.229994 [info ] [Thread-2 (]: 6 of 8 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:05.230287 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:23:05.237920 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.238140 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.238355 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.238542 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:23:05.238729 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m16:23:05.238900 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:23:05.242411 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.243875 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:23:05.244042 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:23:05.244196 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:23:05.245572 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.245725 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.245862 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m16:23:05.246646 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:23:05.246829 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:23:05.246968 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:23:05.247477 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:05.248282 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:23:05.248434 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.248577 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.249678 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:23:05.249828 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:23:05.249982 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:23:05.250669 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.251274 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:23:05.220070 => 16:23:05.251198
[0m16:23:05.251410 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.251568 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m16:23:05.252631 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:23:05.253056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457e50>]}
[0m16:23:05.253273 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m16:23:05.253591 [info ] [Thread-4 (]: 8 of 8 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.04s]
[0m16:23:05.253926 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:23:05.254642 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:23:05.255516 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 16:23:05.223479 => 16:23:05.255425
[0m16:23:05.255696 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m16:23:05.256039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a71f2f-2340-440f-af77-ec858d5e4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9b090>]}
[0m16:23:05.256294 [info ] [Thread-3 (]: 7 of 8 OK created sql view model bank_warehouse.satisfaction_vs_num_products ... [[32mCREATE VIEW[0m in 0.04s]
[0m16:23:05.256677 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:23:05.257506 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.257682 [debug] [MainThread]: On master: BEGIN
[0m16:23:05.257797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:05.264774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:05.265042 [debug] [MainThread]: On master: COMMIT
[0m16:23:05.265188 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:05.265309 [debug] [MainThread]: On master: COMMIT
[0m16:23:05.265841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:23:05.265970 [debug] [MainThread]: On master: Close
[0m16:23:05.266260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:05.266375 [debug] [MainThread]: Connection 'model.maker_warehouse.creditscore_balance_ctry' was properly closed.
[0m16:23:05.266474 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:23:05.266566 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m16:23:05.266660 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m16:23:05.266826 [info ] [MainThread]: 
[0m16:23:05.267015 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:23:05.267678 [debug] [MainThread]: Command end result
[0m16:23:05.270769 [info ] [MainThread]: 
[0m16:23:05.271020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:05.271203 [info ] [MainThread]: 
[0m16:23:05.271417 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:23:05.271786 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:05.271722 after 0.51 seconds
[0m16:23:05.272000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102292250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023f3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023f1250>]}
[0m16:23:05.272183 [debug] [MainThread]: Flushing usage events
[0m16:28:07.518011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047167d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104716fd0>]}


============================== 16:28:07.520615 | 34c95a6c-2a48-4edd-9bd3-00e515e3efe0 ==============================
[0m16:28:07.520615 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:28:07.520948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:28:07.558175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471f490>]}
[0m16:28:07.564662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471f490>]}
[0m16:28:07.565029 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:28:07.575717 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:28:07.595256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:28:07.595583 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/customers_by_ctry.sql
[0m16:28:07.607051 [debug] [MainThread]: 1699: static parser successfully parsed summaries/customers_by_ctry.sql
[0m16:28:07.637333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799650>]}
[0m16:28:07.640558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fe950>]}
[0m16:28:07.640769 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:28:07.640958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b99d0>]}
[0m16:28:07.641794 [info ] [MainThread]: 
[0m16:28:07.642160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:07.642762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:28:07.647351 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:28:07.647530 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:28:07.647666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:07.720664 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:28:07.721701 [debug] [ThreadPool]: On list_mydb: Close
[0m16:28:07.722879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:28:07.726611 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:28:07.726807 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:28:07.726959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:07.737611 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.737946 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:28:07.738170 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:28:07.746280 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m16:28:07.747289 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:28:07.748063 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:28:07.751879 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:07.752111 [debug] [MainThread]: On master: BEGIN
[0m16:28:07.752285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:07.762720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.762985 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:07.763256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:07.785224 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m16:28:07.787732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da7f10>]}
[0m16:28:07.788039 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:07.788922 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:07.789181 [debug] [MainThread]: On master: BEGIN
[0m16:28:07.790478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.790688 [debug] [MainThread]: On master: COMMIT
[0m16:28:07.790868 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:07.791033 [debug] [MainThread]: On master: COMMIT
[0m16:28:07.791706 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.791938 [debug] [MainThread]: On master: Close
[0m16:28:07.792427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:07.792702 [info ] [MainThread]: 
[0m16:28:07.796677 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:28:07.796974 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:28:07.797347 [info ] [Thread-1 (]: 1 of 9 START sql table model bank_warehouse.accounts ........................... [RUN]
[0m16:28:07.797734 [info ] [Thread-2 (]: 2 of 9 START sql table model bank_warehouse.customers .......................... [RUN]
[0m16:28:07.798489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:28:07.799097 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:28:07.799394 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:28:07.799630 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:28:07.801817 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:28:07.803718 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:28:07.804400 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:28:07.802035 => 16:28:07.804236
[0m16:28:07.804690 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:28:07.799780 => 16:28:07.804550
[0m16:28:07.804943 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:28:07.805194 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:28:07.827767 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:28:07.829976 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:28:07.830396 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.830582 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.830772 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:28:07.830972 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:28:07.831147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:28:07.831302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:07.840248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.840487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.840708 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.840907 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.841119 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:28:07.841307 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:28:07.861216 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:28:07.865224 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.865444 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:28:07.865666 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:28:07.867369 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.867656 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:28:07.868581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.868763 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.870220 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.871690 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.871871 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:28:07.872045 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:28:07.872892 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.873057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.883751 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:28:07.884860 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:28:07.885036 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.885194 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.885340 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:28:07.885482 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:28:07.892296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.892526 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.895717 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:28:07.897029 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:28:07.897214 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:28:07.897386 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:28:07.906484 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:28:07.907324 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:28:07.805352 => 16:28:07.907226
[0m16:28:07.907519 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:28:07.907915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e839d0>]}
[0m16:28:07.908247 [info ] [Thread-2 (]: 2 of 9 OK created sql table model bank_warehouse.customers ..................... [[32mSELECT 10000[0m in 0.11s]
[0m16:28:07.908575 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:28:07.909235 [debug] [Thread-4 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:28:07.909448 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_salaries
[0m16:28:07.909715 [info ] [Thread-4 (]: 3 of 9 START sql view model bank_warehouse.satisfaction_vs_num_products ........ [RUN]
[0m16:28:07.910004 [info ] [Thread-3 (]: 4 of 9 START sql view model bank_warehouse.total_salaries ...................... [RUN]
[0m16:28:07.910879 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.satisfaction_vs_num_products'
[0m16:28:07.911327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_salaries'
[0m16:28:07.911559 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m16:28:07.911757 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:28:07.913694 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.913984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:28:07.915541 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:28:07.916449 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:28:07.827925 => 16:28:07.916352
[0m16:28:07.916738 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:28:07.917180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8ba50>]}
[0m16:28:07.917459 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 16:28:07.911908 => 16:28:07.917346
[0m16:28:07.917999 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:28:07.914147 => 16:28:07.917899
[0m16:28:07.917787 [info ] [Thread-1 (]: 1 of 9 OK created sql table model bank_warehouse.accounts ...................... [[32mSELECT 10000[0m in 0.12s]
[0m16:28:07.918257 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m16:28:07.918464 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:28:07.918749 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:28:07.928711 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.931578 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:28:07.931942 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m16:28:07.932100 [debug] [Thread-1 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m16:28:07.932411 [info ] [Thread-2 (]: 5 of 9 START sql view model bank_warehouse.creditscore_balance_ctry ............ [RUN]
[0m16:28:07.932745 [info ] [Thread-1 (]: 6 of 9 START sql view model bank_warehouse.customers_by_ctry ................... [RUN]
[0m16:28:07.932986 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.933144 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:28:07.933457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m16:28:07.933731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.customers_by_ctry)
[0m16:28:07.933889 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m16:28:07.934034 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:28:07.934178 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m16:28:07.934323 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m16:28:07.934460 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:28:07.934594 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:28:07.936030 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.937653 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.938571 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 16:28:07.934705 => 16:28:07.938449
[0m16:28:07.938774 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 16:28:07.936201 => 16:28:07.938675
[0m16:28:07.938947 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m16:28:07.939182 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m16:28:07.941444 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.943467 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.943912 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.944088 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.944231 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m16:28:07.944392 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m16:28:07.944540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:28:07.944687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:07.946538 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.946799 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.946961 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.947161 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m16:28:07.947481 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:28:07.947702 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:28:07.952345 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:07.954292 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:28:07.954482 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:07.954713 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:28:07.956220 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.956379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.956530 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:07.956742 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m16:28:07.956900 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.957075 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.957287 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:28:07.957430 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.957588 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:28:07.958467 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:28:07.958637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.958801 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:28:07.959595 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:28:07.959753 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:28:07.959916 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.960101 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:28:07.960917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.962141 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:28:07.962293 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.962426 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:07.962576 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:28:07.963682 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:28:07.963828 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:07.965038 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.965230 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m16:28:07.966569 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.966717 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:07.966868 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m16:28:07.967050 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m16:28:07.967698 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:28:07.928913 => 16:28:07.967617
[0m16:28:07.967867 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:07.968087 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: Close
[0m16:28:07.968757 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 16:28:07.918888 => 16:28:07.968672
[0m16:28:07.968919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.969149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:07.969356 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m16:28:07.969694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f44210>]}
[0m16:28:07.970496 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:28:07.971262 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:28:07.971637 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e05650>]}
[0m16:28:07.971973 [info ] [Thread-3 (]: 4 of 9 OK created sql view model bank_warehouse.total_salaries ................. [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:07.972238 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.972430 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.972669 [info ] [Thread-4 (]: 3 of 9 OK created sql view model bank_warehouse.satisfaction_vs_num_products ... [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:07.973041 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:28:07.973212 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:28:07.973452 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:28:07.973666 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:28:07.973876 [debug] [Thread-3 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:28:07.974165 [debug] [Thread-4 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:28:07.974394 [info ] [Thread-3 (]: 7 of 9 START sql view model bank_warehouse.most_popular_card ................... [RUN]
[0m16:28:07.974732 [info ] [Thread-4 (]: 8 of 9 START sql view model bank_warehouse.salary_vs_cardtype .................. [RUN]
[0m16:28:07.974945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.975263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_salaries, now model.maker_warehouse.most_popular_card)
[0m16:28:07.975535 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.satisfaction_vs_num_products, now model.maker_warehouse.salary_vs_cardtype)
[0m16:28:07.975661 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:07.976927 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:28:07.977078 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:28:07.977209 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:28:07.978219 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:28:07.978405 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m16:28:07.979679 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:28:07.980831 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:07.980995 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m16:28:07.981613 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:28:07.978516 => 16:28:07.981519
[0m16:28:07.981766 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:07.981929 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:28:07.979797 => 16:28:07.981851
[0m16:28:07.982068 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:07.982195 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:28:07.982823 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 16:28:07.941611 => 16:28:07.982754
[0m16:28:07.982971 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:28:07.983577 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 16:28:07.939453 => 16:28:07.983500
[0m16:28:07.986709 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:28:07.987023 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m16:28:07.989103 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:07.989269 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m16:28:07.989686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fba1d0>]}
[0m16:28:07.990001 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:28:07.990159 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:07.990505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4910>]}
[0m16:28:07.990782 [info ] [Thread-1 (]: 6 of 9 OK created sql view model bank_warehouse.customers_by_ctry .............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:07.991010 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:28:07.991293 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:28:07.991540 [info ] [Thread-2 (]: 5 of 9 OK created sql view model bank_warehouse.creditscore_balance_ctry ....... [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:07.991895 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m16:28:07.992066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:28:07.992242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:28:07.992480 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m16:28:07.992667 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_balance
[0m16:28:07.993082 [info ] [Thread-1 (]: 9 of 9 START sql view model bank_warehouse.total_balance ....................... [RUN]
[0m16:28:07.993462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_by_ctry, now model.maker_warehouse.total_balance)
[0m16:28:07.993631 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:28:07.994988 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:28:07.995556 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:28:07.993740 => 16:28:07.995459
[0m16:28:07.995712 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_balance
[0m16:28:07.997857 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:28:07.998201 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:28:07.998346 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:28:07.998484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:08.001528 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:08.001832 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:28:08.002003 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:28:08.003265 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:08.003533 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:08.003704 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:28:08.006599 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:08.008320 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:28:08.008531 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:28:08.009034 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:08.010521 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:08.010714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:08.010852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:08.010995 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:28:08.011155 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:28:08.011910 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:28:08.012104 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:28:08.012277 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:28:08.012461 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:28:08.012901 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:08.013697 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:28:08.013854 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:08.013991 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:28:08.014141 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:08.015304 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:28:08.015461 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:08.015645 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:28:08.015792 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:08.016854 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:28:08.018260 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:28:08.018448 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:08.018656 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:28:08.018840 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:28:08.019632 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:28:07.983703 => 16:28:08.019542
[0m16:28:08.019894 [debug] [Thread-3 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:28:08.020269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f97ed0>]}
[0m16:28:08.020547 [info ] [Thread-3 (]: 7 of 9 OK created sql view model bank_warehouse.most_popular_card .............. [[32mCREATE VIEW[0m in 0.05s]
[0m16:28:08.020838 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:28:08.021027 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:08.021224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:08.021923 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:28:07.987142 => 16:28:08.021844
[0m16:28:08.022712 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:28:08.022877 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:28:08.023022 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:28:08.023341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d74ad0>]}
[0m16:28:08.023492 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:28:08.023790 [info ] [Thread-4 (]: 8 of 9 OK created sql view model bank_warehouse.salary_vs_cardtype ............. [[32mCREATE VIEW[0m in 0.05s]
[0m16:28:08.024057 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:28:08.024676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:08.025978 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:28:08.026136 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:28:08.026712 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:08.027341 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:28:07.995811 => 16:28:08.027265
[0m16:28:08.027483 [debug] [Thread-1 (]: On model.maker_warehouse.total_balance: Close
[0m16:28:08.027788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c95a6c-2a48-4edd-9bd3-00e515e3efe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9f2d0>]}
[0m16:28:08.028045 [info ] [Thread-1 (]: 9 of 9 OK created sql view model bank_warehouse.total_balance .................. [[32mCREATE VIEW[0m in 0.03s]
[0m16:28:08.028329 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_balance
[0m16:28:08.029041 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:08.029166 [debug] [MainThread]: On master: BEGIN
[0m16:28:08.029274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:08.036363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:08.036665 [debug] [MainThread]: On master: COMMIT
[0m16:28:08.036809 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:08.036929 [debug] [MainThread]: On master: COMMIT
[0m16:28:08.037730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:08.037900 [debug] [MainThread]: On master: Close
[0m16:28:08.038206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:08.038320 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m16:28:08.038417 [debug] [MainThread]: Connection 'model.maker_warehouse.creditscore_balance_ctry' was properly closed.
[0m16:28:08.038512 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:28:08.038602 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m16:28:08.038753 [info ] [MainThread]: 
[0m16:28:08.038922 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:28:08.039659 [debug] [MainThread]: Command end result
[0m16:28:08.042543 [info ] [MainThread]: 
[0m16:28:08.042734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:08.042890 [info ] [MainThread]: 
[0m16:28:08.043050 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m16:28:08.043383 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:08.043332 after 0.54 seconds
[0m16:28:08.043572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dc6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e7e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e7cd50>]}
[0m16:28:08.043734 [debug] [MainThread]: Flushing usage events
[0m16:51:03.746525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d3310>]}


============================== 16:51:03.749132 | fde29f45-a994-4d2b-8fde-6887605b7910 ==============================
[0m16:51:03.749132 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:51:03.749474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:51:03.788274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ed210>]}
[0m16:51:03.794793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073899d0>]}
[0m16:51:03.795141 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:51:03.806306 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:51:03.830611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:51:03.830955 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/complaints.sql
[0m16:51:03.842291 [debug] [MainThread]: 1699: static parser successfully parsed summaries/complaints.sql
[0m16:51:03.873350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108965890>]}
[0m16:51:03.876850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109004ad0>]}
[0m16:51:03.877068 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:51:03.877256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106675c50>]}
[0m16:51:03.878178 [info ] [MainThread]: 
[0m16:51:03.878642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:03.879329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:51:03.884408 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:51:03.884647 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:51:03.884775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:03.953419 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:51:03.954386 [debug] [ThreadPool]: On list_mydb: Close
[0m16:51:03.955496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:51:03.958904 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:51:03.959078 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:51:03.959217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:03.969973 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:51:03.970287 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:51:03.970482 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:51:03.977569 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:51:03.978494 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:51:03.979191 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:51:03.982896 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:03.983097 [debug] [MainThread]: On master: BEGIN
[0m16:51:03.983242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:03.993194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:51:03.993446 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:03.993686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:04.014094 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m16:51:04.016521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109004ad0>]}
[0m16:51:04.016801 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:04.017653 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:04.017871 [debug] [MainThread]: On master: BEGIN
[0m16:51:04.019074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.019252 [debug] [MainThread]: On master: COMMIT
[0m16:51:04.019407 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:04.019555 [debug] [MainThread]: On master: COMMIT
[0m16:51:04.020121 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.020305 [debug] [MainThread]: On master: Close
[0m16:51:04.020728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:51:04.020961 [info ] [MainThread]: 
[0m16:51:04.023982 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:51:04.024225 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:51:04.024537 [info ] [Thread-1 (]: 1 of 10 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m16:51:04.025106 [info ] [Thread-2 (]: 2 of 10 START sql table model bank_warehouse.customers ......................... [RUN]
[0m16:51:04.025735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:51:04.026239 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:51:04.026482 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:51:04.026702 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:51:04.028804 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:51:04.030402 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:51:04.030877 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:51:04.026853 => 16:51:04.030764
[0m16:51:04.031107 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:51:04.028992 => 16:51:04.031006
[0m16:51:04.031292 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:51:04.031498 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:51:04.053731 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:51:04.055931 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:51:04.056378 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.056567 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.056724 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:51:04.056891 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:51:04.057055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:04.057205 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:51:04.065058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.065290 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.065517 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.065717 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.065912 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:51:04.066102 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:51:04.086315 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:51:04.090365 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.090581 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:51:04.090805 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:51:04.092427 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.092673 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:51:04.093874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.094042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.095584 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.097076 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.097259 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:51:04.097432 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:51:04.098309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.098489 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.109233 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:51:04.110351 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:51:04.110537 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.110692 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.110837 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:51:04.110979 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:51:04.117298 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.117544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.120744 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:51:04.122111 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:51:04.122291 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:51:04.122459 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:51:04.135597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:51:04.136508 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:51:04.031642 => 16:51:04.136405
[0m16:51:04.136713 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:51:04.137149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109070e10>]}
[0m16:51:04.137496 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.11s]
[0m16:51:04.137878 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:51:04.138437 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:51:04.138659 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m16:51:04.138945 [info ] [Thread-4 (]: 3 of 10 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m16:51:04.139311 [info ] [Thread-3 (]: 4 of 10 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m16:51:04.140055 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m16:51:04.140236 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:51:04.140624 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m16:51:04.140834 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:51:04.141709 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:51:04.053923 => 16:51:04.141605
[0m16:51:04.141975 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:51:04.143823 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:51:04.144102 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:51:04.145440 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:51:04.146081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff6d90>]}
[0m16:51:04.146457 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.12s]
[0m16:51:04.146810 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:51:04.142134 => 16:51:04.146705
[0m16:51:04.147072 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:51:04.147277 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:51:04.144241 => 16:51:04.147184
[0m16:51:04.147438 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:51:04.147709 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m16:51:04.153218 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m16:51:04.157202 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:51:04.157438 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m16:51:04.160770 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:51:04.161127 [info ] [Thread-1 (]: 5 of 10 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m16:51:04.161459 [info ] [Thread-2 (]: 6 of 10 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m16:51:04.161867 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:51:04.162214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m16:51:04.162529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m16:51:04.162701 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:51:04.162849 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:51:04.162996 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m16:51:04.163137 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m16:51:04.163270 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:51:04.163405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:51:04.164633 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m16:51:04.165931 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.166085 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:51:04.166603 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 16:51:04.163502 => 16:51:04.166520
[0m16:51:04.166744 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m16:51:04.166927 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 16:51:04.164743 => 16:51:04.166840
[0m16:51:04.168918 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m16:51:04.169137 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m16:51:04.171259 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.171689 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:51:04.171853 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m16:51:04.172001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:04.172932 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.173152 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m16:51:04.173323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:51:04.179320 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.179614 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:51:04.179814 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:51:04.179985 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.180167 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:51:04.180313 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:51:04.185360 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.185590 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.187405 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:51:04.187593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.187772 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.189309 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:51:04.189510 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:51:04.189676 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:51:04.189827 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.189982 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:51:04.190238 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS total_balance,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m16:51:04.190457 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:51:04.191460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.192483 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:51:04.192672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.192873 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:51:04.193795 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:51:04.193990 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:51:04.194157 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:51:04.194360 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:51:04.195559 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.196933 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:51:04.197098 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.197254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.197400 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.197573 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:51:04.198658 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:51:04.200015 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:51:04.201310 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.201520 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:51:04.201678 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m16:51:04.201842 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m16:51:04.201992 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.202722 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:51:04.157533 => 16:51:04.202641
[0m16:51:04.202862 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.203005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.203146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.203283 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m16:51:04.203891 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:51:04.147921 => 16:51:04.203816
[0m16:51:04.204652 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m16:51:04.205367 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:51:04.205725 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f9010>]}
[0m16:51:04.205887 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:51:04.206036 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:51:04.206178 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.206460 [info ] [Thread-3 (]: 4 of 10 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.07s]
[0m16:51:04.206920 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c17d0>]}
[0m16:51:04.207243 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m16:51:04.207427 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:51:04.207716 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m16:51:04.208021 [info ] [Thread-4 (]: 3 of 10 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.07s]
[0m16:51:04.208548 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m16:51:04.208881 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:51:04.209089 [info ] [Thread-3 (]: 7 of 10 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m16:51:04.209399 [debug] [Thread-4 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:51:04.209595 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.209899 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.customers_by_ctry)
[0m16:51:04.210037 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.210237 [info ] [Thread-4 (]: 8 of 10 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m16:51:04.211575 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:51:04.211733 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m16:51:04.212755 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:51:04.213009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.salary_vs_cardtype)
[0m16:51:04.213172 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m16:51:04.214518 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.214684 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m16:51:04.214834 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:51:04.216455 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.216628 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.216760 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.217487 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 16:51:04.167027 => 16:51:04.217408
[0m16:51:04.217655 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 16:51:04.213293 => 16:51:04.217576
[0m16:51:04.218257 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 16:51:04.169326 => 16:51:04.218184
[0m16:51:04.218411 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:51:04.215273 => 16:51:04.218344
[0m16:51:04.218564 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m16:51:04.218715 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m16:51:04.218850 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m16:51:04.218986 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:51:04.221921 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.222273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917c090>]}
[0m16:51:04.222632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917ce10>]}
[0m16:51:04.224837 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.225419 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.06s]
[0m16:51:04.225963 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.225776 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.06s]
[0m16:51:04.226291 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m16:51:04.226463 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m16:51:04.226681 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m16:51:04.226827 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.226999 [debug] [Thread-1 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:51:04.227175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:51:04.227346 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m16:51:04.227512 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:51:04.227722 [info ] [Thread-1 (]: 9 of 10 START sql view model bank_warehouse.satisfaction_vs_num_products ....... [RUN]
[0m16:51:04.228048 [info ] [Thread-2 (]: 10 of 10 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m16:51:04.228231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:51:04.228534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.satisfaction_vs_num_products)
[0m16:51:04.228805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.total_salaries)
[0m16:51:04.229099 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m16:51:04.229276 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:51:04.230849 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.232166 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:51:04.232736 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 16:51:04.229410 => 16:51:04.232642
[0m16:51:04.232919 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:51:04.231029 => 16:51:04.232827
[0m16:51:04.233082 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m16:51:04.233245 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:51:04.235285 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.237316 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:51:04.237520 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.237990 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.238234 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.238444 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:51:04.238659 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:51:04.238839 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m16:51:04.239086 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.239300 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:51:04.239453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:04.239606 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.239752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:51:04.240005 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:51:04.244467 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.246243 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.246433 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m16:51:04.248900 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.250546 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.250719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.250880 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.251093 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:51:04.251992 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:51:04.252154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.252320 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:51:04.252536 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.252759 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.252924 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:51:04.253089 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:51:04.253244 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m16:51:04.253763 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.254901 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:51:04.255132 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.255266 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.256524 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:51:04.257004 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:51:04.257188 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m16:51:04.258973 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.259837 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 16:51:04.219101 => 16:51:04.259748
[0m16:51:04.259997 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.260152 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.260330 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m16:51:04.261512 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:51:04.261677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:51:04.262984 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:51:04.263360 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8f810>]}
[0m16:51:04.263544 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:51:04.264911 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.265090 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:51:04.265391 [info ] [Thread-3 (]: 7 of 10 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.05s]
[0m16:51:04.265638 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m16:51:04.265951 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m16:51:04.266344 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.267035 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:51:04.222730 => 16:51:04.266956
[0m16:51:04.267174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.267315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:51:04.267475 [debug] [Thread-4 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:51:04.268208 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:51:04.268966 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:51:04.269298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109046f90>]}
[0m16:51:04.269444 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:51:04.269602 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.269854 [info ] [Thread-4 (]: 8 of 10 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.06s]
[0m16:51:04.270076 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:51:04.270235 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:51:04.270474 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:51:04.271419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.272790 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:51:04.272967 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.273109 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m16:51:04.274228 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:51:04.274513 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:51:04.275169 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.275337 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:51:04.276078 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:51:04.235448 => 16:51:04.275996
[0m16:51:04.276715 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 16:51:04.233346 => 16:51:04.276637
[0m16:51:04.276881 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: Close
[0m16:51:04.277031 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m16:51:04.277368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff4c10>]}
[0m16:51:04.277655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde29f45-a994-4d2b-8fde-6887605b7910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917cbd0>]}
[0m16:51:04.277918 [info ] [Thread-2 (]: 10 of 10 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.05s]
[0m16:51:04.278219 [info ] [Thread-1 (]: 9 of 10 OK created sql view model bank_warehouse.satisfaction_vs_num_products .. [[32mCREATE VIEW[0m in 0.05s]
[0m16:51:04.278507 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:51:04.278719 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:51:04.279634 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:04.279767 [debug] [MainThread]: On master: BEGIN
[0m16:51:04.279873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:04.286384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:51:04.286582 [debug] [MainThread]: On master: COMMIT
[0m16:51:04.286742 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:04.286856 [debug] [MainThread]: On master: COMMIT
[0m16:51:04.287348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:51:04.287486 [debug] [MainThread]: On master: Close
[0m16:51:04.287787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:04.287902 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m16:51:04.288006 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m16:51:04.288104 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:51:04.288215 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m16:51:04.288377 [info ] [MainThread]: 
[0m16:51:04.288546 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m16:51:04.289483 [debug] [MainThread]: Command end result
[0m16:51:04.294208 [info ] [MainThread]: 
[0m16:51:04.294512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:04.294673 [info ] [MainThread]: 
[0m16:51:04.294842 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:51:04.295140 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:04.295096 after 0.56 seconds
[0m16:51:04.295306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f82250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105038d50>]}
[0m16:51:04.295464 [debug] [MainThread]: Flushing usage events
[0m16:52:35.578502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106296fd0>]}


============================== 16:52:35.581034 | 1fed5bc7-7a65-432f-acbc-75eb278d1e87 ==============================
[0m16:52:35.581034 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:52:35.581389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:52:35.619191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a33d0>]}
[0m16:52:35.625898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062829d0>]}
[0m16:52:35.626482 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m16:52:35.637211 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:52:35.657408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:35.657843 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/complaints.sql
[0m16:52:35.668410 [debug] [MainThread]: 1699: static parser successfully parsed summaries/complaints.sql
[0m16:52:35.699155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2fc50>]}
[0m16:52:35.702938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c8210>]}
[0m16:52:35.703186 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:52:35.703377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403da10>]}
[0m16:52:35.704283 [info ] [MainThread]: 
[0m16:52:35.704675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:35.705313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m16:52:35.709979 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m16:52:35.710164 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m16:52:35.710289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:35.785750 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:52:35.786850 [debug] [ThreadPool]: On list_mydb: Close
[0m16:52:35.788095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m16:52:35.791598 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:52:35.791792 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m16:52:35.791946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:35.803365 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.803599 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m16:52:35.803857 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m16:52:35.810931 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:52:35.811995 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m16:52:35.812880 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m16:52:35.816586 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.816784 [debug] [MainThread]: On master: BEGIN
[0m16:52:35.816929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:35.825297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.825516 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.825741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:35.838190 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m16:52:35.840744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cd510>]}
[0m16:52:35.841016 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:35.841731 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.841943 [debug] [MainThread]: On master: BEGIN
[0m16:52:35.843155 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.843354 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.843547 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.843701 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.844306 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:35.844497 [debug] [MainThread]: On master: Close
[0m16:52:35.844891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:35.845109 [info ] [MainThread]: 
[0m16:52:35.848674 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m16:52:35.848931 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m16:52:35.849255 [info ] [Thread-1 (]: 1 of 10 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m16:52:35.849620 [info ] [Thread-2 (]: 2 of 10 START sql table model bank_warehouse.customers ......................... [RUN]
[0m16:52:35.850146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m16:52:35.850609 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m16:52:35.850810 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m16:52:35.851004 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m16:52:35.852864 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m16:52:35.854363 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m16:52:35.855440 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 16:52:35.851132 => 16:52:35.855299
[0m16:52:35.855667 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 16:52:35.853040 => 16:52:35.855567
[0m16:52:35.855857 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m16:52:35.856025 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m16:52:35.876381 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m16:52:35.878731 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m16:52:35.879141 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.879303 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m16:52:35.879471 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.879623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:35.879776 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m16:52:35.880010 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:52:35.887796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.888085 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.888332 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.888531 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.888711 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m16:52:35.888890 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m16:52:35.904019 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:52:35.907789 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.908001 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m16:52:35.908222 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m16:52:35.909829 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.910067 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m16:52:35.910996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:35.912436 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.912617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:35.912782 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m16:52:35.914202 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.914407 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m16:52:35.914975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:35.921326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:35.925930 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:52:35.927097 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:52:35.927276 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.927431 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.927566 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m16:52:35.927697 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m16:52:35.933313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:35.933519 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:35.936341 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m16:52:35.937569 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m16:52:35.937741 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m16:52:35.937904 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m16:52:35.946106 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:35.947032 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 16:52:35.876595 => 16:52:35.946930
[0m16:52:35.947232 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m16:52:35.947640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635a0d0>]}
[0m16:52:35.947969 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.10s]
[0m16:52:35.948294 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m16:52:35.948786 [debug] [Thread-4 (]: Began running node model.maker_warehouse.complaints
[0m16:52:35.949093 [info ] [Thread-4 (]: 3 of 10 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m16:52:35.949468 [debug] [Thread-3 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:52:35.949802 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m16:52:35.950221 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.complaints'
[0m16:52:35.950579 [info ] [Thread-3 (]: 4 of 10 START sql view model bank_warehouse.satisfaction_vs_num_products ....... [RUN]
[0m16:52:35.950992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:35.951194 [info ] [Thread-2 (]: 5 of 10 START sql view model bank_warehouse.total_salaries ..................... [RUN]
[0m16:52:35.951452 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.complaints
[0m16:52:35.951809 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.satisfaction_vs_num_products'
[0m16:52:35.952681 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 16:52:35.856136 => 16:52:35.952583
[0m16:52:35.953082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.total_salaries)
[0m16:52:35.954841 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m16:52:35.955097 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m16:52:35.955314 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m16:52:35.955499 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_salaries
[0m16:52:35.957021 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:35.958773 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m16:52:35.959210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313b10>]}
[0m16:52:35.959439 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.complaints (compile): 16:52:35.953241 => 16:52:35.959342
[0m16:52:35.959916 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.11s]
[0m16:52:35.960223 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.complaints
[0m16:52:35.960424 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 16:52:35.955686 => 16:52:35.960328
[0m16:52:35.960615 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (compile): 16:52:35.957307 => 16:52:35.960521
[0m16:52:35.960868 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m16:52:35.969785 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m16:52:35.970017 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m16:52:35.970184 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_salaries
[0m16:52:35.970513 [debug] [Thread-1 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m16:52:35.973469 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:35.975786 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m16:52:35.976138 [info ] [Thread-1 (]: 6 of 10 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m16:52:35.976512 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:52:35.976825 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:35.976990 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:52:35.977274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.creditscore_balance_ctry)
[0m16:52:35.977423 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: BEGIN
[0m16:52:35.977561 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m16:52:35.977688 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m16:52:35.977818 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m16:52:35.977946 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:52:35.978088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:52:35.978226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:35.979663 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:35.980308 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 16:52:35.978317 => 16:52:35.980209
[0m16:52:35.980462 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m16:52:35.982420 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:35.982789 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:35.982934 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m16:52:35.983069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:35.990262 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.990757 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.991014 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:35.991212 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:52:35.991416 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m16:52:35.991614 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m16:52:35.993129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.993361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:35.993545 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:52:35.993714 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:35.993892 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m16:52:35.994077 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:52:35.995255 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:35.996861 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:52:35.997068 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:35.997236 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m16:52:35.998486 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:35.998681 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:35.998838 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m16:52:36.000178 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:52:36.000338 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:36.000475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.000659 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m16:52:36.001971 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:36.002123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.002826 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:52:36.003041 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m16:52:36.003880 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:52:36.004055 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.004187 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:52:36.004372 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:36.005398 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: COMMIT
[0m16:52:36.005604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.005796 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m16:52:36.005945 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m16:52:36.006091 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:52:36.006906 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:52:36.007143 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: COMMIT
[0m16:52:36.007314 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:36.007561 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m16:52:36.008314 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.009559 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m16:52:36.009707 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.009835 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.009960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.010086 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m16:52:36.011060 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m16:52:36.011992 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m16:52:36.012947 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m16:52:36.013132 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m16:52:36.013310 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m16:52:36.013489 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m16:52:36.013767 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.014426 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 16:52:35.970654 => 16:52:36.014347
[0m16:52:36.014557 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.014681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.014794 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.014949 [debug] [Thread-3 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m16:52:36.015529 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (execute): 16:52:35.973726 => 16:52:36.015458
[0m16:52:36.016067 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 16:52:35.980555 => 16:52:36.015997
[0m16:52:36.016585 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.complaints (execute): 16:52:35.960985 => 16:52:36.016517
[0m16:52:36.016927 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b04750>]}
[0m16:52:36.017080 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: Close
[0m16:52:36.017232 [debug] [Thread-1 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m16:52:36.017369 [debug] [Thread-4 (]: On model.maker_warehouse.complaints: Close
[0m16:52:36.017644 [info ] [Thread-3 (]: 4 of 10 OK created sql view model bank_warehouse.satisfaction_vs_num_products .. [[32mCREATE VIEW[0m in 0.07s]
[0m16:52:36.018147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae9d10>]}
[0m16:52:36.018466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106351a10>]}
[0m16:52:36.018833 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abc6d0>]}
[0m16:52:36.019086 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m16:52:36.019357 [info ] [Thread-2 (]: 5 of 10 OK created sql view model bank_warehouse.total_salaries ................ [[32mCREATE VIEW[0m in 0.07s]
[0m16:52:36.019632 [info ] [Thread-1 (]: 6 of 10 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.04s]
[0m16:52:36.019955 [info ] [Thread-4 (]: 3 of 10 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:52:36.020202 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m16:52:36.020405 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m16:52:36.020653 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m16:52:36.020851 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.complaints
[0m16:52:36.021039 [info ] [Thread-3 (]: 7 of 10 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m16:52:36.021330 [debug] [Thread-2 (]: Began running node model.maker_warehouse.most_popular_card
[0m16:52:36.021698 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m16:52:36.021908 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_balance
[0m16:52:36.022251 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.satisfaction_vs_num_products, now model.maker_warehouse.customers_by_ctry)
[0m16:52:36.022466 [info ] [Thread-2 (]: 8 of 10 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m16:52:36.022696 [info ] [Thread-1 (]: 9 of 10 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m16:52:36.022910 [info ] [Thread-4 (]: 10 of 10 START sql view model bank_warehouse.total_balance ..................... [RUN]
[0m16:52:36.023145 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m16:52:36.023465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_salaries, now model.maker_warehouse.most_popular_card)
[0m16:52:36.023744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.salary_vs_cardtype)
[0m16:52:36.024008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.total_balance)
[0m16:52:36.025593 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.025788 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m16:52:36.025926 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m16:52:36.026060 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_balance
[0m16:52:36.027495 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m16:52:36.029651 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.030736 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m16:52:36.031000 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 16:52:36.024122 => 16:52:36.030915
[0m16:52:36.031260 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 16:52:36.026216 => 16:52:36.031166
[0m16:52:36.031450 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m16:52:36.031607 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 16:52:36.027625 => 16:52:36.031537
[0m16:52:36.031780 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (compile): 16:52:36.029813 => 16:52:36.031686
[0m16:52:36.031926 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.most_popular_card
[0m16:52:36.033840 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.033996 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m16:52:36.034143 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_balance
[0m16:52:36.036039 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m16:52:36.037907 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.039894 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m16:52:36.040222 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.040542 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m16:52:36.040731 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.040885 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:52:36.041037 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:52:36.041210 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m16:52:36.041357 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m16:52:36.041490 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:52:36.041721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:36.041853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:36.042004 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: BEGIN
[0m16:52:36.042329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:52:36.051265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:36.051540 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:36.051760 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.051917 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.052083 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m16:52:36.052326 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m16:52:36.052519 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:36.053228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:36.053473 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:52:36.053707 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:52:36.053904 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m16:52:36.054100 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m16:52:36.059033 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:36.059310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:36.061109 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:52:36.061305 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:36.061479 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:36.062754 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.062922 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m16:52:36.064138 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:52:36.065311 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.065463 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m16:52:36.065667 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m16:52:36.065859 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m16:52:36.066550 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.067329 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:52:36.067473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.067596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.067711 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:36.067845 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:52:36.068595 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:52:36.069312 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:52:36.070009 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:52:36.070158 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: COMMIT
[0m16:52:36.070291 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:52:36.070425 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.070554 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.070724 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m16:52:36.070890 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m16:52:36.071066 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m16:52:36.072103 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.072296 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.072443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.072581 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.073949 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m16:52:36.075051 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m16:52:36.076107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m16:52:36.077059 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m16:52:36.077224 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m16:52:36.077389 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m16:52:36.077558 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m16:52:36.077717 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m16:52:36.078735 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.078874 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.079002 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.079120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:36.080503 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_balance (execute): 16:52:36.038067 => 16:52:36.080425
[0m16:52:36.081048 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 16:52:36.036187 => 16:52:36.080979
[0m16:52:36.081552 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 16:52:36.032022 => 16:52:36.081486
[0m16:52:36.082045 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 16:52:36.034244 => 16:52:36.081979
[0m16:52:36.082195 [debug] [Thread-4 (]: On model.maker_warehouse.total_balance: Close
[0m16:52:36.082331 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m16:52:36.082465 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m16:52:36.082591 [debug] [Thread-2 (]: On model.maker_warehouse.most_popular_card: Close
[0m16:52:36.083838 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aac190>]}
[0m16:52:36.084097 [info ] [Thread-2 (]: 8 of 10 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:52:36.084372 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.most_popular_card
[0m16:52:36.082928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106276310>]}
[0m16:52:36.084883 [info ] [Thread-4 (]: 10 of 10 OK created sql view model bank_warehouse.total_balance ................ [[32mCREATE VIEW[0m in 0.06s]
[0m16:52:36.083241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c090>]}
[0m16:52:36.085177 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_balance
[0m16:52:36.085457 [info ] [Thread-1 (]: 9 of 10 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.06s]
[0m16:52:36.083563 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fed5bc7-7a65-432f-acbc-75eb278d1e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cdfd0>]}
[0m16:52:36.086032 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m16:52:36.086295 [info ] [Thread-3 (]: 7 of 10 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:52:36.086776 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m16:52:36.087568 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:36.087712 [debug] [MainThread]: On master: BEGIN
[0m16:52:36.087818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:36.095870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:36.096165 [debug] [MainThread]: On master: COMMIT
[0m16:52:36.096290 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:36.096397 [debug] [MainThread]: On master: COMMIT
[0m16:52:36.096922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:36.097076 [debug] [MainThread]: On master: Close
[0m16:52:36.097390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:36.097506 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m16:52:36.097608 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m16:52:36.097704 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m16:52:36.097795 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m16:52:36.097940 [info ] [MainThread]: 
[0m16:52:36.098106 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:52:36.098894 [debug] [MainThread]: Command end result
[0m16:52:36.101971 [info ] [MainThread]: 
[0m16:52:36.102191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:36.102347 [info ] [MainThread]: 
[0m16:52:36.102511 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:52:36.102807 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:36.102765 after 0.54 seconds
[0m16:52:36.102974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10294a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aabcd0>]}
[0m16:52:36.103130 [debug] [MainThread]: Flushing usage events
[0m17:07:52.292361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e97d50>]}


============================== 17:07:52.294750 | 7a4af844-b3a9-450e-a6ac-ad8eaa9e8893 ==============================
[0m17:07:52.294750 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:07:52.295076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:07:52.333014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e97c50>]}
[0m17:07:52.339634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029e7090>]}
[0m17:07:52.340007 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:07:52.351061 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:07:52.370143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:52.370514 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/creditscore_balance_ctry.sql
[0m17:07:52.381567 [debug] [MainThread]: 1699: static parser successfully parsed summaries/creditscore_balance_ctry.sql
[0m17:07:52.412605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463bdd0>]}
[0m17:07:52.415729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104502150>]}
[0m17:07:52.415926 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:07:52.416111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c419d0>]}
[0m17:07:52.416975 [info ] [MainThread]: 
[0m17:07:52.417376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:52.418029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:07:52.423138 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:07:52.423353 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:07:52.423473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:52.501745 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:07:52.502769 [debug] [ThreadPool]: On list_mydb: Close
[0m17:07:52.503951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m17:07:52.507533 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:07:52.507733 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m17:07:52.507879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:52.526221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:07:52.526411 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:07:52.526593 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m17:07:52.543561 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m17:07:52.544611 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m17:07:52.545551 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m17:07:52.549935 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:52.550201 [debug] [MainThread]: On master: BEGIN
[0m17:07:52.550399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:52.562506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:07:52.562817 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:52.563120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:52.585191 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m17:07:52.588420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d1e10>]}
[0m17:07:52.588754 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:52.589709 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:52.589995 [debug] [MainThread]: On master: BEGIN
[0m17:07:52.591519 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:07:52.591769 [debug] [MainThread]: On master: COMMIT
[0m17:07:52.591985 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:52.592185 [debug] [MainThread]: On master: COMMIT
[0m17:07:52.593180 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:07:52.593428 [debug] [MainThread]: On master: Close
[0m17:07:52.593973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:52.594270 [info ] [MainThread]: 
[0m17:07:52.598235 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m17:07:52.598535 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m17:07:52.598918 [info ] [Thread-1 (]: 1 of 10 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m17:07:52.599308 [info ] [Thread-2 (]: 2 of 10 START sql table model bank_warehouse.customers ......................... [RUN]
[0m17:07:52.600055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m17:07:52.600637 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m17:07:52.600955 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m17:07:52.601252 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m17:07:52.603828 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m17:07:52.605785 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m17:07:52.606419 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 17:07:52.601460 => 17:07:52.606260
[0m17:07:52.606710 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 17:07:52.604073 => 17:07:52.606562
[0m17:07:52.606969 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m17:07:52.607210 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m17:07:52.632011 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m17:07:52.634500 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m17:07:52.635069 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.635263 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.635438 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m17:07:52.635608 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m17:07:52.635764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:52.635924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.645024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:52.645311 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.645498 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m17:07:52.645714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:52.645884 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.646051 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m17:07:52.664834 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:07:52.669045 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.669301 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:07:52.669562 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m17:07:52.671259 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.671530 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m17:07:52.672653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:52.672840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:52.674484 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.676071 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.676272 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m17:07:52.676447 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m17:07:52.677469 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:52.677639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:52.688636 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:07:52.689808 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:07:52.689989 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.690149 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.690298 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:07:52.690441 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:07:52.693074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:52.693249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:52.695987 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:07:52.697218 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:07:52.697396 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m17:07:52.697575 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m17:07:53.705764 [debug] [Thread-1 (]: Postgres adapter: Postgres error: deadlock detected
DETAIL:  Process 1056 waits for AccessExclusiveLock on object 27171 of class 2618 of database 16384; blocked by process 1055.
Process 1055 waits for AccessExclusiveLock on object 27182 of class 2618 of database 16384; blocked by process 1056.
HINT:  See server log for query details.

[0m17:07:53.707665 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m17:07:53.708458 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m17:07:53.709502 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 17:07:52.607375 => 17:07:53.709113
[0m17:07:53.710161 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m17:07:53.723603 [debug] [Thread-1 (]: Database Error in model accounts (models/facts/accounts.sql)
  deadlock detected
  DETAIL:  Process 1056 waits for AccessExclusiveLock on object 27171 of class 2618 of database 16384; blocked by process 1055.
  Process 1055 waits for AccessExclusiveLock on object 27182 of class 2618 of database 16384; blocked by process 1056.
  HINT:  See server log for query details.
  compiled Code at target/run/maker_warehouse/models/facts/accounts.sql
[0m17:07:53.724330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b050>]}
[0m17:07:53.725110 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model bank_warehouse.accounts ................. [[31mERROR[0m in 1.12s]
[0m17:07:53.725949 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m17:07:53.726970 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m17:07:53.727373 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m17:07:53.727846 [info ] [Thread-4 (]: 3 of 10 SKIP relation bank_warehouse.most_popular_card ......................... [[33mSKIP[0m]
[0m17:07:53.728511 [info ] [Thread-3 (]: 4 of 10 SKIP relation bank_warehouse.total_balance ............................. [[33mSKIP[0m]
[0m17:07:53.729077 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m17:07:53.729555 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m17:07:53.731220 [debug] [Thread-2 (]: SQL status: DROP TABLE in 1.0 seconds
[0m17:07:53.733080 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 17:07:52.632172 => 17:07:53.732867
[0m17:07:53.733542 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m17:07:53.734422 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebbc10>]}
[0m17:07:53.735109 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 1.13s]
[0m17:07:53.735888 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m17:07:53.736860 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m17:07:53.737317 [info ] [Thread-1 (]: 5 of 10 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m17:07:53.737901 [debug] [Thread-4 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m17:07:53.738417 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m17:07:53.738810 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m17:07:53.739418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m17:07:53.739810 [info ] [Thread-4 (]: 6 of 10 SKIP relation bank_warehouse.creditscore_balance_ctry .................. [[33mSKIP[0m]
[0m17:07:53.740265 [info ] [Thread-3 (]: 7 of 10 SKIP relation bank_warehouse.customers_by_ctry ......................... [[33mSKIP[0m]
[0m17:07:53.740765 [info ] [Thread-2 (]: 8 of 10 SKIP relation bank_warehouse.salary_vs_cardtype ........................ [[33mSKIP[0m]
[0m17:07:53.741210 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m17:07:53.741587 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m17:07:53.741956 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m17:07:53.742366 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m17:07:53.745352 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m17:07:53.745777 [debug] [Thread-4 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:07:53.746182 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_salaries
[0m17:07:53.746776 [info ] [Thread-4 (]: 9 of 10 START sql view model bank_warehouse.satisfaction_vs_num_products ....... [RUN]
[0m17:07:53.747281 [info ] [Thread-3 (]: 10 of 10 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m17:07:53.748099 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.satisfaction_vs_num_products'
[0m17:07:53.748414 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 17:07:53.742606 => 17:07:53.748275
[0m17:07:53.748910 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_salaries'
[0m17:07:53.749186 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m17:07:53.749424 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m17:07:53.749650 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_salaries
[0m17:07:53.751873 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.766889 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m17:07:53.769157 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m17:07:53.769909 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:07:53.770167 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m17:07:53.770440 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 17:07:53.749811 => 17:07:53.770289
[0m17:07:53.770670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:53.770911 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (compile): 17:07:53.767184 => 17:07:53.770801
[0m17:07:53.771124 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m17:07:53.771424 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_salaries
[0m17:07:53.775549 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.778127 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m17:07:53.778587 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:07:53.778785 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.778980 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m17:07:53.779166 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m17:07:53.779344 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:07:53.779564 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:53.780811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:53.781026 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:07:53.781216 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m17:07:53.786559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:07:53.788570 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:07:53.788859 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m17:07:53.789906 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:53.790108 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:07:53.790275 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:53.790431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:53.790599 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m17:07:53.790786 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.791752 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:07:53.791984 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m17:07:53.792202 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:07:53.792437 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:07:53.793786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:53.795297 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:07:53.795516 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m17:07:53.795762 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:07:53.797285 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:07:53.797454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:07:53.797605 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:07:53.797781 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m17:07:53.798485 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 17:07:53.752173 => 17:07:53.798389
[0m17:07:53.799959 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.800199 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m17:07:53.800371 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m17:07:53.800791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104767050>]}
[0m17:07:53.801026 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:53.801349 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:07:53.802569 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:07:53.802786 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:53.803061 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m17:07:53.803224 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:07:53.804040 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:07:53.804304 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:07:53.804477 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.804670 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:07:53.805731 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:53.807103 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:07:53.807258 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:53.807418 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m17:07:53.808559 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:07:53.808757 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m17:07:53.809251 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:07:53.809391 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:07:53.810085 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (execute): 17:07:53.775823 => 17:07:53.809999
[0m17:07:53.810697 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 17:07:53.771568 => 17:07:53.810617
[0m17:07:53.810860 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: Close
[0m17:07:53.811025 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m17:07:53.811386 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cfa90>]}
[0m17:07:53.811724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4af844-b3a9-450e-a6ac-ad8eaa9e8893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468c690>]}
[0m17:07:53.811995 [info ] [Thread-3 (]: 10 of 10 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.06s]
[0m17:07:53.812624 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_salaries
[0m17:07:53.812268 [info ] [Thread-4 (]: 9 of 10 OK created sql view model bank_warehouse.satisfaction_vs_num_products .. [[32mCREATE VIEW[0m in 0.06s]
[0m17:07:53.812988 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:07:53.813895 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:53.814063 [debug] [MainThread]: On master: BEGIN
[0m17:07:53.814191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:53.822717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:07:53.823023 [debug] [MainThread]: On master: COMMIT
[0m17:07:53.823168 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:53.823294 [debug] [MainThread]: On master: COMMIT
[0m17:07:53.823786 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:07:53.823954 [debug] [MainThread]: On master: Close
[0m17:07:53.824289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:53.824413 [debug] [MainThread]: Connection 'model.maker_warehouse.complaints' was properly closed.
[0m17:07:53.824524 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m17:07:53.824630 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m17:07:53.824735 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m17:07:53.824904 [info ] [MainThread]: 
[0m17:07:53.825090 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m17:07:53.825933 [debug] [MainThread]: Command end result
[0m17:07:53.829303 [info ] [MainThread]: 
[0m17:07:53.829544 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:53.829740 [info ] [MainThread]: 
[0m17:07:53.829907 [error] [MainThread]: [33mDatabase Error in model accounts (models/facts/accounts.sql)[0m
[0m17:07:53.830059 [error] [MainThread]:   deadlock detected
[0m17:07:53.830204 [error] [MainThread]:   DETAIL:  Process 1056 waits for AccessExclusiveLock on object 27171 of class 2618 of database 16384; blocked by process 1055.
[0m17:07:53.830385 [error] [MainThread]:   Process 1055 waits for AccessExclusiveLock on object 27182 of class 2618 of database 16384; blocked by process 1056.
[0m17:07:53.830528 [error] [MainThread]:   HINT:  See server log for query details.
[0m17:07:53.830665 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/accounts.sql
[0m17:07:53.830816 [info ] [MainThread]: 
[0m17:07:53.830999 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=5 TOTAL=10
[0m17:07:53.831423 [debug] [MainThread]: Command `dbt run` failed at 17:07:53.831365 after 1.56 seconds
[0m17:07:53.831619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eabe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e96a50>]}
[0m17:07:53.831794 [debug] [MainThread]: Flushing usage events
[0m17:09:05.710515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105826e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039fe790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105837610>]}


============================== 17:09:05.712977 | 49729a90-1eee-45d4-990b-f8fb7af4b57c ==============================
[0m17:09:05.712977 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:09:05.713307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:09:05.750850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585a2d0>]}
[0m17:09:05.757328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5da50>]}
[0m17:09:05.757677 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:09:05.768372 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:09:05.789036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:05.789246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:05.792669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105827150>]}
[0m17:09:05.796048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581b050>]}
[0m17:09:05.796280 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:09:05.796471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10251e290>]}
[0m17:09:05.797508 [info ] [MainThread]: 
[0m17:09:05.797961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:05.798681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:09:05.804021 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:09:05.804237 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:09:05.804366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:05.860921 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:09:05.861906 [debug] [ThreadPool]: On list_mydb: Close
[0m17:09:05.863005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m17:09:05.866226 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:09:05.866402 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m17:09:05.866539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:05.880154 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:09:05.880396 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:09:05.880584 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m17:09:05.893146 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:09:05.894130 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m17:09:05.895012 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m17:09:05.899469 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:05.899765 [debug] [MainThread]: On master: BEGIN
[0m17:09:05.899925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:05.908884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:05.909117 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:05.909357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:05.925993 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m17:09:05.927880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105859710>]}
[0m17:09:05.928158 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:05.928933 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:05.929150 [debug] [MainThread]: On master: BEGIN
[0m17:09:05.930260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:05.930437 [debug] [MainThread]: On master: COMMIT
[0m17:09:05.930599 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:05.930745 [debug] [MainThread]: On master: COMMIT
[0m17:09:05.931379 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:05.931551 [debug] [MainThread]: On master: Close
[0m17:09:05.931960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:05.932196 [info ] [MainThread]: 
[0m17:09:05.956713 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m17:09:05.956953 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m17:09:05.957242 [info ] [Thread-1 (]: 1 of 10 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m17:09:05.957511 [info ] [Thread-2 (]: 2 of 10 START sql table model bank_warehouse.customers ......................... [RUN]
[0m17:09:05.957962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m17:09:05.958358 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m17:09:05.958537 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m17:09:05.958694 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m17:09:05.960317 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m17:09:05.961657 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m17:09:05.962078 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 17:09:05.958801 => 17:09:05.961981
[0m17:09:05.962288 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 17:09:05.960448 => 17:09:05.962190
[0m17:09:05.962452 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m17:09:05.962614 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m17:09:05.977437 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:05.985445 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m17:09:05.985632 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m17:09:05.985866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:05.986201 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:05.986351 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m17:09:05.986480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:09:05.994144 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:05.994414 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:05.994585 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m17:09:06.000242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:06.001359 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m17:09:06.001737 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.001898 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m17:09:06.002643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.002843 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.003018 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m17:09:06.019046 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:09:06.019292 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:09:06.023095 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.024632 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:06.024861 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m17:09:06.025043 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m17:09:06.026087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.026246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.027810 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.029218 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:06.029397 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m17:09:06.029568 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m17:09:06.030507 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.030675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.041669 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:09:06.042845 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:09:06.043034 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:06.043194 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.043346 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:09:06.043488 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:09:06.049940 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.051678 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:09:06.051871 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m17:09:06.052043 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.054120 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:09:06.054324 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m17:09:06.057461 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:06.058294 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 17:09:05.962721 => 17:09:06.058196
[0m17:09:06.058479 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m17:09:06.058638 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:06.059055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105827b50>]}
[0m17:09:06.059764 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 17:09:05.977617 => 17:09:06.059675
[0m17:09:06.060104 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.10s]
[0m17:09:06.060369 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m17:09:06.060660 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m17:09:06.061284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467e3d0>]}
[0m17:09:06.061573 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m17:09:06.061736 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m17:09:06.062009 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.10s]
[0m17:09:06.062301 [info ] [Thread-4 (]: 3 of 10 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m17:09:06.062582 [info ] [Thread-3 (]: 4 of 10 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m17:09:06.062963 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m17:09:06.063373 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m17:09:06.063726 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m17:09:06.064397 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m17:09:06.064641 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m17:09:06.064804 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m17:09:06.064987 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m17:09:06.065227 [info ] [Thread-1 (]: 5 of 10 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m17:09:06.065547 [info ] [Thread-2 (]: 6 of 10 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m17:09:06.067375 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m17:09:06.068843 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m17:09:06.069210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m17:09:06.069499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m17:09:06.069971 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m17:09:06.070174 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m17:09:06.071491 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m17:09:06.071679 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 17:09:06.065748 => 17:09:06.071592
[0m17:09:06.071877 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 17:09:06.067609 => 17:09:06.071766
[0m17:09:06.073147 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.073362 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m17:09:06.073532 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m17:09:06.073693 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 17:09:06.070311 => 17:09:06.073621
[0m17:09:06.082552 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m17:09:06.084941 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m17:09:06.085163 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m17:09:06.085372 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 17:09:06.072003 => 17:09:06.085278
[0m17:09:06.087336 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m17:09:06.087542 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m17:09:06.089503 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.089677 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:09:06.089827 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:09:06.090039 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m17:09:06.090204 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m17:09:06.090343 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:09:06.090491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:09:06.090631 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.090769 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:09:06.090910 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m17:09:06.091116 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m17:09:06.091301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:06.091440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:06.101069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.101351 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:09:06.101526 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m17:09:06.102856 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.103080 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.103270 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score,
    ROUND(AVG(customers.satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m17:09:06.103462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.103672 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:09:06.103829 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m17:09:06.104107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.104309 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:09:06.104457 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m17:09:06.106307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.107966 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:09:06.108153 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m17:09:06.108817 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.110272 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:09:06.110508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.110667 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.110810 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m17:09:06.110943 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.111767 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:09:06.113045 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:09:06.114419 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.114606 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.114767 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:09:06.114923 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m17:09:06.115074 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m17:09:06.115837 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m17:09:06.115981 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:09:06.116219 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:09:06.116408 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m17:09:06.116905 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.117052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.117895 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m17:09:06.118042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.118190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.119918 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m17:09:06.120099 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.121208 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:09:06.122248 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:09:06.122394 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:09:06.122545 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m17:09:06.122705 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m17:09:06.122860 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m17:09:06.123004 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m17:09:06.123776 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.123916 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.124049 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.124176 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.124785 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 17:09:06.085582 => 17:09:06.124707
[0m17:09:06.125867 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:09:06.126427 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 17:09:06.082795 => 17:09:06.126356
[0m17:09:06.127475 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:09:06.127634 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m17:09:06.127787 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m17:09:06.127937 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m17:09:06.128081 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m17:09:06.128424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643c790>]}
[0m17:09:06.128785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e870d0>]}
[0m17:09:06.129348 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.129736 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.129590 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:09:06.130245 [info ] [Thread-3 (]: 4 of 10 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.07s]
[0m17:09:06.131109 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 17:09:06.087703 => 17:09:06.131022
[0m17:09:06.131746 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 17:09:06.073825 => 17:09:06.131669
[0m17:09:06.131988 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m17:09:06.132237 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m17:09:06.132455 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m17:09:06.132657 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m17:09:06.132879 [debug] [Thread-1 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m17:09:06.133101 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m17:09:06.133528 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f4610>]}
[0m17:09:06.133822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7b090>]}
[0m17:09:06.134018 [info ] [Thread-1 (]: 7 of 10 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m17:09:06.134275 [info ] [Thread-3 (]: 8 of 10 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m17:09:06.134628 [info ] [Thread-4 (]: 3 of 10 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.07s]
[0m17:09:06.134964 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.06s]
[0m17:09:06.135337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.customers_by_ctry)
[0m17:09:06.135622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.salary_vs_cardtype)
[0m17:09:06.135863 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m17:09:06.136082 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m17:09:06.136236 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m17:09:06.136379 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m17:09:06.136553 [debug] [Thread-4 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:09:06.136799 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m17:09:06.138240 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.139603 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.139821 [info ] [Thread-4 (]: 9 of 10 START sql view model bank_warehouse.satisfaction_vs_num_products ....... [RUN]
[0m17:09:06.140055 [info ] [Thread-2 (]: 10 of 10 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m17:09:06.140653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.satisfaction_vs_num_products)
[0m17:09:06.140982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.total_salaries)
[0m17:09:06.141190 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 17:09:06.136937 => 17:09:06.141106
[0m17:09:06.141321 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m17:09:06.141460 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 17:09:06.138372 => 17:09:06.141395
[0m17:09:06.141595 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_salaries
[0m17:09:06.141726 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m17:09:06.142956 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.143106 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m17:09:06.144118 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m17:09:06.146013 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.148048 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.148419 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 17:09:06.141815 => 17:09:06.148331
[0m17:09:06.148731 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.148913 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m17:09:06.149065 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (compile): 17:09:06.143202 => 17:09:06.148995
[0m17:09:06.149220 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.149403 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m17:09:06.151750 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.152013 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_salaries
[0m17:09:06.152164 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m17:09:06.152301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:06.154308 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m17:09:06.154498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:09:06.154675 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.155018 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m17:09:06.155171 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:09:06.155341 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:09:06.155492 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m17:09:06.155709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:06.164851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.165081 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.165265 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.165551 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.165773 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.165952 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:09:06.166252 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m17:09:06.166444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.166629 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m17:09:06.166813 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m17:09:06.167012 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.167296 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m17:09:06.170993 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.172670 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.172849 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.173025 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.173215 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m17:09:06.175511 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.175682 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:06.176959 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.177176 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m17:09:06.178486 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:09:06.178628 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.178782 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m17:09:06.178985 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m17:09:06.179756 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:09:06.179898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.180144 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.180946 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m17:09:06.181101 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.181226 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:06.181380 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:09:06.181521 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.182237 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:09:06.182928 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m17:09:06.183115 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m17:09:06.183285 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:09:06.183445 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.183620 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:09:06.183780 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m17:09:06.184253 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.185544 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:09:06.185684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.185823 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.185947 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.186096 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m17:09:06.187183 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:09:06.188205 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:09:06.189186 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:09:06.189367 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m17:09:06.189531 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m17:09:06.189686 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m17:09:06.189824 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.190546 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 17:09:06.149520 => 17:09:06.190463
[0m17:09:06.190678 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.190805 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.190923 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:06.191072 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m17:09:06.191652 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (execute): 17:09:06.152475 => 17:09:06.191582
[0m17:09:06.192201 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 17:09:06.144224 => 17:09:06.192130
[0m17:09:06.192741 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 17:09:06.146161 => 17:09:06.192672
[0m17:09:06.193079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105846450>]}
[0m17:09:06.193222 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: Close
[0m17:09:06.193375 [debug] [Thread-1 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m17:09:06.193521 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m17:09:06.194911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fe050>]}
[0m17:09:06.195159 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.06s]
[0m17:09:06.195429 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m17:09:06.193772 [info ] [Thread-4 (]: 9 of 10 OK created sql view model bank_warehouse.satisfaction_vs_num_products .. [[32mCREATE VIEW[0m in 0.05s]
[0m17:09:06.196193 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:09:06.194172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a7f50>]}
[0m17:09:06.194471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49729a90-1eee-45d4-990b-f8fb7af4b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457e50>]}
[0m17:09:06.196798 [info ] [Thread-2 (]: 10 of 10 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.05s]
[0m17:09:06.197166 [info ] [Thread-1 (]: 7 of 10 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.06s]
[0m17:09:06.197494 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m17:09:06.197733 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m17:09:06.198674 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:06.198849 [debug] [MainThread]: On master: BEGIN
[0m17:09:06.198967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:06.206524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:06.206772 [debug] [MainThread]: On master: COMMIT
[0m17:09:06.206893 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:06.207002 [debug] [MainThread]: On master: COMMIT
[0m17:09:06.207468 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:06.207620 [debug] [MainThread]: On master: Close
[0m17:09:06.207943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:06.208062 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m17:09:06.208171 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m17:09:06.208276 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m17:09:06.208376 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m17:09:06.208537 [info ] [MainThread]: 
[0m17:09:06.208714 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:09:06.209531 [debug] [MainThread]: Command end result
[0m17:09:06.212616 [info ] [MainThread]: 
[0m17:09:06.212817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:06.212977 [info ] [MainThread]: 
[0m17:09:06.213138 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:09:06.213492 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:06.213431 after 0.52 seconds
[0m17:09:06.213703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cfa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e5bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e59250>]}
[0m17:09:06.213888 [debug] [MainThread]: Flushing usage events
[0m17:11:13.732040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108893950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a7290>]}


============================== 17:11:13.734643 | 95419b9a-e746-47e1-b1a9-d1f8ed8de8fa ==============================
[0m17:11:13.734643 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:11:13.735015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:11:13.773196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b31d0>]}
[0m17:11:13.779639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c74d0>]}
[0m17:11:13.779958 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:11:13.790624 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:11:13.809853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:13.810236 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/creditscore_balance_ctry.sql
[0m17:11:13.821966 [debug] [MainThread]: 1699: static parser successfully parsed summaries/creditscore_balance_ctry.sql
[0m17:11:13.851470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbe510>]}
[0m17:11:13.855118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108958610>]}
[0m17:11:13.855320 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:11:13.855499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664dc50>]}
[0m17:11:13.856376 [info ] [MainThread]: 
[0m17:11:13.856793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:13.857459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m17:11:13.862330 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m17:11:13.862545 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m17:11:13.862668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:13.924845 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:11:13.925774 [debug] [ThreadPool]: On list_mydb: Close
[0m17:11:13.926808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m17:11:13.930207 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:11:13.930398 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m17:11:13.930547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:13.946709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:13.947050 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m17:11:13.947246 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m17:11:13.954175 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m17:11:13.955209 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m17:11:13.955965 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m17:11:13.959987 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:13.960220 [debug] [MainThread]: On master: BEGIN
[0m17:11:13.960374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:13.968975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:13.969194 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:13.969442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:13.992629 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m17:11:13.995504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3b8d0>]}
[0m17:11:13.995813 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:13.996697 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:13.996898 [debug] [MainThread]: On master: BEGIN
[0m17:11:13.998214 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:13.998417 [debug] [MainThread]: On master: COMMIT
[0m17:11:13.998583 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:13.998747 [debug] [MainThread]: On master: COMMIT
[0m17:11:13.999336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:13.999515 [debug] [MainThread]: On master: Close
[0m17:11:13.999959 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:14.000216 [info ] [MainThread]: 
[0m17:11:14.003381 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m17:11:14.003670 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m17:11:14.004046 [info ] [Thread-1 (]: 1 of 10 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m17:11:14.004423 [info ] [Thread-2 (]: 2 of 10 START sql table model bank_warehouse.customers ......................... [RUN]
[0m17:11:14.004984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m17:11:14.005484 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m17:11:14.005735 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m17:11:14.005948 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m17:11:14.007979 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m17:11:14.009723 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m17:11:14.010413 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 17:11:14.008153 => 17:11:14.010290
[0m17:11:14.010641 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 17:11:14.006094 => 17:11:14.010533
[0m17:11:14.010845 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m17:11:14.011049 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m17:11:14.033035 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m17:11:14.035346 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m17:11:14.035819 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.036010 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.036167 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m17:11:14.036326 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m17:11:14.036476 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:14.036615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:14.045650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.045886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.046105 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.046290 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.046461 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m17:11:14.046640 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m17:11:14.067319 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:11:14.071347 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.071570 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m17:11:14.071818 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m17:11:14.073500 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.073792 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m17:11:14.074849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.075015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.076440 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.077926 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.078102 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m17:11:14.078278 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m17:11:14.079093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.079250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.090213 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:11:14.091353 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:11:14.091538 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.091697 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.091845 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m17:11:14.091998 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m17:11:14.099459 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.099657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.102700 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m17:11:14.103988 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m17:11:14.104177 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m17:11:14.104351 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m17:11:14.113457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:11:14.114270 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 17:11:14.033195 => 17:11:14.114172
[0m17:11:14.114464 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m17:11:14.114874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fde010>]}
[0m17:11:14.115220 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.11s]
[0m17:11:14.115587 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m17:11:14.116029 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m17:11:14.116221 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m17:11:14.116475 [info ] [Thread-4 (]: 3 of 10 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m17:11:14.116754 [info ] [Thread-3 (]: 4 of 10 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m17:11:14.117574 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m17:11:14.118039 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m17:11:14.118272 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m17:11:14.118477 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m17:11:14.120321 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m17:11:14.120551 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:11:14.121983 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m17:11:14.122819 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 17:11:14.011174 => 17:11:14.122730
[0m17:11:14.123074 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m17:11:14.123271 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 17:11:14.118629 => 17:11:14.123177
[0m17:11:14.123539 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 17:11:14.120712 => 17:11:14.123436
[0m17:11:14.123869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108174290>]}
[0m17:11:14.124032 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m17:11:14.124204 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m17:11:14.124476 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.12s]
[0m17:11:14.134058 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m17:11:14.137328 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m17:11:14.137654 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m17:11:14.138154 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:11:14.138320 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m17:11:14.138463 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:11:14.138603 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m17:11:14.138747 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m17:11:14.138941 [info ] [Thread-1 (]: 5 of 10 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m17:11:14.139140 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m17:11:14.139321 [info ] [Thread-2 (]: 6 of 10 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m17:11:14.139528 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:14.139831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m17:11:14.139983 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:14.140230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m17:11:14.140443 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m17:11:14.140655 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m17:11:14.141960 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m17:11:14.143364 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.144028 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 17:11:14.140758 => 17:11:14.143941
[0m17:11:14.144181 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m17:11:14.144362 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 17:11:14.142102 => 17:11:14.144268
[0m17:11:14.146333 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m17:11:14.146557 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m17:11:14.148585 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.149098 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:11:14.149310 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m17:11:14.149511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:14.149766 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.149948 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m17:11:14.150099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:14.150609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.150776 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:11:14.150931 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m17:11:14.151131 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.151320 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:11:14.151483 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m17:11:14.154759 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.156442 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:11:14.156592 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.156774 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m17:11:14.158130 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:11:14.158332 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m17:11:14.158990 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.159848 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m17:11:14.160031 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.160206 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:11:14.160986 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m17:11:14.161179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.161376 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m17:11:14.161554 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:11:14.161728 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:11:14.161959 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m17:11:14.162224 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m17:11:14.162629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.162888 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.163056 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score,
    ROUND(AVG(customers.satisfactionscore), 4) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m17:11:14.163206 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.164600 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m17:11:14.164804 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m17:11:14.165014 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.166338 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m17:11:14.166562 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m17:11:14.167485 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.167638 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.168471 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 17:11:14.124648 => 17:11:14.168384
[0m17:11:14.168612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.169255 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 17:11:14.134275 => 17:11:14.169177
[0m17:11:14.169432 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m17:11:14.170786 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:11:14.170933 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.171092 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m17:11:14.171463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109085590>]}
[0m17:11:14.171616 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m17:11:14.173033 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.173385 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b6990>]}
[0m17:11:14.173644 [info ] [Thread-4 (]: 3 of 10 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.05s]
[0m17:11:14.173932 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m17:11:14.174276 [info ] [Thread-3 (]: 4 of 10 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.06s]
[0m17:11:14.174588 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m17:11:14.174859 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m17:11:14.175057 [debug] [Thread-4 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m17:11:14.175232 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m17:11:14.175493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.175688 [info ] [Thread-4 (]: 7 of 10 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m17:11:14.175991 [info ] [Thread-3 (]: 8 of 10 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m17:11:14.176999 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:11:14.177161 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.177488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.customers_by_ctry)
[0m17:11:14.177770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.salary_vs_cardtype)
[0m17:11:14.177921 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:11:14.178688 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m17:11:14.178848 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m17:11:14.178992 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m17:11:14.179129 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m17:11:14.179264 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.180780 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.182052 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.182312 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m17:11:14.183067 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 17:11:14.179356 => 17:11:14.182925
[0m17:11:14.183256 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m17:11:14.185403 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.185617 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.185756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.187775 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m17:11:14.187980 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 17:11:14.180903 => 17:11:14.187890
[0m17:11:14.188957 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m17:11:14.189123 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m17:11:14.189270 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.189418 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m17:11:14.189572 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m17:11:14.189732 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m17:11:14.191673 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.191818 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.191997 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:14.192722 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 17:11:14.146744 => 17:11:14.192638
[0m17:11:14.192882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.193127 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m17:11:14.193276 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.193874 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 17:11:14.144469 => 17:11:14.193790
[0m17:11:14.194274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091463d0>]}
[0m17:11:14.194423 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m17:11:14.194595 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m17:11:14.194890 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.05s]
[0m17:11:14.195118 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:14.195754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109144e10>]}
[0m17:11:14.196030 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m17:11:14.196447 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:11:14.196751 [debug] [Thread-2 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:11:14.197046 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m17:11:14.197746 [debug] [Thread-1 (]: Began running node model.maker_warehouse.total_salaries
[0m17:11:14.197359 [info ] [Thread-2 (]: 9 of 10 START sql view model bank_warehouse.satisfaction_vs_num_products ....... [RUN]
[0m17:11:14.197940 [info ] [Thread-1 (]: 10 of 10 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m17:11:14.198646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.satisfaction_vs_num_products)
[0m17:11:14.199051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.total_salaries)
[0m17:11:14.199251 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m17:11:14.199401 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.total_salaries
[0m17:11:14.200892 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.202421 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m17:11:14.202638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.202914 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.203089 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m17:11:14.203379 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (compile): 17:11:14.201092 => 17:11:14.203291
[0m17:11:14.203564 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 17:11:14.199516 => 17:11:14.203468
[0m17:11:14.203727 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.total_salaries
[0m17:11:14.203882 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m17:11:14.205941 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m17:11:14.207981 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.208164 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.208296 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.208555 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.209980 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.210156 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.210313 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m17:11:14.210464 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:11:14.210623 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m17:11:14.210769 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m17:11:14.210928 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m17:11:14.211103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:14.211268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:14.211869 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.212698 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m17:11:14.212872 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.213012 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m17:11:14.215568 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.217107 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m17:11:14.217336 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.217553 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m17:11:14.219097 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.219330 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m17:11:14.219873 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.220614 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 17:11:14.183357 => 17:11:14.220524
[0m17:11:14.220782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.220931 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m17:11:14.221760 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m17:11:14.221998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.222370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041910>]}
[0m17:11:14.222554 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.222705 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:11:14.223000 [info ] [Thread-4 (]: 7 of 10 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.05s]
[0m17:11:14.223253 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m17:11:14.223546 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m17:11:14.223883 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.224143 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m17:11:14.224441 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.224742 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m17:11:14.225200 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.226401 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m17:11:14.226567 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m17:11:14.227607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.229147 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:11:14.229297 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.229464 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m17:11:14.230165 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 17:11:14.189827 => 17:11:14.230080
[0m17:11:14.230304 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:14.230490 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m17:11:14.231998 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.232202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.232656 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109157a90>]}
[0m17:11:14.232836 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m17:11:14.233790 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:11:14.234110 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.05s]
[0m17:11:14.234385 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:11:14.234718 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m17:11:14.234890 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m17:11:14.235440 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:14.236332 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:11:14.236505 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.236641 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m17:11:14.236778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.237995 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m17:11:14.238141 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.238297 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m17:11:14.240150 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m17:11:14.240358 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m17:11:14.240801 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.240935 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:14.241565 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.total_salaries (execute): 17:11:14.203985 => 17:11:14.241487
[0m17:11:14.242146 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 17:11:14.206083 => 17:11:14.242073
[0m17:11:14.242317 [debug] [Thread-1 (]: On model.maker_warehouse.total_salaries: Close
[0m17:11:14.242468 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m17:11:14.242791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181b10>]}
[0m17:11:14.243077 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95419b9a-e746-47e1-b1a9-d1f8ed8de8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109188a50>]}
[0m17:11:14.243321 [info ] [Thread-1 (]: 10 of 10 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.04s]
[0m17:11:14.243572 [info ] [Thread-2 (]: 9 of 10 OK created sql view model bank_warehouse.satisfaction_vs_num_products .. [[32mCREATE VIEW[0m in 0.04s]
[0m17:11:14.243871 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.total_salaries
[0m17:11:14.244112 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m17:11:14.245016 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:14.245171 [debug] [MainThread]: On master: BEGIN
[0m17:11:14.245284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:14.252323 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:14.252582 [debug] [MainThread]: On master: COMMIT
[0m17:11:14.252707 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:14.252819 [debug] [MainThread]: On master: COMMIT
[0m17:11:14.253336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:14.253472 [debug] [MainThread]: On master: Close
[0m17:11:14.253764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:14.253875 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m17:11:14.253977 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m17:11:14.254074 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m17:11:14.254168 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m17:11:14.254314 [info ] [MainThread]: 
[0m17:11:14.254477 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:11:14.255241 [debug] [MainThread]: Command end result
[0m17:11:14.258443 [info ] [MainThread]: 
[0m17:11:14.258641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:14.258798 [info ] [MainThread]: 
[0m17:11:14.258964 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:11:14.259432 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:14.259371 after 0.55 seconds
[0m17:11:14.259620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108759e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bbcd0>]}
[0m17:11:14.259787 [debug] [MainThread]: Flushing usage events
[0m08:51:29.264210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7f90>]}


============================== 08:51:29.266850 | 2ec5c552-b70e-46d7-8e98-627094c14812 ==============================
[0m08:51:29.266850 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:51:29.267203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:51:29.308598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bf190>]}
[0m08:51:29.315496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7510>]}
[0m08:51:29.316082 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m08:51:29.326364 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:51:29.345903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:51:29.346292 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/customers_ by_ctry_code.sql
[0m08:51:29.357251 [debug] [MainThread]: 1699: static parser successfully parsed summaries/customers_ by_ctry_code.sql
[0m08:51:29.386757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048743d0>]}
[0m08:51:29.390390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bf510>]}
[0m08:51:29.390595 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m08:51:29.390778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102585a10>]}
[0m08:51:29.391649 [info ] [MainThread]: 
[0m08:51:29.392015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:51:29.392657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m08:51:29.397394 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m08:51:29.397696 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m08:51:29.397825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:29.496122 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:51:29.497266 [debug] [ThreadPool]: On list_mydb: Close
[0m08:51:29.498591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m08:51:29.502696 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m08:51:29.502910 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m08:51:29.503085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:29.521022 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.521264 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m08:51:29.521489 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m08:51:29.534267 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:51:29.535440 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m08:51:29.536581 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m08:51:29.541499 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:29.541776 [debug] [MainThread]: On master: BEGIN
[0m08:51:29.541978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:29.554536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.554884 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:29.555237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:51:29.584970 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m08:51:29.587909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecbe50>]}
[0m08:51:29.588221 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:29.589082 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:29.589319 [debug] [MainThread]: On master: BEGIN
[0m08:51:29.590653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.590929 [debug] [MainThread]: On master: COMMIT
[0m08:51:29.591134 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:29.591310 [debug] [MainThread]: On master: COMMIT
[0m08:51:29.592003 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:51:29.592200 [debug] [MainThread]: On master: Close
[0m08:51:29.592640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:29.592875 [info ] [MainThread]: 
[0m08:51:29.597069 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m08:51:29.597393 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m08:51:29.597629 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_ by_ctry_code
[0m08:51:29.597959 [info ] [Thread-1 (]: 1 of 11 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m08:51:29.598284 [info ] [Thread-2 (]: 2 of 11 START sql table model bank_warehouse.customers ......................... [RUN]
[0m08:51:29.598697 [info ] [Thread-3 (]: 3 of 11 START sql table model bank_warehouse.customers_ by_ctry_code ........... [RUN]
[0m08:51:29.599212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m08:51:29.599620 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m08:51:29.599999 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_ by_ctry_code'
[0m08:51:29.600194 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m08:51:29.600375 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m08:51:29.600552 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_ by_ctry_code
[0m08:51:29.602617 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m08:51:29.604360 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m08:51:29.605795 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_ by_ctry_code"
[0m08:51:29.606448 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_ by_ctry_code (compile): 08:51:29.604516 => 08:51:29.606310
[0m08:51:29.606741 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_ by_ctry_code
[0m08:51:29.606977 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 08:51:29.602788 => 08:51:29.606864
[0m08:51:29.607186 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 08:51:29.600679 => 08:51:29.607097
[0m08:51:29.633563 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m08:51:29.634581 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_ by_ctry_code"
[0m08:51:29.634830 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m08:51:29.637378 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m08:51:29.639720 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m08:51:29.640128 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_ by_ctry_code"
[0m08:51:29.640350 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: BEGIN
[0m08:51:29.640535 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.640704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:51:29.640890 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m08:51:29.641077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.641308 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:51:29.641468 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m08:51:29.641708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:29.651057 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.651363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.651579 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_ by_ctry_code"
[0m08:51:29.651744 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:29.651928 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.652116 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_ by_ctry_code"} */

  
    

  create  table "mydb"."bank_warehouse"."customers_ by_ctry_code__dbt_tmp"
  
  
    as
  
  (
    

CREATE TABLE customers_by_ctry_code (
    total_balance NUMERIC(15, 2),
    country_code TEXT,
    customer_count INT
)

INSERT INTO customers_by_ctry_code (
    total_balance,
    country_code,
    customer_count
) 
VALUES (
    (153123552.01, 'ES', 2477),
    (311332479.49, 'FR', 5014),
    (300402861.38, 'DE', 2509)
)
  );
  
[0m08:51:29.652292 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.652474 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m08:51:29.652724 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m08:51:29.653494 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 14: CREATE TABLE customers_by_ctry_code (
         ^

[0m08:51:29.653694 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: ROLLBACK
[0m08:51:29.654649 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_ by_ctry_code (execute): 08:51:29.607314 => 08:51:29.654522
[0m08:51:29.654863 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: Close
[0m08:51:29.659952 [debug] [Thread-3 (]: Database Error in model customers_ by_ctry_code (models/summaries/customers_ by_ctry_code.sql)
  syntax error at or near "CREATE"
  LINE 14: CREATE TABLE customers_by_ctry_code (
           ^
  compiled Code at target/run/maker_warehouse/models/summaries/customers_ by_ctry_code.sql
[0m08:51:29.660270 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed85d0>]}
[0m08:51:29.660609 [error] [Thread-3 (]: 3 of 11 ERROR creating sql table model bank_warehouse.customers_ by_ctry_code .. [[31mERROR[0m in 0.06s]
[0m08:51:29.660886 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_ by_ctry_code
[0m08:51:29.672024 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m08:51:29.675845 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.676049 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m08:51:29.676267 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m08:51:29.677651 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.677873 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m08:51:29.678957 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:29.679140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:29.680765 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.682146 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.682322 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m08:51:29.682485 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m08:51:29.683554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:29.683709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:29.694014 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m08:51:29.695076 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m08:51:29.695245 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.695393 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.695531 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m08:51:29.695663 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m08:51:29.702856 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m08:51:29.703077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:51:29.706083 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:51:29.707291 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:51:29.707468 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m08:51:29.707629 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m08:51:30.714130 [debug] [Thread-1 (]: Postgres adapter: Postgres error: deadlock detected
DETAIL:  Process 1372 waits for AccessExclusiveLock on object 27307 of class 2618 of database 16384; blocked by process 1371.
Process 1371 waits for AccessExclusiveLock on object 27317 of class 2618 of database 16384; blocked by process 1372.
HINT:  See server log for query details.

[0m08:51:30.716202 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m08:51:30.717082 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m08:51:30.718387 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 08:51:29.637583 => 08:51:30.717964
[0m08:51:30.719091 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m08:51:30.726084 [debug] [Thread-1 (]: Database Error in model accounts (models/facts/accounts.sql)
  deadlock detected
  DETAIL:  Process 1372 waits for AccessExclusiveLock on object 27307 of class 2618 of database 16384; blocked by process 1371.
  Process 1371 waits for AccessExclusiveLock on object 27317 of class 2618 of database 16384; blocked by process 1372.
  HINT:  See server log for query details.
  compiled Code at target/run/maker_warehouse/models/facts/accounts.sql
[0m08:51:30.726826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e97050>]}
[0m08:51:30.727567 [error] [Thread-1 (]: 1 of 11 ERROR creating sql table model bank_warehouse.accounts ................. [[31mERROR[0m in 1.13s]
[0m08:51:30.728244 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m08:51:30.729095 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m08:51:30.729556 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m08:51:30.730095 [info ] [Thread-4 (]: 4 of 11 SKIP relation bank_warehouse.most_popular_card ......................... [[33mSKIP[0m]
[0m08:51:30.730863 [info ] [Thread-3 (]: 5 of 11 SKIP relation bank_warehouse.total_balance ............................. [[33mSKIP[0m]
[0m08:51:30.731555 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m08:51:30.732014 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m08:51:30.739803 [debug] [Thread-2 (]: SQL status: DROP TABLE in 1.0 seconds
[0m08:51:30.741576 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 08:51:29.634966 => 08:51:30.741389
[0m08:51:30.741953 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m08:51:30.742707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f98410>]}
[0m08:51:30.743275 [info ] [Thread-2 (]: 2 of 11 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 1.14s]
[0m08:51:30.743888 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m08:51:30.744839 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m08:51:30.745245 [debug] [Thread-4 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m08:51:30.745669 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m08:51:30.746051 [info ] [Thread-1 (]: 6 of 11 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m08:51:30.746514 [debug] [Thread-2 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m08:51:30.746926 [info ] [Thread-4 (]: 7 of 11 SKIP relation bank_warehouse.creditscore_balance_ctry .................. [[33mSKIP[0m]
[0m08:51:30.747369 [info ] [Thread-3 (]: 8 of 11 SKIP relation bank_warehouse.customers_by_ctry ......................... [[33mSKIP[0m]
[0m08:51:30.748155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m08:51:30.748615 [info ] [Thread-2 (]: 9 of 11 SKIP relation bank_warehouse.salary_vs_cardtype ........................ [[33mSKIP[0m]
[0m08:51:30.749089 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m08:51:30.749422 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m08:51:30.749697 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m08:51:30.749995 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m08:51:30.750329 [debug] [Thread-4 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m08:51:30.750805 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_salaries
[0m08:51:30.753441 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m08:51:30.754014 [info ] [Thread-4 (]: 10 of 11 START sql view model bank_warehouse.satisfaction_vs_num_products ...... [RUN]
[0m08:51:30.754477 [info ] [Thread-3 (]: 11 of 11 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m08:51:30.755285 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.satisfaction_vs_num_products'
[0m08:51:30.755809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_ by_ctry_code, now model.maker_warehouse.total_salaries)
[0m08:51:30.756131 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m08:51:30.756429 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_salaries
[0m08:51:30.757054 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 08:51:30.751112 => 08:51:30.756587
[0m08:51:30.759111 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.761103 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m08:51:30.761431 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m08:51:30.776788 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m08:51:30.777251 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (compile): 08:51:30.759314 => 08:51:30.777121
[0m08:51:30.777489 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 08:51:30.757252 => 08:51:30.777386
[0m08:51:30.777693 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_salaries
[0m08:51:30.777924 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m08:51:30.778173 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:51:30.781052 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m08:51:30.783598 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.783801 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m08:51:30.784139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:30.784463 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:51:30.784663 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.784886 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m08:51:30.785079 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m08:51:30.785342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:51:30.785563 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:51:30.800804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:30.801112 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:51:30.801297 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m08:51:30.801526 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:30.801796 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:51:30.802028 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m08:51:30.802248 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m08:51:30.802462 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.802674 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m08:51:30.807433 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:51:30.807706 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:51:30.807874 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:51:30.809488 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:51:30.810847 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.812225 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:51:30.812401 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m08:51:30.812575 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m08:51:30.812733 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m08:51:30.813869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:30.814010 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:30.814136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:51:30.814967 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m08:51:30.815696 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m08:51:30.816395 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m08:51:30.816545 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:51:30.816695 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.816835 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:51:30.816968 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m08:51:30.817102 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m08:51:30.817231 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m08:51:30.818535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:51:30.819801 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:51:30.819954 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m08:51:30.820084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m08:51:30.820224 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m08:51:30.821247 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:51:30.822232 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:51:30.822417 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m08:51:30.822573 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m08:51:30.822775 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:51:30.823412 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 08:51:30.761790 => 08:51:30.823331
[0m08:51:30.823547 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:51:30.823676 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:51:30.823819 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m08:51:30.824408 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 08:51:30.781288 => 08:51:30.824333
[0m08:51:30.824966 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_salaries (execute): 08:51:30.778292 => 08:51:30.824893
[0m08:51:30.825312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a52d0>]}
[0m08:51:30.825464 [debug] [Thread-4 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m08:51:30.825624 [debug] [Thread-3 (]: On model.maker_warehouse.total_salaries: Close
[0m08:51:30.825904 [info ] [Thread-1 (]: 6 of 11 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:51:30.826306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebf510>]}
[0m08:51:30.826650 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5c552-b70e-46d7-8e98-627094c14812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f108d0>]}
[0m08:51:30.826898 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m08:51:30.827158 [info ] [Thread-4 (]: 10 of 11 OK created sql view model bank_warehouse.satisfaction_vs_num_products . [[32mCREATE VIEW[0m in 0.07s]
[0m08:51:30.827435 [info ] [Thread-3 (]: 11 of 11 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.07s]
[0m08:51:30.828100 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m08:51:30.828448 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_salaries
[0m08:51:30.830029 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:30.830251 [debug] [MainThread]: On master: BEGIN
[0m08:51:30.830378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:30.837438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:51:30.837670 [debug] [MainThread]: On master: COMMIT
[0m08:51:30.837809 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:30.837929 [debug] [MainThread]: On master: COMMIT
[0m08:51:30.838445 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:51:30.838600 [debug] [MainThread]: On master: Close
[0m08:51:30.838920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:30.839046 [debug] [MainThread]: Connection 'model.maker_warehouse.complaints' was properly closed.
[0m08:51:30.839153 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m08:51:30.839254 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m08:51:30.839353 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m08:51:30.839531 [info ] [MainThread]: 
[0m08:51:30.839718 [info ] [MainThread]: Finished running 3 table models, 8 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m08:51:30.840475 [debug] [MainThread]: Command end result
[0m08:51:30.843962 [info ] [MainThread]: 
[0m08:51:30.844155 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:51:30.844332 [info ] [MainThread]: 
[0m08:51:30.844492 [error] [MainThread]: [33mDatabase Error in model customers_ by_ctry_code (models/summaries/customers_ by_ctry_code.sql)[0m
[0m08:51:30.844634 [error] [MainThread]:   syntax error at or near "CREATE"
[0m08:51:30.844771 [error] [MainThread]:   LINE 14: CREATE TABLE customers_by_ctry_code (
[0m08:51:30.844903 [error] [MainThread]:            ^
[0m08:51:30.845034 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/summaries/customers_ by_ctry_code.sql
[0m08:51:30.845294 [info ] [MainThread]: 
[0m08:51:30.845445 [error] [MainThread]: [33mDatabase Error in model accounts (models/facts/accounts.sql)[0m
[0m08:51:30.845685 [error] [MainThread]:   deadlock detected
[0m08:51:30.845830 [error] [MainThread]:   DETAIL:  Process 1372 waits for AccessExclusiveLock on object 27307 of class 2618 of database 16384; blocked by process 1371.
[0m08:51:30.845968 [error] [MainThread]:   Process 1371 waits for AccessExclusiveLock on object 27317 of class 2618 of database 16384; blocked by process 1372.
[0m08:51:30.846100 [error] [MainThread]:   HINT:  See server log for query details.
[0m08:51:30.846298 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/facts/accounts.sql
[0m08:51:30.846530 [info ] [MainThread]: 
[0m08:51:30.846708 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=5 TOTAL=11
[0m08:51:30.847054 [debug] [MainThread]: Command `dbt run` failed at 08:51:30.847000 after 1.60 seconds
[0m08:51:30.847241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104691ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ff3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ff1250>]}
[0m08:51:30.847420 [debug] [MainThread]: Flushing usage events
[0m08:52:55.529102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a53110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63ed0>]}


============================== 08:52:55.531632 | bf20c917-eaaf-460a-86fe-5346458952df ==============================
[0m08:52:55.531632 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:52:55.531986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:52:55.569418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52fd0>]}
[0m08:52:55.575829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63e50>]}
[0m08:52:55.576150 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m08:52:55.586099 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:52:55.606266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:52:55.606660 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/customers_ by_ctry_code.sql
[0m08:52:55.619580 [debug] [MainThread]: 1699: static parser successfully parsed summaries/customers_ by_ctry_code.sql
[0m08:52:55.651029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107113690>]}
[0m08:52:55.654599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b6f50>]}
[0m08:52:55.654804 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m08:52:55.654987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480dc50>]}
[0m08:52:55.655860 [info ] [MainThread]: 
[0m08:52:55.656227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:55.656914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m08:52:55.661830 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m08:52:55.662055 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m08:52:55.662183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:55.727048 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:52:55.728021 [debug] [ThreadPool]: On list_mydb: Close
[0m08:52:55.729210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m08:52:55.732733 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m08:52:55.732924 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m08:52:55.733074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:55.747617 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.747826 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m08:52:55.748012 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m08:52:55.761319 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m08:52:55.762331 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m08:52:55.763189 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m08:52:55.767009 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.767249 [debug] [MainThread]: On master: BEGIN
[0m08:52:55.767415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:55.778425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.778685 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.778942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:55.804626 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m08:52:55.806533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cd3d0>]}
[0m08:52:55.806801 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:55.807583 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.807755 [debug] [MainThread]: On master: BEGIN
[0m08:52:55.809011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.809244 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.809426 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.809611 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.810345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.810544 [debug] [MainThread]: On master: Close
[0m08:52:55.810962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:55.811198 [info ] [MainThread]: 
[0m08:52:55.815220 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m08:52:55.815513 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m08:52:55.815729 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_ by_ctry_code
[0m08:52:55.816048 [info ] [Thread-1 (]: 1 of 11 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m08:52:55.816374 [info ] [Thread-2 (]: 2 of 11 START sql table model bank_warehouse.customers ......................... [RUN]
[0m08:52:55.816671 [info ] [Thread-3 (]: 3 of 11 START sql view model bank_warehouse.customers_ by_ctry_code ............ [RUN]
[0m08:52:55.817168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m08:52:55.817637 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m08:52:55.818041 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.customers_ by_ctry_code'
[0m08:52:55.818252 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m08:52:55.818444 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m08:52:55.818628 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_ by_ctry_code
[0m08:52:55.820651 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m08:52:55.822404 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m08:52:55.823319 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_ by_ctry_code"
[0m08:52:55.823903 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 08:52:55.818760 => 08:52:55.823767
[0m08:52:55.824152 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 08:52:55.820821 => 08:52:55.824038
[0m08:52:55.824371 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m08:52:55.824577 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m08:52:55.824801 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_ by_ctry_code (compile): 08:52:55.822566 => 08:52:55.824691
[0m08:52:55.844197 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.853349 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m08:52:55.853591 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_ by_ctry_code
[0m08:52:55.853777 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m08:52:55.862681 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_ by_ctry_code"
[0m08:52:55.862921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:55.863106 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.863398 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m08:52:55.863541 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:52:55.863689 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_ by_ctry_code"
[0m08:52:55.863902 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: BEGIN
[0m08:52:55.864034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:52:55.872623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.872936 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.873225 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m08:52:55.875258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.875518 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_ by_ctry_code"
[0m08:52:55.875738 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_ by_ctry_code"} */

  create view "mydb"."bank_warehouse"."customers_ by_ctry_code__dbt_tmp"
    
    
  as (
    CREATE TABLE customers_by_ctry_code (
    total_balance NUMERIC(15, 2),
    country_code TEXT,
    customer_count INT
)

INSERT INTO customers_by_ctry_code (
    total_balance,
    country_code,
    customer_count
) 
VALUES (
    (153123552.01, 'ES', 2477),
    (311332479.49, 'FR', 5014),
    (300402861.38, 'DE', 2509)
)
  );
[0m08:52:55.876897 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE TABLE customers_by_ctry_code (
            ^

[0m08:52:55.877525 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: ROLLBACK
[0m08:52:55.878570 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_ by_ctry_code (execute): 08:52:55.853996 => 08:52:55.878442
[0m08:52:55.878787 [debug] [Thread-3 (]: On model.maker_warehouse.customers_ by_ctry_code: Close
[0m08:52:55.882090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:52:55.883266 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m08:52:55.883689 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.883941 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m08:52:55.884734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.885009 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.885215 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m08:52:55.886587 [debug] [Thread-3 (]: Database Error in model customers_ by_ctry_code (models/summaries/customers_ by_ctry_code.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE TABLE customers_by_ctry_code (
              ^
  compiled Code at target/run/maker_warehouse/models/summaries/customers_ by_ctry_code.sql
[0m08:52:55.886861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107152150>]}
[0m08:52:55.887193 [error] [Thread-3 (]: 3 of 11 ERROR creating sql view model bank_warehouse.customers_ by_ctry_code ... [[31mERROR[0m in 0.07s]
[0m08:52:55.887487 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_ by_ctry_code
[0m08:52:55.895976 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m08:52:55.899348 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.899530 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m08:52:55.899727 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m08:52:55.901226 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.901448 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m08:52:55.902296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.902478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.903863 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.905229 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.905403 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m08:52:55.905566 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m08:52:55.906360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.906526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.916847 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m08:52:55.918007 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m08:52:55.918180 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.918327 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.918468 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m08:52:55.918599 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m08:52:55.926071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.927645 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m08:52:55.927844 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m08:52:55.928195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.929435 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m08:52:55.929599 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m08:52:55.933180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:52:55.933965 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 08:52:55.824949 => 08:52:55.933870
[0m08:52:55.934148 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m08:52:55.934537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731a150>]}
[0m08:52:55.934830 [info ] [Thread-1 (]: 1 of 11 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.12s]
[0m08:52:55.935127 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m08:52:55.935548 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m08:52:55.935819 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m08:52:55.936023 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:52:55.936242 [info ] [Thread-4 (]: 4 of 11 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m08:52:55.936511 [info ] [Thread-3 (]: 5 of 11 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m08:52:55.937400 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 08:52:55.844399 => 08:52:55.937298
[0m08:52:55.937815 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m08:52:55.938187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_ by_ctry_code, now model.maker_warehouse.total_balance)
[0m08:52:55.938393 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m08:52:55.938581 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m08:52:55.938744 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m08:52:55.940332 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m08:52:55.940679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dedd0>]}
[0m08:52:55.943240 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m08:52:55.943969 [info ] [Thread-2 (]: 2 of 11 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.12s]
[0m08:52:55.944341 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 08:52:55.938894 => 08:52:55.944244
[0m08:52:55.944610 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m08:52:55.944786 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m08:52:55.946852 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m08:52:55.947047 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 08:52:55.940823 => 08:52:55.946961
[0m08:52:55.947306 [debug] [Thread-1 (]: Began running node model.maker_warehouse.complaints
[0m08:52:55.947480 [debug] [Thread-2 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m08:52:55.947641 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m08:52:55.947845 [info ] [Thread-1 (]: 6 of 11 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m08:52:55.948072 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m08:52:55.948256 [info ] [Thread-2 (]: 7 of 11 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m08:52:55.950130 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m08:52:55.950432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.complaints)
[0m08:52:55.950591 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m08:52:55.950841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.creditscore_balance_ctry)
[0m08:52:55.951024 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.complaints
[0m08:52:55.951165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:52:55.951317 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m08:52:55.951453 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m08:52:55.952676 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m08:52:55.954012 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.954189 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m08:52:55.954635 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:52:55.954928 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (compile): 08:52:55.951544 => 08:52:55.954832
[0m08:52:55.955095 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.complaints
[0m08:52:55.955265 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 08:52:55.952867 => 08:52:55.955181
[0m08:52:55.957588 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m08:52:55.957848 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m08:52:55.960154 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.960549 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:52:55.960764 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: BEGIN
[0m08:52:55.960947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:55.961106 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.961319 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m08:52:55.961459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:52:55.961755 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.961942 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m08:52:55.962258 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m08:52:55.966570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.966878 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m08:52:55.967020 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:55.967201 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m08:52:55.968689 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m08:52:55.968935 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m08:52:55.969828 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.970033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.971189 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m08:52:55.971352 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:55.971513 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:52:55.971683 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m08:52:55.971830 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.971985 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m08:52:55.972132 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m08:52:55.972294 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score,
    ROUND(AVG(customers.satisfactionscore), 4) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m08:52:55.973364 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:55.973611 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.975086 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m08:52:55.976302 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m08:52:55.976478 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m08:52:55.976633 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m08:52:55.976900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:55.978277 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:52:55.978418 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:55.978550 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:55.978672 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.978815 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m08:52:55.979430 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 08:52:55.944993 => 08:52:55.979349
[0m08:52:55.980701 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.981445 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m08:52:55.981634 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m08:52:55.981829 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m08:52:55.982014 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m08:52:55.982386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b4d90>]}
[0m08:52:55.982556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.982725 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m08:52:55.982995 [info ] [Thread-4 (]: 4 of 11 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.04s]
[0m08:52:55.983854 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m08:52:55.984061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:55.984283 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m08:52:55.984432 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:52:55.985193 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m08:52:55.985327 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.985519 [debug] [Thread-4 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m08:52:55.985700 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: COMMIT
[0m08:52:55.985849 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.987039 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m08:52:55.987268 [info ] [Thread-4 (]: 8 of 11 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m08:52:55.987500 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m08:52:55.987652 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m08:52:55.987947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.customers_by_ctry)
[0m08:52:55.988180 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m08:52:55.988313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.989694 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m08:52:55.989860 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:55.991759 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m08:52:55.991942 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:55.992752 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 08:52:55.948401 => 08:52:55.992673
[0m08:52:55.992928 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m08:52:55.994056 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m08:52:55.994220 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 08:52:55.988430 => 08:52:55.994148
[0m08:52:55.994373 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m08:52:55.994556 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m08:52:55.994743 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m08:52:55.995115 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277190>]}
[0m08:52:55.995267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:55.997280 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m08:52:55.997436 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:55.998365 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.complaints (execute): 08:52:55.955443 => 08:52:55.998285
[0m08:52:55.997697 [info ] [Thread-3 (]: 5 of 11 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.06s]
[0m08:52:55.999058 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 08:52:55.958096 => 08:52:55.998987
[0m08:52:55.999234 [debug] [Thread-1 (]: On model.maker_warehouse.complaints: Close
[0m08:52:55.999479 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m08:52:55.999625 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m08:52:55.999769 [debug] [Thread-2 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m08:52:55.999965 [debug] [Thread-3 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m08:52:56.000246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107331cd0>]}
[0m08:52:56.000436 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m08:52:56.000732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107360510>]}
[0m08:52:56.000904 [info ] [Thread-3 (]: 9 of 11 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m08:52:56.001288 [info ] [Thread-1 (]: 6 of 11 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:52:56.001520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:52:56.001751 [info ] [Thread-2 (]: 7 of 11 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.05s]
[0m08:52:56.002248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.salary_vs_cardtype)
[0m08:52:56.002499 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.complaints
[0m08:52:56.002774 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m08:52:56.002925 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m08:52:56.003104 [debug] [Thread-1 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m08:52:56.003265 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m08:52:56.004769 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.005032 [info ] [Thread-1 (]: 10 of 11 START sql view model bank_warehouse.satisfaction_vs_num_products ...... [RUN]
[0m08:52:56.005294 [info ] [Thread-2 (]: 11 of 11 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m08:52:56.005778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.satisfaction_vs_num_products)
[0m08:52:56.006408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.total_salaries)
[0m08:52:56.006594 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 08:52:56.003412 => 08:52:56.006510
[0m08:52:56.006745 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m08:52:56.006895 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.total_salaries
[0m08:52:56.007039 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m08:52:56.008383 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.009833 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m08:52:56.011912 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.012079 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:56.012404 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m08:52:56.012688 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (compile): 08:52:56.008573 => 08:52:56.012576
[0m08:52:56.012856 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m08:52:56.013045 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.013221 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.total_salaries
[0m08:52:56.013392 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 08:52:56.007141 => 08:52:56.013314
[0m08:52:56.013565 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m08:52:56.015533 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m08:52:56.015714 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m08:52:56.015869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:52:56.017746 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.017903 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:56.018213 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:52:56.019703 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m08:52:56.019918 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m08:52:56.020084 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.020242 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m08:52:56.020396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:52:56.020540 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m08:52:56.020780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:56.021505 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:56.022369 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m08:52:56.022532 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m08:52:56.022672 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m08:52:56.024648 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:56.026248 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m08:52:56.026542 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m08:52:56.027514 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:56.028603 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 08:52:55.995374 => 08:52:56.028423
[0m08:52:56.028768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:56.028969 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m08:52:56.029143 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.029776 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m08:52:56.029574 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107309010>]}
[0m08:52:56.030206 [info ] [Thread-4 (]: 8 of 11 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.04s]
[0m08:52:56.030490 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m08:52:56.031813 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:56.032063 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:52:56.032234 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m08:52:56.032446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:52:56.032647 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.032811 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m08:52:56.037218 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:56.037421 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:56.039064 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.039242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:52:56.040458 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:52:56.040624 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m08:52:56.041864 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.042030 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m08:52:56.042328 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m08:52:56.043422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:56.043611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:56.043776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:52:56.044613 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m08:52:56.045319 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m08:52:56.046012 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m08:52:56.046166 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.046307 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:52:56.046440 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.046569 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m08:52:56.046697 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m08:52:56.046824 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m08:52:56.048010 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:56.050065 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m08:52:56.050225 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:56.050375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:52:56.050532 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m08:52:56.051602 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m08:52:56.052624 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m08:52:56.052816 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m08:52:56.052979 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m08:52:56.053326 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:56.053971 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.total_salaries (execute): 08:52:56.013662 => 08:52:56.053891
[0m08:52:56.054101 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:56.054229 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:52:56.054367 [debug] [Thread-2 (]: On model.maker_warehouse.total_salaries: Close
[0m08:52:56.054923 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 08:52:56.009999 => 08:52:56.054854
[0m08:52:56.055467 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 08:52:56.016013 => 08:52:56.055394
[0m08:52:56.055805 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738f810>]}
[0m08:52:56.055949 [debug] [Thread-3 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m08:52:56.056107 [debug] [Thread-1 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m08:52:56.057101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a85f10>]}
[0m08:52:56.056715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf20c917-eaaf-460a-86fe-5346458952df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729a310>]}
[0m08:52:56.057518 [info ] [Thread-3 (]: 9 of 11 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.05s]
[0m08:52:56.057790 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m08:52:56.056359 [info ] [Thread-2 (]: 11 of 11 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.05s]
[0m08:52:56.058276 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m08:52:56.058541 [info ] [Thread-1 (]: 10 of 11 OK created sql view model bank_warehouse.satisfaction_vs_num_products . [[32mCREATE VIEW[0m in 0.05s]
[0m08:52:56.058800 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m08:52:56.059771 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:56.059949 [debug] [MainThread]: On master: BEGIN
[0m08:52:56.060064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:56.068269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:52:56.068548 [debug] [MainThread]: On master: COMMIT
[0m08:52:56.068672 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:56.068782 [debug] [MainThread]: On master: COMMIT
[0m08:52:56.069353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:52:56.069512 [debug] [MainThread]: On master: Close
[0m08:52:56.069830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:56.069946 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m08:52:56.070049 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m08:52:56.070141 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m08:52:56.070234 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m08:52:56.070382 [info ] [MainThread]: 
[0m08:52:56.070545 [info ] [MainThread]: Finished running 9 view models, 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m08:52:56.071337 [debug] [MainThread]: Command end result
[0m08:52:56.074351 [info ] [MainThread]: 
[0m08:52:56.074563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:56.074761 [info ] [MainThread]: 
[0m08:52:56.074922 [error] [MainThread]: [33mDatabase Error in model customers_ by_ctry_code (models/summaries/customers_ by_ctry_code.sql)[0m
[0m08:52:56.075119 [error] [MainThread]:   syntax error at or near "CREATE"
[0m08:52:56.075292 [error] [MainThread]:   LINE 7:     CREATE TABLE customers_by_ctry_code (
[0m08:52:56.075517 [error] [MainThread]:               ^
[0m08:52:56.075669 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/summaries/customers_ by_ctry_code.sql
[0m08:52:56.075833 [info ] [MainThread]: 
[0m08:52:56.076006 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m08:52:56.076338 [debug] [MainThread]: Command `dbt run` failed at 08:52:56.076291 after 0.56 seconds
[0m08:52:56.076520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a73ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a73f10>]}
[0m08:52:56.076682 [debug] [MainThread]: Flushing usage events
[0m08:55:45.370063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106932810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106933050>]}


============================== 08:55:45.372504 | a625edc9-8c80-432f-9279-d0e256246fd3 ==============================
[0m08:55:45.372504 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:55:45.372877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:55:45.410466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a625edc9-8c80-432f-9279-d0e256246fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693f2d0>]}
[0m08:55:45.416870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a625edc9-8c80-432f-9279-d0e256246fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dc3d0>]}
[0m08:55:45.417207 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m08:55:45.428069 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:55:45.447758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:55:45.448125 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/customers_ by_ctry_code.sql
[0m08:55:45.459683 [debug] [MainThread]: 1603: static parser failed on summaries/customers_ by_ctry_code.sql
[0m08:55:45.461885 [error] [MainThread]: Encountered an error:
Compilation Error in model customers_ by_ctry_code (models/summaries/customers_ by_ctry_code.sql)
  expected token ',', got 'TABLE'
    line 4
      CREATE TABLE IF NOT EXISTS customers_by_ctry_code (
[0m08:55:45.462354 [debug] [MainThread]: Command `dbt run` failed at 08:55:45.462271 after 0.11 seconds
[0m08:55:45.462605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069517d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693f150>]}
[0m08:55:45.462826 [debug] [MainThread]: Flushing usage events
[0m09:12:34.167033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064abdd0>]}


============================== 09:12:34.169600 | 50a038d6-8209-4839-a9ba-af1a1044e96f ==============================
[0m09:12:34.169600 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:12:34.169946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:12:34.209705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfdd0>]}
[0m09:12:34.216274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfdd0>]}
[0m09:12:34.216670 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:12:34.227801 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:12:34.248735 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m09:12:34.249081 [debug] [MainThread]: Partial parsing: added file: maker_warehouse://models/summaries/age_vs_balance.sql
[0m09:12:34.249227 [debug] [MainThread]: Partial parsing: deleted file: maker_warehouse://models/summaries/customers_ by_ctry_code.sql
[0m09:12:34.260994 [debug] [MainThread]: 1699: static parser successfully parsed summaries/age_vs_balance.sql
[0m09:12:34.290364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd60d0>]}
[0m09:12:34.294165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654d790>]}
[0m09:12:34.294376 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:12:34.294568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040519d0>]}
[0m09:12:34.295492 [info ] [MainThread]: 
[0m09:12:34.295885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:34.296539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m09:12:34.301167 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m09:12:34.301333 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m09:12:34.301456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:34.358022 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:12:34.358967 [debug] [ThreadPool]: On list_mydb: Close
[0m09:12:34.360058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m09:12:34.363214 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:12:34.363385 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m09:12:34.363522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:34.379985 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:12:34.380167 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:12:34.380333 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m09:12:34.390134 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m09:12:34.391107 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m09:12:34.391874 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m09:12:34.395546 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:34.395764 [debug] [MainThread]: On master: BEGIN
[0m09:12:34.395919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:34.405482 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:34.405741 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:34.405976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:12:34.425072 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m09:12:34.427625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c25490>]}
[0m09:12:34.427908 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:34.428646 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:34.428819 [debug] [MainThread]: On master: BEGIN
[0m09:12:34.430315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:34.430549 [debug] [MainThread]: On master: COMMIT
[0m09:12:34.430721 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:34.430875 [debug] [MainThread]: On master: COMMIT
[0m09:12:34.431512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:12:34.431701 [debug] [MainThread]: On master: Close
[0m09:12:34.432138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:34.432368 [info ] [MainThread]: 
[0m09:12:34.436400 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m09:12:34.436761 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m09:12:34.437164 [info ] [Thread-1 (]: 1 of 11 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m09:12:34.437550 [info ] [Thread-2 (]: 2 of 11 START sql table model bank_warehouse.customers ......................... [RUN]
[0m09:12:34.438068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m09:12:34.438499 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m09:12:34.438705 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m09:12:34.438886 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m09:12:34.440825 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m09:12:34.442365 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m09:12:34.442883 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 09:12:34.439010 => 09:12:34.442749
[0m09:12:34.443116 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 09:12:34.440989 => 09:12:34.443009
[0m09:12:34.443428 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m09:12:34.443628 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m09:12:34.464922 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m09:12:34.467042 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m09:12:34.467456 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.467636 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.467789 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m09:12:34.467944 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m09:12:34.468083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:34.468217 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:12:34.477060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:34.477337 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:34.477556 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.477751 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.477943 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m09:12:34.478146 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m09:12:34.509961 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:12:34.514221 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.514446 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:12:34.514702 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m09:12:34.516461 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.516759 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m09:12:34.517835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:34.518017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:34.519683 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.521381 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.521597 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m09:12:34.521810 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m09:12:34.522744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:34.522920 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:34.534479 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:12:34.535637 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:12:34.535821 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.535980 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.536132 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:12:34.536274 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:12:34.541790 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:34.541982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:34.544947 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:34.546233 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:34.546416 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m09:12:34.546613 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m09:12:35.553787 [debug] [Thread-2 (]: Postgres adapter: Postgres error: deadlock detected
DETAIL:  Process 1444 waits for AccessExclusiveLock on object 27403 of class 2618 of database 16384; blocked by process 1443.
Process 1443 waits for AccessExclusiveLock on object 27390 of class 2618 of database 16384; blocked by process 1444.
HINT:  See server log for query details.

[0m09:12:35.555423 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m09:12:35.555938 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m09:12:35.556700 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 09:12:34.465106 => 09:12:35.556386
[0m09:12:35.557374 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m09:12:35.570940 [debug] [Thread-2 (]: Database Error in model customers (models/dimensions/customers.sql)
  deadlock detected
  DETAIL:  Process 1444 waits for AccessExclusiveLock on object 27403 of class 2618 of database 16384; blocked by process 1443.
  Process 1443 waits for AccessExclusiveLock on object 27390 of class 2618 of database 16384; blocked by process 1444.
  HINT:  See server log for query details.
  compiled Code at target/run/maker_warehouse/models/dimensions/customers.sql
[0m09:12:35.571823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4cd90>]}
[0m09:12:35.572724 [error] [Thread-2 (]: 2 of 11 ERROR creating sql table model bank_warehouse.customers ................ [[31mERROR[0m in 1.13s]
[0m09:12:35.573640 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m09:12:35.574665 [debug] [Thread-4 (]: Began running node model.maker_warehouse.complaints
[0m09:12:35.575163 [debug] [Thread-3 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:35.575574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 1.0 seconds
[0m09:12:35.575940 [debug] [Thread-2 (]: Began running node model.maker_warehouse.total_salaries
[0m09:12:35.576348 [info ] [Thread-4 (]: 3 of 11 SKIP relation bank_warehouse.complaints ................................ [[33mSKIP[0m]
[0m09:12:35.576908 [info ] [Thread-3 (]: 4 of 11 SKIP relation bank_warehouse.satisfaction_vs_num_products .............. [[33mSKIP[0m]
[0m09:12:35.578692 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 09:12:34.443768 => 09:12:35.578502
[0m09:12:35.579202 [info ] [Thread-2 (]: 5 of 11 SKIP relation bank_warehouse.total_salaries ............................ [[33mSKIP[0m]
[0m09:12:35.579718 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.complaints
[0m09:12:35.580251 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:35.580661 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m09:12:35.581042 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.total_salaries
[0m09:12:35.582278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649b590>]}
[0m09:12:35.582963 [info ] [Thread-1 (]: 1 of 11 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 1.14s]
[0m09:12:35.583736 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m09:12:35.584590 [debug] [Thread-4 (]: Began running node model.maker_warehouse.age_vs_balance
[0m09:12:35.584951 [debug] [Thread-3 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:35.585370 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m09:12:35.585791 [debug] [Thread-1 (]: Began running node model.maker_warehouse.most_popular_card
[0m09:12:35.586202 [info ] [Thread-4 (]: 6 of 11 SKIP relation bank_warehouse.age_vs_balance ............................ [[33mSKIP[0m]
[0m09:12:35.586859 [info ] [Thread-3 (]: 7 of 11 SKIP relation bank_warehouse.creditscore_balance_ctry .................. [[33mSKIP[0m]
[0m09:12:35.587419 [info ] [Thread-2 (]: 8 of 11 SKIP relation bank_warehouse.customers_by_ctry ......................... [[33mSKIP[0m]
[0m09:12:35.587900 [info ] [Thread-1 (]: 9 of 11 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m09:12:35.588453 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.age_vs_balance
[0m09:12:35.588805 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:35.589120 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m09:12:35.589708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.most_popular_card)
[0m09:12:35.590070 [debug] [Thread-4 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m09:12:35.590468 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m09:12:35.590932 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m09:12:35.591258 [info ] [Thread-4 (]: 10 of 11 SKIP relation bank_warehouse.salary_vs_cardtype ....................... [[33mSKIP[0m]
[0m09:12:35.592150 [info ] [Thread-3 (]: 11 of 11 START sql view model bank_warehouse.total_balance ..................... [RUN]
[0m09:12:35.595406 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m09:12:35.595869 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m09:12:35.596495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m09:12:35.597036 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m09:12:35.598930 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m09:12:35.599246 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 09:12:35.592593 => 09:12:35.599100
[0m09:12:35.599563 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.most_popular_card
[0m09:12:35.606292 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 09:12:35.597264 => 09:12:35.606063
[0m09:12:35.614652 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m09:12:35.614981 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m09:12:35.619241 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m09:12:35.619601 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:35.619866 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m09:12:35.620075 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:35.620278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:35.620475 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m09:12:35.620762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:12:35.631791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:35.632154 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:35.632385 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m09:12:35.632623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:35.632893 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:35.633094 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m09:12:35.638425 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:35.638646 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:35.640581 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:35.642417 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:35.642658 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m09:12:35.642869 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m09:12:35.643969 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:35.644162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:35.645194 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:12:35.646165 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:12:35.646371 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:35.646560 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:35.646738 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:12:35.646913 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:12:35.648440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:35.649947 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:35.650135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:35.650338 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m09:12:35.651750 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:35.651992 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m09:12:35.652417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:35.652576 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:35.653330 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 09:12:35.599752 => 09:12:35.653230
[0m09:12:35.654078 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 09:12:35.615280 => 09:12:35.653982
[0m09:12:35.654284 [debug] [Thread-1 (]: On model.maker_warehouse.most_popular_card: Close
[0m09:12:35.654480 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m09:12:35.654901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfa2d0>]}
[0m09:12:35.655292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a038d6-8209-4839-a9ba-af1a1044e96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f88b50>]}
[0m09:12:35.655614 [info ] [Thread-1 (]: 9 of 11 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.07s]
[0m09:12:35.656070 [info ] [Thread-3 (]: 11 of 11 OK created sql view model bank_warehouse.total_balance ................ [[32mCREATE VIEW[0m in 0.06s]
[0m09:12:35.656432 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.most_popular_card
[0m09:12:35.656706 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m09:12:35.657697 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.657860 [debug] [MainThread]: On master: BEGIN
[0m09:12:35.657997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:35.666236 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:35.666486 [debug] [MainThread]: On master: COMMIT
[0m09:12:35.666634 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.666769 [debug] [MainThread]: On master: COMMIT
[0m09:12:35.667331 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:12:35.667514 [debug] [MainThread]: On master: Close
[0m09:12:35.667875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:35.668010 [debug] [MainThread]: Connection 'model.maker_warehouse.most_popular_card' was properly closed.
[0m09:12:35.668139 [debug] [MainThread]: Connection 'model.maker_warehouse.customers' was properly closed.
[0m09:12:35.668283 [debug] [MainThread]: Connection 'model.maker_warehouse.total_balance' was properly closed.
[0m09:12:35.668466 [info ] [MainThread]: 
[0m09:12:35.668669 [info ] [MainThread]: Finished running 2 table models, 9 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m09:12:35.669295 [debug] [MainThread]: Command end result
[0m09:12:35.673393 [info ] [MainThread]: 
[0m09:12:35.673709 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:12:35.673952 [info ] [MainThread]: 
[0m09:12:35.674187 [error] [MainThread]: [33mDatabase Error in model customers (models/dimensions/customers.sql)[0m
[0m09:12:35.674374 [error] [MainThread]:   deadlock detected
[0m09:12:35.674546 [error] [MainThread]:   DETAIL:  Process 1444 waits for AccessExclusiveLock on object 27403 of class 2618 of database 16384; blocked by process 1443.
[0m09:12:35.674707 [error] [MainThread]:   Process 1443 waits for AccessExclusiveLock on object 27390 of class 2618 of database 16384; blocked by process 1444.
[0m09:12:35.674866 [error] [MainThread]:   HINT:  See server log for query details.
[0m09:12:35.675019 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/dimensions/customers.sql
[0m09:12:35.675188 [info ] [MainThread]: 
[0m09:12:35.675378 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=7 TOTAL=11
[0m09:12:35.675722 [debug] [MainThread]: Command `dbt run` failed at 09:12:35.675671 after 1.52 seconds
[0m09:12:35.675925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102abf010>]}
[0m09:12:35.676112 [debug] [MainThread]: Flushing usage events
[0m09:12:53.271581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a27950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b290>]}


============================== 09:12:53.274096 | f074c974-fb0b-4ab1-948d-c3d8cda76092 ==============================
[0m09:12:53.274096 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:12:53.274446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:12:53.311751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae42d0>]}
[0m09:12:53.318181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47e50>]}
[0m09:12:53.318496 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:12:53.329283 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:12:53.346050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:53.346276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:53.349714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070060d0>]}
[0m09:12:53.352967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1ba50>]}
[0m09:12:53.353172 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:12:53.353360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c1c50>]}
[0m09:12:53.354395 [info ] [MainThread]: 
[0m09:12:53.354849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:53.355576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m09:12:53.360687 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m09:12:53.360895 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m09:12:53.361022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:53.420783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:12:53.421875 [debug] [ThreadPool]: On list_mydb: Close
[0m09:12:53.423112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m09:12:53.426894 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:12:53.427165 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m09:12:53.427313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:53.435697 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.435963 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:12:53.436155 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m09:12:53.441309 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m09:12:53.442169 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m09:12:53.442788 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m09:12:53.463240 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.463466 [debug] [MainThread]: On master: BEGIN
[0m09:12:53.463582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:53.471000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.471179 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.471385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:12:53.485181 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m09:12:53.486919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47190>]}
[0m09:12:53.487176 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:53.487912 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.488100 [debug] [MainThread]: On master: BEGIN
[0m09:12:53.489223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.489415 [debug] [MainThread]: On master: COMMIT
[0m09:12:53.489570 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.489708 [debug] [MainThread]: On master: COMMIT
[0m09:12:53.490351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.490528 [debug] [MainThread]: On master: Close
[0m09:12:53.490929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:53.491153 [info ] [MainThread]: 
[0m09:12:53.494779 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m09:12:53.495040 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m09:12:53.495340 [info ] [Thread-1 (]: 1 of 11 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m09:12:53.495619 [info ] [Thread-2 (]: 2 of 11 START sql table model bank_warehouse.customers ......................... [RUN]
[0m09:12:53.496080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m09:12:53.496564 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m09:12:53.496744 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m09:12:53.496907 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m09:12:53.498567 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m09:12:53.500068 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m09:12:53.500553 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 09:12:53.498710 => 09:12:53.500443
[0m09:12:53.500755 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 09:12:53.497022 => 09:12:53.500670
[0m09:12:53.500894 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m09:12:53.501042 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m09:12:53.516080 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.523999 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m09:12:53.524531 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m09:12:53.524771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:12:53.525368 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.525521 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m09:12:53.525655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:53.532557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.532843 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.533024 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m09:12:53.537785 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:12:53.538928 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m09:12:53.539321 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.539485 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m09:12:53.540225 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.540445 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.540644 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m09:12:53.546277 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:12:53.549974 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.550192 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m09:12:53.551143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.552740 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.552942 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m09:12:53.553853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.560382 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:12:53.564899 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:12:53.566426 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.566605 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.566767 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m09:12:53.566918 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:12:53.567982 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.570173 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.570361 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m09:12:53.571340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.572496 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:12:53.572675 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.572834 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:12:53.572991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.574248 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:12:53.574432 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m09:12:53.576560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.577787 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:12:53.577963 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m09:12:53.578999 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:12:53.579772 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 09:12:53.516235 => 09:12:53.579672
[0m09:12:53.579957 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m09:12:53.580346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114f10>]}
[0m09:12:53.580504 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:12:53.580821 [info ] [Thread-1 (]: 1 of 11 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.08s]
[0m09:12:53.581557 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 09:12:53.501144 => 09:12:53.581472
[0m09:12:53.581853 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m09:12:53.582038 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m09:12:53.582509 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m09:12:53.582667 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m09:12:53.583037 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0dad0>]}
[0m09:12:53.583269 [info ] [Thread-4 (]: 3 of 11 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m09:12:53.583585 [info ] [Thread-3 (]: 4 of 11 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m09:12:53.583943 [info ] [Thread-2 (]: 2 of 11 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.09s]
[0m09:12:53.584576 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m09:12:53.584953 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m09:12:53.585259 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m09:12:53.585473 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m09:12:53.585637 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m09:12:53.587484 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m09:12:53.587680 [debug] [Thread-1 (]: Began running node model.maker_warehouse.age_vs_balance
[0m09:12:53.587849 [debug] [Thread-2 (]: Began running node model.maker_warehouse.complaints
[0m09:12:53.589180 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m09:12:53.589478 [info ] [Thread-1 (]: 5 of 11 START sql view model bank_warehouse.age_vs_balance ..................... [RUN]
[0m09:12:53.589758 [info ] [Thread-2 (]: 6 of 11 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m09:12:53.590260 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 09:12:53.585959 => 09:12:53.590154
[0m09:12:53.590630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.age_vs_balance)
[0m09:12:53.590923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.complaints)
[0m09:12:53.591103 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 09:12:53.587977 => 09:12:53.591016
[0m09:12:53.591267 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m09:12:53.591415 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.age_vs_balance
[0m09:12:53.591553 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.complaints
[0m09:12:53.591700 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m09:12:53.600631 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m09:12:53.601839 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.age_vs_balance"
[0m09:12:53.602975 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m09:12:53.604811 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m09:12:53.605353 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:53.605522 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m09:12:53.605776 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.age_vs_balance (compile): 09:12:53.600772 => 09:12:53.605670
[0m09:12:53.605945 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:53.606107 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:12:53.606317 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.age_vs_balance
[0m09:12:53.606488 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.complaints (compile): 09:12:53.601977 => 09:12:53.606414
[0m09:12:53.606647 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m09:12:53.608908 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.age_vs_balance"
[0m09:12:53.609123 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.complaints
[0m09:12:53.609289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:12:53.611236 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m09:12:53.611560 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:12:53.611732 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: BEGIN
[0m09:12:53.611903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:53.612383 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:12:53.612568 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: BEGIN
[0m09:12:53.612706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:53.615312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.615507 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:53.615664 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m09:12:53.620767 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.621140 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:53.621306 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m09:12:53.622217 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.624049 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:53.624276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.624457 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m09:12:53.624606 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:12:53.624826 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.age_vs_balance"} */

  create view "mydb"."bank_warehouse"."age_vs_balance__dbt_tmp"
    
    
  as (
    SELECT 
    customers.age,
    ROUND(AVG(accounts.balance), 2) AS avg_account_balance,
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.age
  );
[0m09:12:53.625070 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.626807 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:53.626964 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.627085 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.627242 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 10: FROM "mydb"."bank_warehouse"."accounts"
         ^

[0m09:12:53.627421 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m09:12:53.627572 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:12:53.628374 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:12:53.628531 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: ROLLBACK
[0m09:12:53.628724 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m09:12:53.628888 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:53.629162 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:12:53.629685 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.age_vs_balance (execute): 09:12:53.606855 => 09:12:53.629595
[0m09:12:53.629845 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: Close
[0m09:12:53.629984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.630874 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.631752 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:12:53.633771 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:12:53.633971 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:53.634162 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m09:12:53.634325 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:12:53.634688 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.636080 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:12:53.636259 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.636403 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m09:12:53.636545 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.637606 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:12:53.638326 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 09:12:53.591801 => 09:12:53.638247
[0m09:12:53.638511 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.638659 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m09:12:53.638861 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m09:12:53.639657 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: COMMIT
[0m09:12:53.640110 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2c410>]}
[0m09:12:53.640309 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:12:53.640470 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.640933 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: COMMIT
[0m09:12:53.640746 [info ] [Thread-4 (]: 3 of 11 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.06s]
[0m09:12:53.641841 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 09:12:53.603106 => 09:12:53.641746
[0m09:12:53.642368 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m09:12:53.642592 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m09:12:53.642926 [debug] [Thread-4 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:53.643226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.643692 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107178d50>]}
[0m09:12:53.643963 [info ] [Thread-4 (]: 7 of 11 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m09:12:53.645206 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:12:53.645507 [info ] [Thread-3 (]: 4 of 11 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:12:53.645968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.creditscore_balance_ctry)
[0m09:12:53.646665 [debug] [Thread-1 (]: Database Error in model age_vs_balance (models/summaries/age_vs_balance.sql)
  syntax error at or near "FROM"
  LINE 10: FROM "mydb"."bank_warehouse"."accounts"
           ^
  compiled Code at target/run/maker_warehouse/models/summaries/age_vs_balance.sql
[0m09:12:53.646831 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m09:12:53.647067 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m09:12:53.647222 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:53.647419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f70950>]}
[0m09:12:53.647634 [debug] [Thread-3 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m09:12:53.649247 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.649407 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.649648 [error] [Thread-1 (]: 5 of 11 ERROR creating sql view model bank_warehouse.age_vs_balance ............ [[31mERROR[0m in 0.06s]
[0m09:12:53.649905 [info ] [Thread-3 (]: 8 of 11 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m09:12:53.650675 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.complaints (execute): 09:12:53.609451 => 09:12:53.650597
[0m09:12:53.650859 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.age_vs_balance
[0m09:12:53.651159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.customers_by_ctry)
[0m09:12:53.651331 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: Close
[0m09:12:53.651497 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 09:12:53.647765 => 09:12:53.651424
[0m09:12:53.651664 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m09:12:53.651852 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m09:12:53.652014 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:53.652288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b610>]}
[0m09:12:53.652495 [info ] [Thread-1 (]: 9 of 11 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m09:12:53.654103 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.656275 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.656973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.age_vs_balance, now model.maker_warehouse.salary_vs_cardtype)
[0m09:12:53.656644 [info ] [Thread-2 (]: 6 of 11 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.06s]
[0m09:12:53.657321 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m09:12:53.657591 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.complaints
[0m09:12:53.657774 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 09:12:53.652658 => 09:12:53.657691
[0m09:12:53.657932 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.659261 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.659459 [debug] [Thread-2 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:53.659646 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m09:12:53.659801 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m09:12:53.660019 [info ] [Thread-2 (]: 10 of 11 START sql view model bank_warehouse.satisfaction_vs_num_products ...... [RUN]
[0m09:12:53.662109 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.662322 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 09:12:53.658028 => 09:12:53.662242
[0m09:12:53.662452 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:53.662756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.satisfaction_vs_num_products)
[0m09:12:53.662977 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m09:12:53.663201 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.663353 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:53.665279 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.665484 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m09:12:53.666718 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.666970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:53.667192 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.667545 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m09:12:53.667728 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 09:12:53.665599 => 09:12:53.667628
[0m09:12:53.667874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:53.668044 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:53.670246 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.670728 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.670906 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m09:12:53.671051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:53.672361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.672625 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.672836 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score,
    ROUND(AVG(customers.satisfactionscore), 4) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m09:12:53.677345 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.677614 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.677784 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m09:12:53.678839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.679077 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.679251 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m09:12:53.680011 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.680177 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.680359 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.681938 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.682132 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m09:12:53.682319 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m09:12:53.683308 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.683472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.684867 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.685027 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.685870 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m09:12:53.686026 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.686184 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m09:12:53.688415 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.688630 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.689938 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.690175 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m09:12:53.690381 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m09:12:53.690545 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m09:12:53.691094 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.691903 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m09:12:53.692060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.692218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.692350 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.692468 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.693203 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m09:12:53.693901 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m09:12:53.694043 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m09:12:53.695134 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:12:53.695282 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.695431 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.695616 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m09:12:53.695780 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m09:12:53.695931 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m09:12:53.696190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.697308 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:12:53.697449 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.697578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.697703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.697848 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m09:12:53.698468 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 09:12:53.654286 => 09:12:53.698387
[0m09:12:53.699438 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:12:53.700490 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:12:53.700674 [debug] [Thread-4 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m09:12:53.700825 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m09:12:53.700994 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m09:12:53.701137 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.701472 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107179190>]}
[0m09:12:53.702163 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 09:12:53.660191 => 09:12:53.702080
[0m09:12:53.702307 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.702440 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.702702 [info ] [Thread-4 (]: 7 of 11 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.06s]
[0m09:12:53.702921 [debug] [Thread-3 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m09:12:53.703652 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 09:12:53.663454 => 09:12:53.703576
[0m09:12:53.704258 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 09:12:53.668241 => 09:12:53.704183
[0m09:12:53.704489 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m09:12:53.704848 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107146510>]}
[0m09:12:53.704999 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m09:12:53.705175 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m09:12:53.705374 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m09:12:53.705776 [info ] [Thread-3 (]: 8 of 11 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.05s]
[0m09:12:53.706601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8590>]}
[0m09:12:53.706992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d9790>]}
[0m09:12:53.707193 [info ] [Thread-4 (]: 11 of 11 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m09:12:53.707495 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m09:12:53.707769 [info ] [Thread-1 (]: 9 of 11 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.05s]
[0m09:12:53.708072 [info ] [Thread-2 (]: 10 of 11 OK created sql view model bank_warehouse.satisfaction_vs_num_products . [[32mCREATE VIEW[0m in 0.04s]
[0m09:12:53.708525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.creditscore_balance_ctry, now model.maker_warehouse.total_salaries)
[0m09:12:53.708843 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m09:12:53.709063 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:12:53.709219 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m09:12:53.710801 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m09:12:53.711179 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 09:12:53.709412 => 09:12:53.711096
[0m09:12:53.711329 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m09:12:53.713200 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m09:12:53.713460 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:12:53.713610 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m09:12:53.713733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:53.720698 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.720970 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:12:53.721131 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m09:12:53.724459 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:12:53.725992 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:12:53.726158 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m09:12:53.727002 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:12:53.727932 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m09:12:53.728085 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:12:53.728218 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m09:12:53.729007 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.729987 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:12:53.730143 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m09:12:53.730708 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:12:53.731301 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 09:12:53.711420 => 09:12:53.731226
[0m09:12:53.731449 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m09:12:53.731771 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f074c974-fb0b-4ab1-948d-c3d8cda76092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d30d0>]}
[0m09:12:53.732023 [info ] [Thread-4 (]: 11 of 11 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.02s]
[0m09:12:53.732289 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m09:12:53.733035 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.733173 [debug] [MainThread]: On master: BEGIN
[0m09:12:53.733282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:53.740374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:12:53.740626 [debug] [MainThread]: On master: COMMIT
[0m09:12:53.740770 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:53.740879 [debug] [MainThread]: On master: COMMIT
[0m09:12:53.741349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:12:53.741499 [debug] [MainThread]: On master: Close
[0m09:12:53.741809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:53.741924 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m09:12:53.742029 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m09:12:53.742130 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m09:12:53.742230 [debug] [MainThread]: Connection 'model.maker_warehouse.customers_by_ctry' was properly closed.
[0m09:12:53.742386 [info ] [MainThread]: 
[0m09:12:53.742557 [info ] [MainThread]: Finished running 2 table models, 9 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m09:12:53.743338 [debug] [MainThread]: Command end result
[0m09:12:53.746669 [info ] [MainThread]: 
[0m09:12:53.746888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:12:53.747035 [info ] [MainThread]: 
[0m09:12:53.747183 [error] [MainThread]: [33mDatabase Error in model age_vs_balance (models/summaries/age_vs_balance.sql)[0m
[0m09:12:53.747334 [error] [MainThread]:   syntax error at or near "FROM"
[0m09:12:53.747470 [error] [MainThread]:   LINE 10: FROM "mydb"."bank_warehouse"."accounts"
[0m09:12:53.747608 [error] [MainThread]:            ^
[0m09:12:53.747803 [error] [MainThread]:   compiled Code at target/run/maker_warehouse/models/summaries/age_vs_balance.sql
[0m09:12:53.747988 [info ] [MainThread]: 
[0m09:12:53.748185 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m09:12:53.748546 [debug] [MainThread]: Command `dbt run` failed at 09:12:53.748502 after 0.49 seconds
[0m09:12:53.748728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a27f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2f010>]}
[0m09:12:53.748896 [debug] [MainThread]: Flushing usage events
[0m09:13:20.040839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866bf90>]}


============================== 09:13:20.043297 | 25f959f4-550d-4338-b941-4734388467f6 ==============================
[0m09:13:20.043297 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:13:20.043657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse', 'log_path': '/Users/robertphillips/Documents/data-warehousing/bank_warehouse/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:13:20.080980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866a810>]}
[0m09:13:20.087403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107455c50>]}
[0m09:13:20.087763 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m09:13:20.097752 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:13:20.117239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:13:20.117597 [debug] [MainThread]: Partial parsing: updated file: maker_warehouse://models/summaries/age_vs_balance.sql
[0m09:13:20.129325 [debug] [MainThread]: 1699: static parser successfully parsed summaries/age_vs_balance.sql
[0m09:13:20.163881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e12e10>]}
[0m09:13:20.167477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cbeed0>]}
[0m09:13:20.167707 [info ] [MainThread]: Found 11 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m09:13:20.167905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106415c50>]}
[0m09:13:20.168816 [info ] [MainThread]: 
[0m09:13:20.169210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:13:20.169853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydb'
[0m09:13:20.174950 [debug] [ThreadPool]: Using postgres connection "list_mydb"
[0m09:13:20.175176 [debug] [ThreadPool]: On list_mydb: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb"} */

    select distinct nspname from pg_namespace
  
[0m09:13:20.175299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:20.223093 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:13:20.224001 [debug] [ThreadPool]: On list_mydb: Close
[0m09:13:20.225087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydb, now list_mydb_bank_warehouse)
[0m09:13:20.228265 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:13:20.228446 [debug] [ThreadPool]: On list_mydb_bank_warehouse: BEGIN
[0m09:13:20.228585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:20.242682 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.242912 [debug] [ThreadPool]: Using postgres connection "list_mydb_bank_warehouse"
[0m09:13:20.243074 [debug] [ThreadPool]: On list_mydb_bank_warehouse: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "list_mydb_bank_warehouse"} */
select
      'mydb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bank_warehouse'
    union all
    select
      'mydb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bank_warehouse'
  
[0m09:13:20.250872 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m09:13:20.251860 [debug] [ThreadPool]: On list_mydb_bank_warehouse: ROLLBACK
[0m09:13:20.252645 [debug] [ThreadPool]: On list_mydb_bank_warehouse: Close
[0m09:13:20.256536 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.256782 [debug] [MainThread]: On master: BEGIN
[0m09:13:20.256935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:13:20.265803 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.266089 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.266339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:13:20.277288 [debug] [MainThread]: SQL status: SELECT 33 in 0.0 seconds
[0m09:13:20.279684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0be50>]}
[0m09:13:20.279928 [debug] [MainThread]: On master: ROLLBACK
[0m09:13:20.280680 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.280846 [debug] [MainThread]: On master: BEGIN
[0m09:13:20.282202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.282428 [debug] [MainThread]: On master: COMMIT
[0m09:13:20.282584 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.282731 [debug] [MainThread]: On master: COMMIT
[0m09:13:20.283307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.283496 [debug] [MainThread]: On master: Close
[0m09:13:20.283882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:20.284098 [info ] [MainThread]: 
[0m09:13:20.287350 [debug] [Thread-1 (]: Began running node model.maker_warehouse.accounts
[0m09:13:20.287582 [debug] [Thread-2 (]: Began running node model.maker_warehouse.customers
[0m09:13:20.287851 [info ] [Thread-1 (]: 1 of 11 START sql table model bank_warehouse.accounts .......................... [RUN]
[0m09:13:20.288139 [info ] [Thread-2 (]: 2 of 11 START sql table model bank_warehouse.customers ......................... [RUN]
[0m09:13:20.288594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydb_bank_warehouse, now model.maker_warehouse.accounts)
[0m09:13:20.289203 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.maker_warehouse.customers'
[0m09:13:20.289495 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.accounts
[0m09:13:20.289685 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.customers
[0m09:13:20.291524 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.accounts"
[0m09:13:20.292947 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.customers"
[0m09:13:20.293551 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (compile): 09:13:20.291689 => 09:13:20.293450
[0m09:13:20.293744 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (compile): 09:13:20.289822 => 09:13:20.293654
[0m09:13:20.294010 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.customers
[0m09:13:20.294170 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.accounts
[0m09:13:20.314406 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.customers"
[0m09:13:20.316468 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.accounts"
[0m09:13:20.316931 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.317107 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.317276 [debug] [Thread-2 (]: On model.maker_warehouse.customers: BEGIN
[0m09:13:20.317421 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: BEGIN
[0m09:13:20.317561 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:13:20.317691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:20.326814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.327124 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.327336 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.327540 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */

  
    

  create  table "mydb"."bank_warehouse"."accounts__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    cardtype,
    balance,
    pointearned,
    customerid
FROM mydb.public.raw_banking
  );
  
[0m09:13:20.327739 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.327958 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */

  
    

  create  table "mydb"."bank_warehouse"."customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customerid,
    surname,
    gender,
    age,
    geography,
    tenure,
    estimatedsalary,
    isactivemember,
    exited,
    complain,
    satisfactionscore,
    numofproducts,
    hascrcard,
    creditscore
FROM mydb.public.raw_banking
  );
  
[0m09:13:20.339978 [debug] [Thread-1 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:13:20.343680 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.343875 [debug] [Thread-2 (]: SQL status: SELECT 10000 in 0.0 seconds
[0m09:13:20.344104 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts" rename to "accounts__dbt_backup"
[0m09:13:20.345641 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.345883 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers" rename to "customers__dbt_backup"
[0m09:13:20.346651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.348042 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.348211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.348356 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
alter table "mydb"."bank_warehouse"."accounts__dbt_tmp" rename to "accounts"
[0m09:13:20.349812 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.350016 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
alter table "mydb"."bank_warehouse"."customers__dbt_tmp" rename to "customers"
[0m09:13:20.350619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.350769 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.361107 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:13:20.362152 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:13:20.362315 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.362460 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.362597 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: COMMIT
[0m09:13:20.362731 [debug] [Thread-2 (]: On model.maker_warehouse.customers: COMMIT
[0m09:13:20.368529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.368733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.371747 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.accounts"
[0m09:13:20.373012 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.customers"
[0m09:13:20.373206 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.accounts"} */
drop table if exists "mydb"."bank_warehouse"."accounts__dbt_backup" cascade
[0m09:13:20.373391 [debug] [Thread-2 (]: On model.maker_warehouse.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers"} */
drop table if exists "mydb"."bank_warehouse"."customers__dbt_backup" cascade
[0m09:13:20.379990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:13:20.380888 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.accounts (execute): 09:13:20.314561 => 09:13:20.380785
[0m09:13:20.381089 [debug] [Thread-1 (]: On model.maker_warehouse.accounts: Close
[0m09:13:20.381504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb8690>]}
[0m09:13:20.381833 [info ] [Thread-1 (]: 1 of 11 OK created sql table model bank_warehouse.accounts ..................... [[32mSELECT 10000[0m in 0.09s]
[0m09:13:20.382313 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.accounts
[0m09:13:20.382681 [debug] [Thread-4 (]: Began running node model.maker_warehouse.most_popular_card
[0m09:13:20.382876 [debug] [Thread-3 (]: Began running node model.maker_warehouse.total_balance
[0m09:13:20.383126 [info ] [Thread-4 (]: 3 of 11 START sql view model bank_warehouse.most_popular_card .................. [RUN]
[0m09:13:20.383531 [info ] [Thread-3 (]: 4 of 11 START sql view model bank_warehouse.total_balance ...................... [RUN]
[0m09:13:20.384083 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.maker_warehouse.most_popular_card'
[0m09:13:20.384281 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:13:20.384652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.maker_warehouse.total_balance'
[0m09:13:20.384846 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.most_popular_card
[0m09:13:20.385639 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.customers (execute): 09:13:20.294279 => 09:13:20.385544
[0m09:13:20.385818 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.total_balance
[0m09:13:20.387403 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.most_popular_card"
[0m09:13:20.387618 [debug] [Thread-2 (]: On model.maker_warehouse.customers: Close
[0m09:13:20.388981 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.total_balance"
[0m09:13:20.389601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870d650>]}
[0m09:13:20.390003 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (compile): 09:13:20.385941 => 09:13:20.389894
[0m09:13:20.390225 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (compile): 09:13:20.387749 => 09:13:20.390124
[0m09:13:20.390681 [info ] [Thread-2 (]: 2 of 11 OK created sql table model bank_warehouse.customers .................... [[32mSELECT 10000[0m in 0.10s]
[0m09:13:20.390960 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.most_popular_card
[0m09:13:20.391237 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.total_balance
[0m09:13:20.391563 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.customers
[0m09:13:20.400746 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.most_popular_card"
[0m09:13:20.403572 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.total_balance"
[0m09:13:20.403996 [debug] [Thread-1 (]: Began running node model.maker_warehouse.age_vs_balance
[0m09:13:20.404194 [debug] [Thread-2 (]: Began running node model.maker_warehouse.complaints
[0m09:13:20.404808 [info ] [Thread-1 (]: 5 of 11 START sql view model bank_warehouse.age_vs_balance ..................... [RUN]
[0m09:13:20.405299 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:13:20.405457 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:13:20.405667 [info ] [Thread-2 (]: 6 of 11 START sql view model bank_warehouse.complaints ......................... [RUN]
[0m09:13:20.406059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.accounts, now model.maker_warehouse.age_vs_balance)
[0m09:13:20.406236 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: BEGIN
[0m09:13:20.406378 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: BEGIN
[0m09:13:20.406634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers, now model.maker_warehouse.complaints)
[0m09:13:20.406797 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.age_vs_balance
[0m09:13:20.406963 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:13:20.407114 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:13:20.407273 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.complaints
[0m09:13:20.408699 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.age_vs_balance"
[0m09:13:20.410060 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.complaints"
[0m09:13:20.410524 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.age_vs_balance (compile): 09:13:20.407392 => 09:13:20.410422
[0m09:13:20.410684 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.age_vs_balance
[0m09:13:20.412668 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.age_vs_balance"
[0m09:13:20.412919 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.complaints (compile): 09:13:20.408955 => 09:13:20.412827
[0m09:13:20.413110 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.complaints
[0m09:13:20.415051 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.complaints"
[0m09:13:20.415328 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:13:20.415487 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: BEGIN
[0m09:13:20.415671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:20.415817 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:13:20.416074 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: BEGIN
[0m09:13:20.416207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:13:20.416637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.416843 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:13:20.417022 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */

  create view "mydb"."bank_warehouse"."total_balance__dbt_tmp"
    
    
  as (
    SELECT SUM(balance) AS total_balance 
FROM "mydb"."bank_warehouse"."accounts"
  );
[0m09:13:20.417792 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.417975 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:13:20.418162 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */

  create view "mydb"."bank_warehouse"."most_popular_card__dbt_tmp"
    
    
  as (
    SELECT 
    COUNT(*) AS amount_of_cardtype,
    cardtype
FROM "mydb"."bank_warehouse"."accounts"
GROUP BY cardtype
  );
[0m09:13:20.420761 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.422543 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:13:20.422792 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.423046 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
alter table "mydb"."bank_warehouse"."total_balance__dbt_tmp" rename to "total_balance"
[0m09:13:20.424600 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:13:20.424862 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
alter table "mydb"."bank_warehouse"."most_popular_card__dbt_tmp" rename to "most_popular_card"
[0m09:13:20.425546 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.426457 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:13:20.426647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.426827 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.426965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.427101 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:13:20.427904 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:13:20.428066 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:13:20.428224 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:13:20.428380 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: COMMIT
[0m09:13:20.428525 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:13:20.428673 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */

  create view "mydb"."bank_warehouse"."complaints__dbt_tmp"
    
    
  as (
    SELECT 
    ROUND(AVG(age), 1) AS avg_age,
    complain, 
    exited
FROM "mydb"."bank_warehouse"."customers"
GROUP BY complain, exited
  );
[0m09:13:20.428830 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.age_vs_balance"} */

  create view "mydb"."bank_warehouse"."age_vs_balance__dbt_tmp"
    
    
  as (
    SELECT 
    customers.age,
    ROUND(AVG(accounts.balance), 2) AS avg_account_balance
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.age
  );
[0m09:13:20.428999 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: COMMIT
[0m09:13:20.429846 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.431107 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.total_balance"
[0m09:13:20.431251 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.431407 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_balance"} */
drop view if exists "mydb"."bank_warehouse"."total_balance__dbt_backup" cascade
[0m09:13:20.432505 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.most_popular_card"
[0m09:13:20.432724 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.most_popular_card"} */
drop view if exists "mydb"."bank_warehouse"."most_popular_card__dbt_backup" cascade
[0m09:13:20.433281 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.433419 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.433564 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.434200 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.total_balance (execute): 09:13:20.400898 => 09:13:20.434125
[0m09:13:20.434337 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.434917 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.most_popular_card (execute): 09:13:20.391698 => 09:13:20.434844
[0m09:13:20.436111 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:13:20.436271 [debug] [Thread-3 (]: On model.maker_warehouse.total_balance: Close
[0m09:13:20.437546 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:13:20.437701 [debug] [Thread-4 (]: On model.maker_warehouse.most_popular_card: Close
[0m09:13:20.437846 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
alter table "mydb"."bank_warehouse"."complaints__dbt_tmp" rename to "complaints"
[0m09:13:20.438209 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea7bd0>]}
[0m09:13:20.438358 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.age_vs_balance"} */
alter table "mydb"."bank_warehouse"."age_vs_balance__dbt_tmp" rename to "age_vs_balance"
[0m09:13:20.438670 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd9650>]}
[0m09:13:20.439136 [info ] [Thread-3 (]: 4 of 11 OK created sql view model bank_warehouse.total_balance ................. [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.439762 [info ] [Thread-4 (]: 3 of 11 OK created sql view model bank_warehouse.most_popular_card ............. [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.440008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.440232 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.total_balance
[0m09:13:20.440504 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.most_popular_card
[0m09:13:20.440639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.441600 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: COMMIT
[0m09:13:20.441817 [debug] [Thread-3 (]: Began running node model.maker_warehouse.creditscore_balance_ctry
[0m09:13:20.441984 [debug] [Thread-4 (]: Began running node model.maker_warehouse.customers_by_ctry
[0m09:13:20.442842 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: COMMIT
[0m09:13:20.443009 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:13:20.443219 [info ] [Thread-3 (]: 7 of 11 START sql view model bank_warehouse.creditscore_balance_ctry ........... [RUN]
[0m09:13:20.443449 [info ] [Thread-4 (]: 8 of 11 START sql view model bank_warehouse.customers_by_ctry .................. [RUN]
[0m09:13:20.443643 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:13:20.443787 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: COMMIT
[0m09:13:20.444069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.total_balance, now model.maker_warehouse.creditscore_balance_ctry)
[0m09:13:20.444321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.most_popular_card, now model.maker_warehouse.customers_by_ctry)
[0m09:13:20.444454 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: COMMIT
[0m09:13:20.444630 [debug] [Thread-3 (]: Began compiling node model.maker_warehouse.creditscore_balance_ctry
[0m09:13:20.444774 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.customers_by_ctry
[0m09:13:20.446426 [debug] [Thread-3 (]: Writing injected SQL for node "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.446589 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.446722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.447945 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.449021 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.complaints"
[0m09:13:20.450042 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.age_vs_balance"
[0m09:13:20.450271 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (compile): 09:13:20.444912 => 09:13:20.450183
[0m09:13:20.450411 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.complaints"} */
drop view if exists "mydb"."bank_warehouse"."complaints__dbt_backup" cascade
[0m09:13:20.450594 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.age_vs_balance"} */
drop view if exists "mydb"."bank_warehouse"."age_vs_balance__dbt_backup" cascade
[0m09:13:20.450756 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (compile): 09:13:20.446830 => 09:13:20.450683
[0m09:13:20.450902 [debug] [Thread-3 (]: Began executing node model.maker_warehouse.creditscore_balance_ctry
[0m09:13:20.451098 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.customers_by_ctry
[0m09:13:20.453790 [debug] [Thread-3 (]: Writing runtime sql for node "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.453969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.454108 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.456395 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.457235 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.age_vs_balance (execute): 09:13:20.410785 => 09:13:20.457155
[0m09:13:20.457859 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.complaints (execute): 09:13:20.413231 => 09:13:20.457791
[0m09:13:20.458051 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.458216 [debug] [Thread-1 (]: On model.maker_warehouse.age_vs_balance: Close
[0m09:13:20.458378 [debug] [Thread-2 (]: On model.maker_warehouse.complaints: Close
[0m09:13:20.458511 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.458646 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: BEGIN
[0m09:13:20.459010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d978d0>]}
[0m09:13:20.459300 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0f090>]}
[0m09:13:20.459483 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: BEGIN
[0m09:13:20.459640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:13:20.459902 [info ] [Thread-1 (]: 5 of 11 OK created sql view model bank_warehouse.age_vs_balance ................ [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.460295 [info ] [Thread-2 (]: 6 of 11 OK created sql view model bank_warehouse.complaints .................... [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.460503 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:13:20.460986 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.age_vs_balance
[0m09:13:20.461244 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.complaints
[0m09:13:20.461572 [debug] [Thread-1 (]: Began running node model.maker_warehouse.salary_vs_cardtype
[0m09:13:20.461932 [debug] [Thread-2 (]: Began running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:13:20.462269 [info ] [Thread-1 (]: 9 of 11 START sql view model bank_warehouse.salary_vs_cardtype ................. [RUN]
[0m09:13:20.462545 [info ] [Thread-2 (]: 10 of 11 START sql view model bank_warehouse.satisfaction_vs_num_products ...... [RUN]
[0m09:13:20.463094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.age_vs_balance, now model.maker_warehouse.salary_vs_cardtype)
[0m09:13:20.463396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.complaints, now model.maker_warehouse.satisfaction_vs_num_products)
[0m09:13:20.463578 [debug] [Thread-1 (]: Began compiling node model.maker_warehouse.salary_vs_cardtype
[0m09:13:20.463730 [debug] [Thread-2 (]: Began compiling node model.maker_warehouse.satisfaction_vs_num_products
[0m09:13:20.465155 [debug] [Thread-1 (]: Writing injected SQL for node "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.466522 [debug] [Thread-2 (]: Writing injected SQL for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.466944 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (compile): 09:13:20.463831 => 09:13:20.466850
[0m09:13:20.467123 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (compile): 09:13:20.465287 => 09:13:20.467033
[0m09:13:20.467288 [debug] [Thread-1 (]: Began executing node model.maker_warehouse.salary_vs_cardtype
[0m09:13:20.467466 [debug] [Thread-2 (]: Began executing node model.maker_warehouse.satisfaction_vs_num_products
[0m09:13:20.469568 [debug] [Thread-1 (]: Writing runtime sql for node "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.469751 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.472017 [debug] [Thread-2 (]: Writing runtime sql for node "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.472212 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.472436 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.472656 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.472832 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.473007 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */

  create view "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography,
    ROUND(AVG(customers.creditscore), 2) AS avg_credit_score,
    ROUND(AVG(customers.satisfactionscore), 4) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m09:13:20.473200 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */

  create view "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp"
    
    
  as (
    SELECT 
    SUM(accounts.balance) AS total_balance,
    customers.geography AS country,
    COUNT(customers) AS customer_count
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY customers.geography
  );
[0m09:13:20.473356 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.473490 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: BEGIN
[0m09:13:20.473697 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: BEGIN
[0m09:13:20.473870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:20.474046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:13:20.478461 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.478655 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.480294 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.481751 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.481986 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
alter table "mydb"."bank_warehouse"."customers_by_ctry__dbt_tmp" rename to "customers_by_ctry"
[0m09:13:20.482175 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
alter table "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_tmp" rename to "creditscore_balance_ctry"
[0m09:13:20.483432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.483596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.483734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.483917 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.484109 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.484975 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m09:13:20.485755 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m09:13:20.485935 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */

  create view "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp"
    
    
  as (
    SELECT 
    accounts.cardtype,
    ROUND(AVG(customers.estimatedsalary), 2) AS avg_customer_salary
FROM "mydb"."bank_warehouse"."accounts"
JOIN "mydb"."bank_warehouse"."customers" ON accounts.customerid = customers.customerid
GROUP BY cardtype
  );
[0m09:13:20.486110 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.486272 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.486426 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.486608 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */

  create view "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp"
    
    
  as (
    SELECT 
    numofproducts,
    ROUND(AVG(satisfactionscore), 1) AS avg_satisfactionscore
FROM "mydb"."bank_warehouse"."customers"
GROUP BY numofproducts
  );
[0m09:13:20.486761 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: COMMIT
[0m09:13:20.486912 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: COMMIT
[0m09:13:20.488862 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.490336 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.customers_by_ctry"
[0m09:13:20.490507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.490685 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.customers_by_ctry"} */
drop view if exists "mydb"."bank_warehouse"."customers_by_ctry__dbt_backup" cascade
[0m09:13:20.491776 [debug] [Thread-3 (]: Using postgres connection "model.maker_warehouse.creditscore_balance_ctry"
[0m09:13:20.491931 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.492087 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.492278 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.creditscore_balance_ctry"} */
drop view if exists "mydb"."bank_warehouse"."creditscore_balance_ctry__dbt_backup" cascade
[0m09:13:20.493757 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.493901 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.495178 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.495372 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
alter table "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_tmp" rename to "satisfaction_vs_num_products"
[0m09:13:20.496009 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.customers_by_ctry (execute): 09:13:20.454230 => 09:13:20.495927
[0m09:13:20.496163 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
alter table "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_tmp" rename to "salary_vs_cardtype"
[0m09:13:20.496292 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.496486 [debug] [Thread-4 (]: On model.maker_warehouse.customers_by_ctry: Close
[0m09:13:20.497143 [debug] [Thread-3 (]: Timing info for model.maker_warehouse.creditscore_balance_ctry (execute): 09:13:20.451197 => 09:13:20.497062
[0m09:13:20.497327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.497655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2f7d0>]}
[0m09:13:20.497822 [debug] [Thread-3 (]: On model.maker_warehouse.creditscore_balance_ctry: Close
[0m09:13:20.497953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.498747 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m09:13:20.499031 [info ] [Thread-4 (]: 8 of 11 OK created sql view model bank_warehouse.customers_by_ctry ............. [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.499446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaec50>]}
[0m09:13:20.500225 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m09:13:20.500415 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.500642 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.customers_by_ctry
[0m09:13:20.500904 [info ] [Thread-3 (]: 7 of 11 OK created sql view model bank_warehouse.creditscore_balance_ctry ...... [[32mCREATE VIEW[0m in 0.06s]
[0m09:13:20.501123 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.501318 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: COMMIT
[0m09:13:20.501516 [debug] [Thread-4 (]: Began running node model.maker_warehouse.total_salaries
[0m09:13:20.501788 [debug] [Thread-3 (]: Finished running node model.maker_warehouse.creditscore_balance_ctry
[0m09:13:20.501939 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: COMMIT
[0m09:13:20.502161 [info ] [Thread-4 (]: 11 of 11 START sql view model bank_warehouse.total_salaries .................... [RUN]
[0m09:13:20.502676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.maker_warehouse.customers_by_ctry, now model.maker_warehouse.total_salaries)
[0m09:13:20.502839 [debug] [Thread-4 (]: Began compiling node model.maker_warehouse.total_salaries
[0m09:13:20.504398 [debug] [Thread-4 (]: Writing injected SQL for node "model.maker_warehouse.total_salaries"
[0m09:13:20.504609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.504744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.505984 [debug] [Thread-2 (]: Using postgres connection "model.maker_warehouse.satisfaction_vs_num_products"
[0m09:13:20.507993 [debug] [Thread-1 (]: Using postgres connection "model.maker_warehouse.salary_vs_cardtype"
[0m09:13:20.508190 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (compile): 09:13:20.502938 => 09:13:20.508102
[0m09:13:20.508345 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.satisfaction_vs_num_products"} */
drop view if exists "mydb"."bank_warehouse"."satisfaction_vs_num_products__dbt_backup" cascade
[0m09:13:20.508510 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.salary_vs_cardtype"} */
drop view if exists "mydb"."bank_warehouse"."salary_vs_cardtype__dbt_backup" cascade
[0m09:13:20.508663 [debug] [Thread-4 (]: Began executing node model.maker_warehouse.total_salaries
[0m09:13:20.510712 [debug] [Thread-4 (]: Writing runtime sql for node "model.maker_warehouse.total_salaries"
[0m09:13:20.510895 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.511040 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.511688 [debug] [Thread-2 (]: Timing info for model.maker_warehouse.satisfaction_vs_num_products (execute): 09:13:20.469883 => 09:13:20.511614
[0m09:13:20.512237 [debug] [Thread-1 (]: Timing info for model.maker_warehouse.salary_vs_cardtype (execute): 09:13:20.467576 => 09:13:20.512163
[0m09:13:20.512385 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:13:20.512550 [debug] [Thread-2 (]: On model.maker_warehouse.satisfaction_vs_num_products: Close
[0m09:13:20.512710 [debug] [Thread-1 (]: On model.maker_warehouse.salary_vs_cardtype: Close
[0m09:13:20.512849 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: BEGIN
[0m09:13:20.513168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865ad10>]}
[0m09:13:20.513442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865be90>]}
[0m09:13:20.513600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:13:20.513858 [info ] [Thread-2 (]: 10 of 11 OK created sql view model bank_warehouse.satisfaction_vs_num_products . [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.514079 [info ] [Thread-1 (]: 9 of 11 OK created sql view model bank_warehouse.salary_vs_cardtype ............ [[32mCREATE VIEW[0m in 0.05s]
[0m09:13:20.514658 [debug] [Thread-2 (]: Finished running node model.maker_warehouse.satisfaction_vs_num_products
[0m09:13:20.514885 [debug] [Thread-1 (]: Finished running node model.maker_warehouse.salary_vs_cardtype
[0m09:13:20.521733 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.522088 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:13:20.522253 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */

  create view "mydb"."bank_warehouse"."total_salaries__dbt_tmp"
    
    
  as (
    SELECT SUM(estimatedsalary) AS total_estimated_salaries
FROM "mydb"."bank_warehouse"."customers"
  );
[0m09:13:20.525479 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:13:20.527048 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:13:20.527224 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
alter table "mydb"."bank_warehouse"."total_salaries__dbt_tmp" rename to "total_salaries"
[0m09:13:20.528104 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:13:20.528967 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m09:13:20.529134 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:13:20.529282 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: COMMIT
[0m09:13:20.530160 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.531409 [debug] [Thread-4 (]: Using postgres connection "model.maker_warehouse.total_salaries"
[0m09:13:20.531572 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "maker_warehouse", "target_name": "dev", "node_id": "model.maker_warehouse.total_salaries"} */
drop view if exists "mydb"."bank_warehouse"."total_salaries__dbt_backup" cascade
[0m09:13:20.532146 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:13:20.532776 [debug] [Thread-4 (]: Timing info for model.maker_warehouse.total_salaries (execute): 09:13:20.508810 => 09:13:20.532691
[0m09:13:20.532954 [debug] [Thread-4 (]: On model.maker_warehouse.total_salaries: Close
[0m09:13:20.533292 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f959f4-550d-4338-b941-4734388467f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da3310>]}
[0m09:13:20.533553 [info ] [Thread-4 (]: 11 of 11 OK created sql view model bank_warehouse.total_salaries ............... [[32mCREATE VIEW[0m in 0.03s]
[0m09:13:20.533832 [debug] [Thread-4 (]: Finished running node model.maker_warehouse.total_salaries
[0m09:13:20.534594 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.534747 [debug] [MainThread]: On master: BEGIN
[0m09:13:20.534870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:13:20.542477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:13:20.542726 [debug] [MainThread]: On master: COMMIT
[0m09:13:20.542857 [debug] [MainThread]: Using postgres connection "master"
[0m09:13:20.542978 [debug] [MainThread]: On master: COMMIT
[0m09:13:20.543470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:13:20.543605 [debug] [MainThread]: On master: Close
[0m09:13:20.543937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:20.544059 [debug] [MainThread]: Connection 'model.maker_warehouse.salary_vs_cardtype' was properly closed.
[0m09:13:20.544166 [debug] [MainThread]: Connection 'model.maker_warehouse.satisfaction_vs_num_products' was properly closed.
[0m09:13:20.544269 [debug] [MainThread]: Connection 'model.maker_warehouse.total_salaries' was properly closed.
[0m09:13:20.544372 [debug] [MainThread]: Connection 'model.maker_warehouse.creditscore_balance_ctry' was properly closed.
[0m09:13:20.544537 [info ] [MainThread]: 
[0m09:13:20.544711 [info ] [MainThread]: Finished running 2 table models, 9 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m09:13:20.545675 [debug] [MainThread]: Command end result
[0m09:13:20.549025 [info ] [MainThread]: 
[0m09:13:20.549251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:20.549443 [info ] [MainThread]: 
[0m09:13:20.549678 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:13:20.550020 [debug] [MainThread]: Command `dbt run` succeeded at 09:13:20.549972 after 0.52 seconds
[0m09:13:20.550222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d22250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108694150>]}
[0m09:13:20.550399 [debug] [MainThread]: Flushing usage events
